---
  - name: Include Audit
    include: tasks/audit_windows2019.yml

  - name: Include Actualfact
    include: tasks/actualfact_windows2019.yml

  - name: Include Database
    include: tasks/before_windows.yml

  - name: Fetching the type of server
    win_shell: wmic.exe ComputerSystem get DomainRole | where{$_ -ne ""}
    register: server_type
    tags:
      - always

  - name: registering the values column from db 2019
    shell: "{{ db_type }} -u {{ db_user }} -p{{ db_passwd }} -h {{ db_host }} {{ db }} -e \"select before_actual from cis_remedy where id = {{ remedy_id }}\""
    become: yes
    register: database
    delegate_to: localhost
    tags:
      - always
      
  - name: Rollback enfpwdhist
    win_security_policy:
      section: system access
      key: PasswordHistorySize
      value: "{{(database.stdout_lines[1]|from_json).enfpwdhist_111_actual | regex_replace('failed ', '')}}"
    when: ((database.stdout_lines[1]|from_json).enfpwdhist_111_actual | regex_replace('failed ', '')) < "24"
    tags:
      - enfpwdhist
      - 1.1.1
      - one
      - all
      - rollback
      
  - name: Rollback maxpwdage
    shell: |
         a=$(seq 1 60 >> /tmp/cis_seq)
         if [ $(cat /tmp/cis_seq | grep -w "{{(database.stdout_lines[1]|from_json).maxpwdage_112_actual | regex_replace('failed ', '')}}" | wc -l) -eq 1 ]; then
           echo "passed"
         else
           echo "failed"
         fi
         rm -rf /tmp/cis_seq
    delegate_to: localhost
    register: maxpwdreg
    tags:
      - maxpwdage
      - 1.1.2
      - one
      - all
      - rollback

  - name: Rollback maxpwdage
    win_security_policy:
      section: system access
      key: MaximumPasswordAge
      value: "{{(database.stdout_lines[1]|from_json).maxpwdage_112_actual | regex_replace('failed ', '')}}"
    when: (( maxpwdreg.stdout | regex_search('(failed)') ))
    tags:
      - maxpwdage
      - 1.1.2
      - one
      - all
      - rollback
      
  - name: Rollback minpwdage
    win_security_policy:
      section: system access
      key: MinimumPasswordAge
      value: "{{(database.stdout_lines[1]|from_json).minpwdage_113_actual | regex_replace('failed ', '')}}"
    when: ((database.stdout_lines[1]|from_json).minpwdage_113_actual | regex_replace('failed ', '')) < "1"
    tags:
      - minpwdage
      - 1.1.3
      - one
      - all
      - rollback
      
  - name: Rollback minpwdlen
    win_security_policy:
      section: system access
      key: MinimumPasswordLength
      value: "{{(database.stdout_lines[1]|from_json).minpwdlen_114_actual | regex_replace('failed ', '')}}"
    when: ((database.stdout_lines[1]|from_json).minpwdlen_114_actual | regex_replace('failed ', '')) < "14"
    tags:
      - minpwdlen
      - 1.1.4
      - one
      - all
      - rollback
      
  - name: Rollback pwdcomplex
    win_security_policy:
      section: system access
      key: PasswordComplexity
      value: "{{(database.stdout_lines[1]|from_json).pwdcomplex_115_actual | regex_replace('failed ', '')}}"
    when: ((database.stdout_lines[1]|from_json).pwdcomplex_115_actual | regex_replace('failed ', '')) != "1"
    tags:
      - pwdcomplex
      - 1.1.5
      - one
      - all
      - rollback
      
  - name: Rollback reversepath
    win_security_policy:
      section: system access
      key: "ClearTextPassword"
      value: "{{(database.stdout_lines[1]|from_json).reversepath_116_actual | regex_replace('failed ', '')}}"
    when: ((database.stdout_lines[1]|from_json).reversepath_116_actual | regex_replace('failed ', '')) != "0"
    tags:
      - reversepath
      - 1.1.6
      - one
      - all
      - rollback
      
  - name: Rollback acclockdur
    shell: |
         a=$(seq 1 14 >> /tmp/cis_seq)
         if [ $(cat /tmp/cis_seq | grep -w "{{(database.stdout_lines[1]|from_json).acclockdur_121_actual | regex_replace('failed ', '')}}" | wc -l) -eq 1 ]; then
           echo "failed"
         else
           echo "passed"
         fi
         rm -rf /tmp/cis_seq
    delegate_to: localhost
    register: acclockdurreg
    when: ((database.stdout_lines[1]|from_json).acclockdur_121_actual | regex_search('failed [0-9]+'))
    tags:
      - acclockdur
      - 1.2.1
      - one
      - all
      - rollback

  - name: Rollback acclockdur
    win_security_policy:
      section: System Access
      key: LockoutDuration
      value: "{{(database.stdout_lines[1]|from_json).acclockdur_121_actual | regex_replace('failed ', '')}}"
    when: 
      - ((database.stdout_lines[1]|from_json).acclockdur_121_actual | regex_search('failed [0-9]+'))
      - (( acclockdurreg.stdout | regex_search('failed') )) == "failed"
    tags:
      - acclockdur
      - 1.2.1
      - one
      - all
      - rollback

  - name: Rollback acclockdur
    win_shell: |
          net accounts /lockoutduration:{{(database.stdout_lines[1]|from_json).acclockdur_121_actual | regex_replace('failed Never', 'NO')}}
    when: ((database.stdout_lines[1]|from_json).acclockdur_121_actual) == "failed Never" 
    tags:
      - acclockdur
      - 1.2.1
      - one
      - all
      - rollback
    
  - name: Rollback acclockthres
    shell: |
         a=$(seq 1 10 >> /tmp/cis_seq)
         if [ $(cat /tmp/cis_seq | grep -w "{{(database.stdout_lines[1]|from_json).acclockthres_122_actual | regex_replace('failed ', '')}}" | wc -l) -eq 1 ]; then
           echo "passed"
         else
           echo "failed"
         fi
         rm -rf /tmp/cis_seq
    when: ((database.stdout_lines[1]|from_json).acclockthres_122_actual | regex_search('failed [0-9]+'))
    delegate_to: localhost
    register: acclockreg
    tags:
      - acclockthres
      - 1.2.2
      - one
      - all
      - rollback

  - name: Rollback acclockthres
    win_security_policy:
      section: system access
      key: LockoutBadCount
      value: "{{(database.stdout_lines[1]|from_json).acclockthres_122_actual | regex_replace('failed ', '')}}"
    when:
      - ((database.stdout_lines[1]|from_json).acclockthres_122_actual | regex_search('failed [0-9]+'))
      - (( acclockreg.stdout | regex_search('failed') )) == "failed"
    tags:
      - acclockthres
      - 1.2.2
      - one
      - all
      - rollback

  - name: Rollback acclockthres
    win_shell: |
          net accounts /lockoutthreshold:{{(database.stdout_lines[1]|from_json).acclockthres_122_actual | regex_replace('failed Never', 'NO')}}
    when: ((database.stdout_lines[1]|from_json).acclockthres_122_actual) == "failed Never"
    tags:
      - acclockthres
      - 1.2.2
      - one
      - all
      - rollback
      
  - name: Rollback resetacclock
    shell: |
         a=$(seq 1 14 >> /tmp/cis_seq)
         if [ $(cat /tmp/cis_seq | grep -w "{{(database.stdout_lines[1]|from_json).resetacclock_123_actual | regex_replace('failed ', '')}}" | wc -l) -eq 1 ]; then
           echo "failed"
         else
           echo "passed"
         fi
         rm -rf /tmp/cis_seq
    delegate_to: localhost
    register: restaccreg
    when: ((database.stdout_lines[1]|from_json).resetacclock_123_actual | regex_search('failed [0-9]+'))
    tags:
      - resetacclock
      - 1.2.3
      - one
      - all
      - rollback

  - name: Rollback resetacclock
    win_security_policy:
      section: system access
      key: ResetLockoutCount
      value: "{{(database.stdout_lines[1]|from_json).resetacclock_123_actual | regex_replace('failed ', '')}}"
    when:
      - ((database.stdout_lines[1]|from_json).resetacclock_123_actual | regex_search('failed [0-9]+')) 
      - (( restaccreg.stdout | regex_search('failed') )) == "failed"
    tags:
      - resetacclock
      - 1.2.3
      - one
      - all
      - rollback

  - name: Rollback resetacclock
    win_shell: |
          net accounts /lockoutwin:{{(database.stdout_lines[1]|from_json).resetacclock_123_actual | regex_replace('failed Never', 'NO')}}
    when: ((database.stdout_lines[1]|from_json).resetacclock_123_actual) == "failed Never"
    tags:
      - resetacclock
      - 1.2.3
      - one
      - all 
      - rollback

#####chap-2########

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).accesscredmgr_221_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).accesscredmgr_221_actual) != "0"
    register: accesscredmgr
    failed_when: no
    tags:
      - accesscredmgr
      - 2.2.1
      - two
      - all
      - rollback

  - name: Rollback accesscredmgr
    win_user_right:
       name: SeTrustedCredManAccessPrivilege
       users: "{{ accesscredmgr.results | map(attribute='stdout_lines') | list }}"
       action: set
    when: ((database.stdout_lines[1]|from_json).accesscredmgr_221_actual) != "0"
    failed_when: no
    tags:
      - accesscredmgr
      - 2.2.1
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).accesscompdc_222_actual.split(',') | regex_replace('failed ', '') }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).accesscompdc_222_actual) != "*S-1-5-11,*S-1-5-32-544,*S-1-5-9"
      - ((database.stdout_lines[1]|from_json).accesscompdc_222_actual) != "*S-1-5-9,*S-1-5-11,*S-1-5-32-544" 
    register: accesscompdc
    failed_when: no
    tags:
      - accesscompdc
      - 2.2.2
      - two
      - all
      - rollback

  - name: Rollback accesscompdc
    win_user_right:
       name: SeNetworkLogonRight
       users: "{{ accesscompdc.results | map(attribute='stdout_lines') | list }}"
       action: set
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).accesscompdc_222_actual) != "*S-1-5-11,*S-1-5-32-544,*S-1-5-9"
      - ((database.stdout_lines[1]|from_json).accesscompdc_222_actual) != "*S-1-5-9,*S-1-5-11,*S-1-5-32-544"
    failed_when: no
    tags:
      - accesscompdc
      - 2.2.2
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).accesscompms_223_actual.split(',') | regex_replace('failed ', '') }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).accesscompms_223_actual) != "*S-1-5-11,*S-1-5-32-544"
    register: accesscompms
    failed_when: no
    tags:
      - accesscompms
      - 2.2.3
      - two
      - all
      - rollback

  - name: Rollback accesscompms
    win_user_right:
       name: SeNetworkLogonRight
       users: "{{ accesscompms.results | map(attribute='stdout_lines') | list }}"
       action: set
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).accesscompms_223_actual) != "*S-1-5-11,*S-1-5-32-544" 
    tags:
      - accesscompms
      - 2.2.3
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).actaspartoper_224_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).actasos_224_actual) != "0"
    register: actaspartoper
    failed_when: no
    tags:
      - actasos
      - 2.2.4
      - two
      - all
      - rollback

  - name: Rollback actaspartoper
    win_user_right:
       name: SeTcbPrivilege
       users: "{{ actaspartoper.results | map(attribute='stdout_lines') | list }}"
       action: set
    when: ((database.stdout_lines[1]|from_json).actasos_224_actual) != "0"
    failed_when: no
    tags:
      - actasos
      - 2.2.4
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).addwsdomain_225_actual.split(',') | regex_replace('failed ', '') }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).addwsdomain_225_actual) != "*S-1-5-32-544" and ((database.stdout_lines[1]|from_json).addwsdomain_225_actual | regex_search('failed_empty')) != "failed_empty"
    register: addwsdomain
    failed_when: no
    tags:
      - addwsdomain
      - 2.2.5
      - two
      - all
      - rollback

  - name: Rollback addwsdomain
    win_user_right:
       name: SeMachineAccountPrivilege
       users: "{{ addwsdomain.results | map(attribute='stdout_lines') | list }}"
       action: set
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).addwsdomain_225_actual | regex_search('failed ')) 
    failed_when: no
    tags:
      - addwsdomain
      - 2.2.5
      - two
      - all
      - rollback

  - name: Rollback addwsdomain
    win_user_right:
       name: SeMachineAccountPrivilege
       users: []
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).addwsdomain_225_actual | regex_search('failed_empty'))
    failed_when: no
    tags:
      - addwsdomain
      - 2.2.5
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).memquotaprocess_226_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).memquotaprocess_226_actual) != "*S-1-5-19,*S-1-5-20,*S-1-5-32-544"
    register: memquotaprocess
    failed_when: no
    tags:
      - memquotaprocess
      - 2.2.6
      - two
      - all
      - rollback

  - name: Rollback memquotaprocess
    win_user_right:
       name: SeIncreaseQuotaPrivilege
       users: "{{ memquotaprocess.results | map(attribute='stdout_lines') | list }}"
       action: set
    when: ((database.stdout_lines[1]|from_json).memquotaprocess_226_actual) != "*S-1-5-19,*S-1-5-20,*S-1-5-32-544"
    failed_when: no
    tags:
      - memquotaprocess
      - 2.2.6
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).allowloglocal_227_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).allowloglocal_227_actual) != "*S-1-5-32-544"
    register: allowloglocal
    failed_when: no
    tags:
      - allowloglocal
      - rollback
      - 2.2.7
      - two
      - all

  - name: Rollback allowloglocal
    win_user_right:
       name: SeInteractiveLogonRight
       users: "{{ allowloglocal.results | map(attribute='stdout_lines') | list }}"
       action: set
    when: ((database.stdout_lines[1]|from_json).allowloglocal_227_actual) != "*S-1-5-32-544"
    failed_when: no
    tags:
      - allowloglocal
      - 2.2.7
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).allowlogremdeskdc_228_actual.split(',') | regex_replace('failed ', '') }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).allowlogremdeskdc_228_actual) != "*S-1-5-32-544"
    register: allowlogremdeskdc
    failed_when: no
    tags:
      - allowlogremdeskdc
      - 2.2.8
      - two
      - all
      - rollback

  - name: Rollback allowlogremdeskdc
    win_user_right:
       name: SeRemoteInteractiveLogonRight
       users: "{{ allowlogremdeskdc.results | map(attribute='stdout_lines') | list }}"
       action: set
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).allowlogremdeskdc_228_actual) != "*S-1-5-32-544"
#    failed_when: no
    tags:
      - allowlogremdeskdc
      - 2.2.8
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).allowlogremdeskms_229_actual.split(',') | regex_replace('failed ', '') }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).allowlogremdeskms_229_actual) != "*S-1-5-32-544,*S-1-5-32-555"
    register: allowlogremdeskms
    failed_when: no
    tags:
      - allowlogremdeskms
      - 2.2.9
      - two
      - all
      - rollback

  - name: Rollback allowlogremdeskms
    win_user_right:
       name: SeRemoteInteractiveLogonRight
       users: "{{ allowlogremdeskms.results | map(attribute='stdout_lines') | list }}"
       action: set
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).allowlogremdeskms_229_actual) != "*S-1-5-32-544,*S-1-5-32-555"
    failed_when: no
    tags:
      - allowlogremdeskms
      - 2.2.9
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).backupfiledirs_2210_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).backupfiledirs_2210_actual) != "*S-1-5-32-544"
    register: backupfiledirs
    failed_when: no
    tags:
      - backupfiledirs
      - 2.2.10
      - two
      - all
      - rollback

  - name: Rollback backupfiledirs
    win_user_right:
       name: SeBackupPrivilege
       users: "{{ backupfiledirs.results | map(attribute='stdout_lines') | list }}"
       action: set
    when: ((database.stdout_lines[1]|from_json).backupfiledirs_2210_actual) != "*S-1-5-32-544"
    failed_when: no
    tags:
      - backupfiledirs
      - 2.2.10
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).chgsystime_2211_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).chgsystime_2211_actual) != "*S-1-5-19,*S-1-5-32-544"
    register: chgsystime
    failed_when: no
    tags:
      - chgsystime
      - 2.2.11
      - two
      - all
      - rollback

  - name: Rollback chgsystime
    win_user_right:
       name: SeSystemtimePrivilege
       users: "{{ chgsystime.results | map(attribute='stdout_lines') | list }}" 
       action: set
    when: ((database.stdout_lines[1]|from_json).chgsystime_2211_actual) != "*S-1-5-19,*S-1-5-32-544"
    failed_when: no
    tags:
      - chgsystime
      - 2.2.11
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).chgtimezone_2212_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).chgtimezone_2212_actual) != "*S-1-5-19,*S-1-5-32-544"
    register: chgtimezone
    failed_when: no
    tags:
      - chgtimezone
      - 2.2.12
      - two
      - all
      - rollback

  - name: Rollback chgtimezone
    win_user_right:
       name: SeTimeZonePrivilege
       users: "{{ chgtimezone.results | map(attribute='stdout_lines') | list }}"
       action: set
    when: ((database.stdout_lines[1]|from_json).chgtimezone_2212_actual) != "*S-1-5-19,*S-1-5-32-544"
    failed_when: no
    tags:
      - chgtimezone
      - 2.2.12
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).pagefile_2213_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).pagefile_2213_actual) != "*S-1-5-32-544"
    register: pagefile
    failed_when: no
    tags:
      - pagefile
      - 2.2.13
      - two
      - all
      - rollback

  - name: Rollback pagefile
    win_user_right:
       name: SeCreatePagefilePrivilege
       users: "{{ pagefile.results | map(attribute='stdout_lines') | list }}"
       action: set
    when: ((database.stdout_lines[1]|from_json).pagefile_2213_actual) != "*S-1-5-32-544"
    failed_when: no
    tags:
      - pagefile
      - 2.2.13
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).tokenobj_2214_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).tokenobj_2214_actual) != "0"
    register: tokenobj
    failed_when: no
    tags:
      - tokenobj
      - 2.2.14
      - two
      - all
      - rollback

  - name: Rollback tokenobj
    win_user_right:
       name: SeCreateTokenPrivilege
       users: "{{ tokenobj.results | map(attribute='stdout_lines') | list }}"
       action: set
    when: ((database.stdout_lines[1]|from_json).tokenobj_2214_actual) != "0"
    failed_when: no
    tags:
      - tokenobj
      - 2.2.14
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).globalobj_2215_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).globalobj_2215_actual) != "*S-1-5-19,*S-1-5-20,*S-1-5-32-544,*S-1-5-6"
    register: globalobj
    failed_when: no
    tags:
      - globalobj
      - 2.2.15
      - two
      - all
      - rollback

  - name: Rollback globalobj
    win_user_right:
       name: SeCreateGlobalPrivilege
       users: "{{ globalobj.results | map(attribute='stdout_lines') | list }}"
       action: set
    when: ((database.stdout_lines[1]|from_json).globalobj_2215_actual) != "*S-1-5-19,*S-1-5-20,*S-1-5-32-544,*S-1-5-6"
    failed_when: no
    tags:
      - globalobj
      - 2.2.15
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).permsharedobj_2216_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).permsharedobj_2216_actual) != "0"
    register: permsharedobj
    failed_when: no
    tags:
      - permsharedobj
      - 2.2.16
      - two
      - all
      - rollback

  - name: Rollback permsharedobj
    win_user_right:
       name: SeCreateSymbolicLinkPrivilege
       users: "{{ permsharedobj.results | map(attribute='stdout_lines') | list }}"
    when: ((database.stdout_lines[1]|from_json).permsharedobj_2216_actual) != "0"
    failed_when: no
    tags:
      - permsharedobj
      - 2.2.16
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).symboliclinksdc_2217_actual.split(',') | regex_replace('failed ', '') }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).symboliclinksdc_2217_actual) != "*S-1-5-32-544"
    register: symboliclinksdc
    failed_when: no
    tags:
      - symboliclinksdc
      - 2.2.17
      - two
      - all
      - rollback

  - name: Rollback symboliclinksdc
    win_user_right:
       name: SeCreateSymbolicLinkPrivilege
       users: "{{ symboliclinksdc.results | map(attribute='stdout_lines') | list }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).symboliclinksdc_2217_actual) != "*S-1-5-32-544"
    failed_when: no
    tags:
      - symboliclinksdc
      - 2.2.17
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).sysboliclinksms_2218_actual.split(',') | regex_replace('failed ', '') }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).sysboliclinksms_2218_actual) != "*S-1-5-32-544,*S-1-5-83-0"
    register: sysboliclinksms
    failed_when: no
    tags:
      - sysboliclinksms
      - 2.2.18
      - two
      - all
      - rollback

  - name: Rollback sysboliclinksms
    win_user_right:
       name: SeCreateSymbolicLinkPrivilege
       users: "{{ sysboliclinksms.results | map(attribute='stdout_lines') | list }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).sysboliclinksms_2218_actual) != "*S-1-5-32-544,*S-1-5-83-0"
    failed_when: no
    tags:
      - sysboliclinksms
      - 2.2.18
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).debugprog_2219_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).debugprog_2219_actual) != "*S-1-5-32-544"
    register: debugprog
    failed_when: no
    tags:
      - debugprog
      - 2.2.19
      - two
      - all
      - rollback

  - name: Rollback debugprog
    win_user_right:
       name: SeDebugPrivilege
       users: "{{ debugprog.results | map(attribute='stdout_lines') | list }}"
    when: ((database.stdout_lines[1]|from_json).debugprog_2219_actual) != "*S-1-5-32-544"
    failed_when: no
    tags:
      - debugprog
      - 2.2.19
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).denyaccessdc_2220_actual.split(',') | regex_replace('failed ', '') }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).denyaccessdc_2220_actual) != "1" and ((database.stdout_lines[1]|from_json).denyaccessdc_2220_actual | regex_search('failed_empty')) != "failed_empty"
    register: denyaccessdc
    failed_when: no
    tags:
      - denyaccessdc
      - 2.2.20
      - two
      - all
      - rollback

  - name: Rollback denyaccessdc
    win_user_right:
       name: SeDenyNetworkLogonRight
       users: "{{ denyaccessdc.results | map(attribute='stdout_lines') | list }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).denyaccessdc_2220_actual | regex_search('failed '))
    failed_when: no
    tags:
      - denyaccessdc
      - 2.2.20
      - two
      - all
      - rollback

  - name: Rollback denyaccessdc
    win_user_right:
       name: SeDenyNetworkLogonRight
       users: []
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).denyaccessdc_2220_actual | regex_search('failed_empty'))
    failed_when: no
    tags:
      - denyaccessdc
      - 2.2.20
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).denyaccessms_2221_actual.split(',') | regex_replace('failed ', '') }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).denyaccessms_2221_actual) != "1" and ((database.stdout_lines[1]|from_json).denyaccessms_2221_actual | regex_search('failed_empty')) != "failed_empty"
    register: denyaccessms
    failed_when: no
    tags:
      - denyaccessms
      - 2.2.21
      - two
      - all
      - rollback

  - name: Rollback denyaccessms
    win_user_right:
       name: SeDenyNetworkLogonRight
       users: "{{ denyaccessms.results | map(attribute='stdout_lines') | list }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).denyaccessms_2221_actual | regex_search('failed '))
    register: denyaccessms
    failed_when: no
    tags:
      - denyaccessms
      - 2.2.21
      - two
      - all
      - rollback

  - name: Rollback denyaccessms
    win_user_right:
       name: SeDenyNetworkLogonRight
       users: []
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).denyaccessms_2221_actual | regex_search('failed_empty'))
    register: denyaccessms
    failed_when: no
    tags:
      - denyaccessms
      - 2.2.21
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).denylogbatchjob_2222_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).denylogbatchjob_2222_actual) != "1" and ((database.stdout_lines[1]|from_json).denylogbatchjob_2222_actual | regex_search('failed_empty')) != "failed_empty"
    register: denylogbatchjob
    failed_when: no
    tags:
      - denylogbatchjob
      - 2.2.22
      - two
      - all
      - rollback

  - name: Rollback denylogbatchjob
    win_user_right:
       name: SeDenyBatchLogonRight
       users: "{{ denylogbatchjob.results | map(attribute='stdout_lines') | list }}"
    when: ((database.stdout_lines[1]|from_json).denylogbatchjob_2222_actual | regex_search('failed '))
    failed_when: no
    tags:
      - denylogbatchjob
      - 2.2.22
      - two
      - all
      - rollback

  - name: Rollback denylogbatchjob
    win_user_right:
       name: SeDenyBatchLogonRight
       users: []
    when: ((database.stdout_lines[1]|from_json).denylogbatchjob_2222_actual | regex_search('failed_empty'))
    failed_when: no
    tags:
      - denylogbatchjob
      - 2.2.22
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).denylogservice_2223_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).denylogservice_2223_actual) != "1" and ((database.stdout_lines[1]|from_json).denylogservice_2223_actual | regex_search('failed_empty')) != "failed_empty"
    register: denylogservice
    failed_when: no
    tags:
      - denylogservice
      - 2.2.23
      - two
      - all
      - rollback

  - name: Rollback denylogservice
    win_user_right:
       name: SeDenyServiceLogonRight
       users: "{{ denylogservice.results | map(attribute='stdout_lines') | list }}"
    when: ((database.stdout_lines[1]|from_json).denylogservice_2223_actual | regex_search('failed '))
    failed_when: no
    tags:
      - denylogservice
      - 2.2.23
      - two
      - all
      - rollback

  - name: Rollback denylogservice
    win_user_right:
       name: SeDenyServiceLogonRight
       users: []
    when: ((database.stdout_lines[1]|from_json).denylogservice_2223_actual | regex_search('failed_empty'))
    failed_when: no
    tags:
      - denylogservice
      - 2.2.23
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).denyloglocally_2224_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).denyloglocally_2224_actual) != "1" and ((database.stdout_lines[1]|from_json).denyloglocally_2224_actual | regex_search('failed_empty')) != "failed_empty"
    register: denyloglocally
    failed_when: no
    tags:
      - denyloglocally
      - 2.2.24
      - two
      - all
      - rollback

  - name: Rollback denyloglocally
    win_user_right:
       name: SeDenyInteractiveLogonRight
       users: "{{ denyloglocally.results | map(attribute='stdout_lines') | list }}"
    when: ((database.stdout_lines[1]|from_json).denyloglocally_2224_actual | regex_search('failed ')) 
    register: denyloglocally
    failed_when: no
    tags:
      - denyloglocally
      - 2.2.24
      - two
      - all
      - rollback

  - name: Rollback denyloglocally
    win_user_right:
       name: SeDenyInteractiveLogonRight
       users: []
    when: ((database.stdout_lines[1]|from_json).denyloglocally_2224_actual | regex_search('failed_empty'))
    failed_when: no
    tags:
      - denyloglocally
      - 2.2.24
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).denylogremdeskdc_2225_actual.split(',') | regex_replace('failed ', '') }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).denylogremdeskdc_2225_actual) != "1" and ((database.stdout_lines[1]|from_json).denylogremdeskdc_2225_actual | regex_search('failed_empty')) != "failed_empty"
    register: denylogremdeskdc
    failed_when: no
    tags:
      - denylogremdeskdc
      - 2.2.25
      - two
      - all
      - rollback

  - name: Rollback denylogremdeskdc
    win_user_right:
       name: SeDenyRemoteInteractiveLogonRight
       users: "{{ denylogremdeskdc.results | map(attribute='stdout_lines') | list }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).denylogremdeskdc_2225_actual | regex_search('failed '))
    failed_when: no
    tags:
      - denylogremdeskdc
      - 2.2.25
      - two
      - all
      - rollback

  - name: Rollback denylogremdeskdc
    win_user_right:
       name: SeDenyRemoteInteractiveLogonRight
       users: []
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).denylogremdeskdc_2225_actual | regex_search('failed_empty'))
    failed_when: no
    tags:
      - denylogremdeskdc
      - 2.2.25
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).denylogremdeskms_2226_actual.split(',') | regex_replace('failed ', '') }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).denylogremdeskms_2226_actual) != "1" and ((database.stdout_lines[1]|from_json).denylogremdeskms_2226_actual | regex_search('failed_empty')) != "failed_empty"
    register: denylogremdeskms
    failed_when: no
    tags:
      - denylogremdeskms
      - 2.2.26
      - two
      - all
      - rollback

  - name: Rollback denylogremdeskms
    win_user_right:
       name: SeDenyRemoteInteractiveLogonRight
       users: "{{ denylogremdeskms.results | map(attribute='stdout_lines') | list }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).denylogremdeskms_2226_actual | regex_search('failed '))
    failed_when: no
    tags:
      - denylogremdeskms
      - 2.2.26
      - two
      - all
      - rollback

  - name: Rollback denylogremdeskms
    win_user_right:
       name: SeDenyRemoteInteractiveLogonRight
       users: []
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).denylogremdeskms_2226_actual | regex_search('failed_empty'))
    failed_when: no
    tags:
      - denylogremdeskms
      - 2.2.26
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).enbcompusraccdc_2227_actual.split(',') | regex_replace('failed ', '') }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).enbcompusraccdc_2227_actual) != "1" and ((database.stdout_lines[1]|from_json).enbcompusraccdc_2227_actual | regex_search('failed_empty')) != "failed_empty"
    register: enbcompusraccdc
    failed_when: no
    tags:
      - enbcompusraccdc
      - 2.2.27
      - two
      - all
      - rollback

  - name: Rollback enbcompusraccdc
    win_user_right:
       name: SeEnableDelegationPrivilege
       user:  "{{ enbcompusraccdc.results | map(attribute='stdout_lines') | list }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).enbcompusraccdc_2227_actual | regex_search('failed '))
    failed_when: no
    tags:
      - enbcompusraccdc
      - 2.2.27
      - two
      - all
      - rollback

  - name: Rollback enbcompusraccdc
    win_user_right:
       name: SeEnableDelegationPrivilege
       user:  []
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).enbcompusraccdc_2227_actual | regex_search('failed_empty'))
    failed_when: no
    tags:
      - enbcompusraccdc
      - 2.2.27
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).enbcompusraccms_2228_actual.split(',') | regex_replace('failed ', '') }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).enbcompusraccms_2228_actual) != "0"
    register: enbcompusraccms
    failed_when: no
    tags:
      - enbcompusraccms
      - 2.2.28
      - two
      - all
      - rollback

  - name: Rollback enbcompusraccms
    win_user_right:
       name: SeEnableDelegationPrivilege
       user: "{{ enbcompusraccms.results | map(attribute='stdout_lines') | list }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).enbcompusraccms_2228_actual) != "0"
    failed_when: no
    tags:
      - enbcompusraccms
      - 2.2.28
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).forceshutdown_2229_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).forceshutdown_2229_actual) != "*S-1-5-32-544"
    register: forceshutdown
    failed_when: no
    tags:
      - forceshutdown
      - 2.2.29
      - two
      - all
      - rollback

  - name: Rollback forceshutdown
    win_user_right:
       name: SeRemoteShutdownPrivilege
       users: "{{ forceshutdown.results | map(attribute='stdout_lines') | list }}"
    when: ((database.stdout_lines[1]|from_json).forceshutdown_2229_actual) != "*S-1-5-32-544"
    failed_when: no
    tags:
      - forceshutdown
      - 2.2.29
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).securityaudits_2230_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).securityaudits_2230_actual) != "*S-1-5-19,*S-1-5-20"
    register: securityaudits
    failed_when: no
    tags:
      - securityaudits
      - 2.2.30
      - two
      - all
      - rollback

  - name: Rollback securityaudits
    win_user_right:
       name: SeAuditPrivilege
       users: "{{ securityaudits.results | map(attribute='stdout_lines') | list }}"
    when: ((database.stdout_lines[1]|from_json).securityaudits_2230_actual) != "*S-1-5-19,*S-1-5-20"
    failed_when: no
    tags:
      - securityaudits
      - 2.2.30
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).clientauthendc_2231_actual.split(',') | regex_replace('failed ', '') }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).clientauthendc_2231_actual) != "*S-1-5-19,*S-1-5-20,*S-1-5-32-544,*S-1-5-6"
    register: clientauthendc
    failed_when: no
    tags:
      - clientauthendc
      - 2.2.31
      - two
      - all
      - rollback

  - name: Rollback clientauthendc
    win_user_right:
       name: SeImpersonatePrivilege
       users: "{{ clientauthendc.results | map(attribute='stdout_lines') | list }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).clientauthendc_2231_actual) != "*S-1-5-19,*S-1-5-20,*S-1-5-32-544,*S-1-5-6"
    failed_when: no
    tags:
      - clientauthendc
      - 2.2.31
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).clientauthenms_2232_actual.split(',') | regex_replace('failed ', '') }}"
    when:
     - (server_type.stdout_lines[1] | regex_search('3')) == '3'
     - ((database.stdout_lines[1]|from_json).clientauthenms_2232_actual) != "*S-1-5-19,*S-1-5-20,*S-1-5-32-544,*S-1-5-6"
    register: clientauthenms
    failed_when: no
    tags:
      - clientauthenms
      - 2.2.32
      - two
      - all
      - rollback

  - name: Rollback clientauthenms
    win_user_right:
       name: SeImpersonatePrivilege
       users: "{{ clientauthenms.results | map(attribute='stdout_lines') | list }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).clientauthenms_2232_actual) != "*S-1-5-19,*S-1-5-20,*S-1-5-32-544,*S-1-5-6"
    failed_when: no
    tags:
      - clientauthenms
      - 2.2.32
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).incschedprior_2233_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).incschedprior_2233_actual) != "*S-1-5-32-544"
    register: incschedprior
    failed_when: no
    tags:
      - incschedprior
      - 2.2.33
      - two
      - all
      - rollback

  - name: Rollback incschedprior
    win_user_right:
       name: SeIncreaseBasePriorityPrivilege
       users: "{{ incschedprior.results | map(attribute='stdout_lines') | list }}"
    when: ((database.stdout_lines[1]|from_json).incschedprior_2233_actual) != "*S-1-5-32-544"
    failed_when: no
    tags:
      - incschedprior
      - 2.2.33
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).loadunloaddevdriver_2234_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).loadunloaddevdriver_2234_actual) != "*S-1-5-32-544"
    register: loadunloaddevdriver
    failed_when: no
    tags:
      - loadunloaddevdriver
      - 2.2.34
      - two
      - all
      - rollback

  - name: Rollback loadunloaddevdriver
    win_user_right:
       name: SeLoadDriverPrivilege
       users: "{{ loadunloaddevdriver.results | map(attribute='stdout_lines') | list }}"
    when: ((database.stdout_lines[1]|from_json).loadunloaddevdriver_2234_actual) != "*S-1-5-32-544"
    failed_when: no
    tags:
      - loadunloaddevdriver
      - 2.2.34
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).lockpagemem_2235_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).lockpagemem_2235_actual) != "0"
    register: lockpagemem
    failed_when: no
    tags:
      - lockpagemem
      - 2.2.35
      - two
      - all
      - rollback

  - name: Rollback lockpagemem
    win_user_right:
       name: SeLockMemoryPrivilege
       users: "{{ lockpagemem.results | map(attribute='stdout_lines') | list }}"
    when: ((database.stdout_lines[1]|from_json).lockpagemem_2235_actual) != "0"
    failed_when: no
    tags:
      - lockpagemem
      - 2.2.35
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).logbatchjob_2236_actual.split(',') | regex_replace('failed ', '') }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).logbatchjob_2236_actual) != "*S-1-5-32-544"
    register: logbatchjob
    failed_when: no
    tags:
      - logbatchjob
      - 2.2.36
      - two
      - all
      - rollback

  - name: Rollback logbatchjob
    win_user_right:
       name: SeBatchLogonRight
       users: "{{ logbatchjob.results | map(attribute='stdout_lines') | list }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).logbatchjob_2236_actual) != "*S-1-5-32-544"
    failed_when: no
    tags:
      - logbatchjob
      - 2.2.36
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).audsecurlogdc_2237_actual.split(',') | regex_replace('failed ', '') }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).audsecurlogdc_2237_actual) != "*S-1-5-32-544"
    register: audsecurlogdc
    failed_when: no
    tags:
      - audsecurlogdc
      - 2.2.37
      - two
      - all
      - rollback

  - name: Rollback audsecurlogdc
    win_user_right:
       name: SeSecurityPrivilege
       users: "{{ audsecurlogdc.results | map(attribute='stdout_lines') | list }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).audsecurlogdc_2237_actual) != "*S-1-5-32-544"
    failed_when: no
    tags:
      - audsecurlogdc
      - 2.2.37
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).audsecurlogms_2238_actual.split(',') | regex_replace('failed ', '') }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).audsecurlogms_2238_actual) != "*S-1-5-32-544"
    register: audsecurlogms
    failed_when: no
    tags:
      - audsecurlogms
      - 2.2.38
      - two
      - all
      - rollback

  - name: Rollback audsecurlogms
    win_user_right:
       name: SeSecurityPrivilege
       users: "{{ audsecurlogms.results | map(attribute='stdout_lines') | list }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).audsecurlogms_2238_actual) != "*S-1-5-32-544"
    failed_when: no
    tags:
      - audsecurlogms
      - 2.2.38
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).modobjlabel_2239_actual.split(',') | regex_replace('failed ', '') }}"
    when:
      - ((database.stdout_lines[1]|from_json).modobjlabel_2239_actual) != "0"
    register: modobjlabel
    failed_when: no
    tags:
      - modobjlabel
      - 2.2.39
      - two
      - all
      - rollback

  - name: Rollback modobjlabel
    win_user_right:
       name: SeSecurityPrivilege
       users: "{{ modobjlabel.results | map(attribute='stdout_lines') | list }}"
    when:
      - ((database.stdout_lines[1]|from_json).modobjlabel_2239_actual) != "0"
    failed_when: no
    tags:
      - modobjlabel
      - 2.2.39
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).modfirmenv_2240_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).modfirmenv_2240_actual) != "*S-1-5-32-544"
    register: modfirmenv
    failed_when: no
    tags:
      - modfirmenv
      - 2.2.40
      - two
      - all
      - rollback

  - name: Rollback modfirmenv
    win_user_right:
       name: SeSystemEnvironmentPrivilege
       users: "{{ modfirmenv.results | map(attribute='stdout_lines') | list }}"
    when: ((database.stdout_lines[1]|from_json).modfirmenv_2240_actual) != "*S-1-5-32-544"
    failed_when: no
    tags:
      - modfirmenv
      - 2.2.40
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).volmaintasks_2241_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).volmaintasks_2241_actual) != "*S-1-5-32-544"
    register: volmaintasks
    failed_when: no
    tags:
      - volmaintasks
      - 2.2.41
      - two
      - all
      - rollback

  - name: Rollback volmaintasks
    win_user_right:
       name: SeManageVolumePrivilege
       users: "{{ volmaintasks.results | map(attribute='stdout_lines') | list }}"
    when: ((database.stdout_lines[1]|from_json).volmaintasks_2241_actual) != "*S-1-5-32-544"
    failed_when: no
    tags:
      - volmaintasks
      - 2.2.41
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).profsinglepro_2242_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).profsinglepro_2242_actual) != "*S-1-5-32-544"
    register: profsinglepro
    failed_when: no
    tags:
      - profsinglepro
      - 2.2.42
      - two
      - all
      - rollback

  - name: Rollback profsinglepro
    win_user_right:
       name: SeProfileSingleProcessPrivilege
       users: "{{ profsinglepro.results | map(attribute='stdout_lines') | list }}"
    when: ((database.stdout_lines[1]|from_json).profsinglepro_2242_actual) != "*S-1-5-32-544"
    failed_when: no
    tags:
      - profsinglepro
      - 2.2.42
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).profsysperf_2243_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).profsysperf_2243_actual) != "*S-1-5-32-544,*S-1-5-80-3139157870-2983391045-3678747466-658725712-1809340420"
    register: profsysperf
    failed_when: no
    tags:
      - profsysperf
      - 2.2.43
      - two
      - all
      - rollback

  - name: Rollback profsysperf
    win_user_right:
       name: SeSystemProfilePrivilege
       users: "{{ profsysperf.results | map(attribute='stdout_lines') | list }}"
    when: ((database.stdout_lines[1]|from_json).profsysperf_2243_actual) != "*S-1-5-32-544,*S-1-5-80-3139157870-2983391045-3678747466-658725712-1809340420"
    register: profsysperf
    tags:
      - profsysperf
      - 2.2.43
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).replprotoken_2244_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).replprotoken_2244_actual) != "*S-1-5-19,*S-1-5-20"
    register: replprotoken
    failed_when: no
    tags:
      - replprotoken
      - 2.2.44
      - two
      - all
      - rollback

  - name: Rollback replprotoken
    win_user_right:
       name: SeAssignPrimaryTokenPrivilege
       users: "{{ replprotoken.results | map(attribute='stdout_lines') | list }}"
    when: ((database.stdout_lines[1]|from_json).replprotoken_2244_actual) != "*S-1-5-19,*S-1-5-20"
    failed_when: no
    tags:
      - replprotoken
      - 2.2.44
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).restorefiledirs_2245_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).restorefiledirs_2245_actual) != "*S-1-5-32-544"
    register: restorefiledirs
    failed_when: no
    tags:
      - restorefiledirs
      - 2.2.45
      - two
      - all
      - rollback

  - name: Rollback restorefiledirs
    win_user_right:
       name: SeRestorePrivilege
       users: "{{ restorefiledirs.results | map(attribute='stdout_lines') | list }}"
    when: ((database.stdout_lines[1]|from_json).restorefiledirs_2245_actual) != "*S-1-5-32-544"
    failed_when: no
    tags:
      - restorefiledirs
      - 2.2.45
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).shutdownsys_2246_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).shutdownsys_2246_actual) != "*S-1-5-32-544"
    register: shutdownsys
    failed_when: no
    tags:
      - shutdownsys
      - 2.2.46
      - two
      - all
      - rollback

  - name: Rollback shutdownsys
    win_user_right:
       name: SeShutdownPrivilege
       users: "{{ shutdownsys.results | map(attribute='stdout_lines') | list }}"
    when: ((database.stdout_lines[1]|from_json).shutdownsys_2246_actual) != "*S-1-5-32-544"
    failed_when: no
    tags:
      - shutdownsys
      - 2.2.46
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).syncdirserdata_2247_actual.split(',') | regex_replace('failed ', '') }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).syncdirserdata_2247_actual) != "0"
    register: syncdirserdata
    failed_when: no
    tags:
      - syncdirserdata
      - 2.2.47
      - two
      - all
      - rollback

  - name: Rollback syncdirserdata
    win_user_right:
       name: SeSyncAgentPrivilege
       users: "{{ syncdirserdata.results | map(attribute='stdout_lines') | list }}"
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).syncdirserdata_2247_actual) != "0"
    failed_when: no
    tags:
      - syncdirserdata
      - 2.2.47
      - two
      - all
      - rollback

  - name: Fetching sid account name
    win_shell: |
         [wmi]"Win32_SID.SID='{{item}}'" | Select-Object AccountName | where-object -filter {$_.AccountName} | Foreach {$_.AccountName}
    loop: "{{ (database.stdout_lines[1]|from_json).ownershipfile_2248_actual.split(',') | regex_replace('failed ', '') }}"
    when: ((database.stdout_lines[1]|from_json).ownershipfile_2248_actual) != "*S-1-5-32-544"
    register: ownershipfile
    failed_when: no
    tags:
      - ownershipfile
      - 2.2.48
      - two
      - all
      - rollback

  - name: Rollback ownershipfile
    win_user_right:
       name: SeTakeOwnershipPrivilege
       users: "{{ ownershipfile.results | map(attribute='stdout_lines') | list }}"
    when: ((database.stdout_lines[1]|from_json).ownershipfile_2248_actual) != "*S-1-5-32-544"
    failed_when: no
    tags:
      - ownershipfile
      - 2.2.48
      - two
      - all
      - rollback
            
  - name: Rollback admaccstat
    win_security_policy:
       section: System Access
       key: EnableAdminAccount
       value: "{{(database.stdout_lines[1]|from_json).admaccstat_2311_actual | regex_replace('failed ', '')}}"
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).admaccstat_2311_actual | regex_replace('failed ', '')) != "No"
    tags:
      - admaccstat
      - 2.3.1.1
      - two
      - all
      - rollback
      
  - name: Rollback blockmsacc
    win_regedit:
       path: HKLM:\Software\Microsoft\Windows\Currentversion\Policies\System
       name: "NoConnectedUser"
       data: "3"
       type: dword
       state: absent
    when: ((database.stdout_lines[1]|from_json).blockmsacc_2312_actual) != "0x3"
    tags:
      - blockmsacc
      - 2.3.1.2
      - two
      - all
      - rollback
      
  - name: Rollback guestaccstat
    win_security_policy:
       section: System Access
       key: EnableGuestAccount
       value: "{{(database.stdout_lines[1]|from_json).guestaccstat_2313_actual | regex_replace('failed ', '')}}"
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).guestaccstat_2313_actual | regex_replace('failed ', '')) != "No"
    tags:
      - guestaccstat
      - 2.3.1.3
      - two
      - all
      - rollback
      
  - name: Rollback limitlocaccuse
    win_regedit:
       path: HKLM:\System\Currentcontrolset\Control\Lsa
       name: "LimitBlankPasswordUse"
       data: "1"
       type: dword
       state: absent
    when: ((database.stdout_lines[1]|from_json).limitlocaccuse_2314_actual) != "0x1"
    tags:
      - limitlocaccuse
      - 2.3.1.4
      - two
      - all
      - rollback
      
  - name: Rollback renameadmacc
    win_security_policy:
       section: System Access
       key: NewAdministratorName
       value: "{{(database.stdout_lines[1]|from_json).renameadmacc_2315_actual | regex_replace('failed ', '')}}"
    when: ((database.stdout_lines[1]|from_json).renameadmacc_2315_actual | regex_replace('failed ', '')) != "NewAdmin"
    tags:
      - renameadmacc
      - 2.3.1.5
      - two
      - all
      - rollback
      
  - name: Rollback renameguestacc
    win_security_policy:
       section: System Access
       key: NewGuestName
       value: "{{(database.stdout_lines[1]|from_json).renameguestacc_2316_actual | regex_replace('failed ', '')}}"
    when: ((database.stdout_lines[1]|from_json).renameguestacc_2316_actual | regex_replace('failed ', '')) != "NewGuest"
    tags:
      - renameguestacc
      - 2.3.1.6
      - two
      - all
      - rollback
      
  - name: Rollback forceaudpolicy
    win_regedit:
       path: HKLM:\System\Currentcontrolset\Control\Lsa
       name: "SCENoApplyLegacyAuditPolicy"
       data: "1"
       type: dword
       state: absent
    when: ((database.stdout_lines[1]|from_json).forceaudpolicy_2321_actual) != "0x1"
    tags:
      - forceaudpolicy
      - 2.3.2.1
      - two
      - all
      - rollback
      
  - name: Rollback sysshutdownsecuraud
    win_regedit:
       path: HKLM:\System\Currentcontrolset\Control\Lsa
       name: "CrashOnAuditFail"
       data: "0"
       type: dword
       state: absent
    when: ((database.stdout_lines[1]|from_json).sysshutdownsecuraud_2322_actual) != "0x0"
    tags:
      - sysshutdownsecuraud
      - 2.3.2.2
      - two
      - all
      - rollback
      
  - name: Rollback allowremovmedia
    win_regedit:
       path: HKLM:\Software\Microsoft\Windows Nt\Currentversion\Winlogon
       name: "AllocateDASD"
       data: "0"
       type: string
       state: absent
    when: ((database.stdout_lines[1]|from_json).allowremovmedia_2341_actual) != "0"
    tags:
      - allowremovmedia
      - rollback
      - 2.3.4.1
      - two
      - all
      - rollback
      
  - name: Rollback preventusr
    win_regedit:
       path: HKLM:\System\Currentcontrolset\Control\Print\Providers\Lanman Print Services\Servers
       name: "AddPrinterDrivers"
       data: "1"
       type: dword
       state: absent
    when: ((database.stdout_lines[1]|from_json).preventusr_2342_actual) != "0x1"
    tags:
      - preventusr
      - 2.3.4.2
      - two
      - all
      - rollback
      
  - name: Rollback allowservschedtask
    win_regedit: 
       path: HKLM:\System\CurrentControlSet\Control\Lsa
       name: "SubmitControl"
       data: "0"
       type: dword
       state: absent
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).allowservschedtask_2351_actual) != "0x0"
    tags:
      - allowservschedtask
      - 2.3.5.1
      - two
      - all
      - rollback
      
  - name: Rollback ldapservsign
    win_regedit: 
       path: HKLM:\System\CurrentControlSet\Services\NTDS\Parameters
       name: "ldapserverintegrity"
       data: "{{(database.stdout_lines[1]|from_json).ldapservsign_2352_actual}}"
       type: dword
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).ldapservsign_2352_actual) != "0x2"
    tags:
      - ldapservsign
      - 2.3.5.2
      - two
      - all
      - rollback
      
  - name: Rollback refusemachaccpwd
    win_regedit: 
       path: HKLM:\System\CurrentControlSet\Services\Netlogon\Parameters
       name: RefusePasswordChange
       data: 0
       type: dword
       state: absent
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).refusemachaccpwd_2353_actual) != "0x0"
    tags:
      - refusemachaccpwd
      - 2.3.5.3
      - two
      - all
      - rollback
      
  - name: Rollback digiencryptsign
    win_regedit:
      path: HKLM:\System\CurrentControlSet\Services\Netlogon\Parameters
      name: SealSecureChannel
      data: 1
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).digiencryptsign_2361_actual) != "0x1"
    tags:
      - digiencryptsign
      - 2.3.6.1
      - two
      - all
      - rollback
      
  - name: Rollback digiencrypsecdata
    win_regedit:
      path: HKLM:\System\CurrentControlSet\Services\Netlogon\Parameters
      name: SealSecureChannel
      data: 1
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).digiencrypsecdata_2362_actual) != "0x1"
    tags:
      - digiencrypsecdata
      - 2.3.6.2
      - two
      - all
      - rollback
      
  - name: Rollback digisignsecdata
    win_regedit:
      path: HKLM:\System\CurrentControlSet\Services\Netlogon\Parameters
      name: SignSecureChannel
      data: 1
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).digisignsecdata_2363_actual) != "0x1"
    tags:
      - digisignsecdata
      - 2.3.6.3
      - two
      - all
      - rollback
      
  - name: Rollback dismachaccpwdchg
    win_regedit:
      path: HKLM:\System\CurrentControlSet\Services\Netlogon\Parameters
      name: DisablePasswordChange
      data: 0
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).dismachaccpwdchg_2364_actual) != "0x0"
    tags:
      - dismachaccpwdchg
      - 2.3.6.4
      - two
      - all
      - rollback
      
  - name: Rollback maxmachaccpwdage
    win_regedit:
      path: HKLM:\System\CurrentControlSet\Services\Netlogon\Parameters
      name: MaximumPasswordAge
      data: 30
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).maxmachaccpwdage_2365_actual) != "0x1e"
    tags:
      - maxmachaccpwdage
      - 2.3.6.5
      - two
      - all
      - rollback
      
  - name: Rollback reqsessionkey
    win_regedit:
      path: HKLM:\System\CurrentControlSet\Services\Netlogon\Parameters
      name: RequireStrongKey
      data: 1
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).reqsessionkey_2366_actual) != "0x1"
    tags:
      - reqsessionkey
      - 2.3.6.6
      - two
      - all
      - rollback
      
  - name: Rollback dontreqctrlaltdel
    win_regedit:
      path: HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System
      name: DisableCAD
      data: 0
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).dontreqctrlaltdel_2371_actual) != "0x0"
    tags:
      - dontreqctrlaltdel
      - 2.3.7.1
      - two
      - all
      - rollback
      
  - name: Rollback dontdisplastusrname
    win_regedit:
      path: HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System
      name: DontDisplayLastUserName
      data: 1
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).dontdisplastusrname_2372_actual) != "0x1"
    tags:
      - dontdisplastusrname
      - 2.3.7.2
      - two
      - all
      - rollback
      
  - name: Rollback machinactlimit
    win_regedit:
      path: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
      name: InactivityTimeoutSecs
      data: 900
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).machinactlimit_2373_actual) != "0x384"
    tags:
      - machinactlimit
      - 2.3.7.3
      - two
      - all
      - rollback
      
  - name: Rollback msgtextusr
    win_regedit:
      path: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
      name: LegalNoticeText
      data: Welcome to windows
      type: expandstring
      state: absent
    when: ((database.stdout_lines[1]|from_json).msgtextusr_2374_actual) != "1"
    tags:
      - msgtextusr
      - 2.3.7.4
      - two
      - all
      - rollback
      
  - name: Rollback msgtitleusr
    win_regedit:
      path: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
      name: LegalNoticeCaption
      data: message for user
      type: expandstring
      state: absent
    when: ((database.stdout_lines[1]|from_json).msgtitleusr_2375_actual) != "1"
    tags:
      - msgtitleusr
      - 2.3.7.5
      - two
      - all
      - rollback
      
  - name: Rollback countprevlogons
    shell: |
         a=$(seq 1 4 >> /tmp/cis_countprev)
         if [ $(cat /tmp/cis_countprev | grep -w "{{(database.stdout_lines[1]|from_json).countprevlogons_2376_actual | regex_replace('failed ', '')}}" | wc -l) -eq 1 ]; then
           echo "passed"
         else
           echo "failed"
         fi
         rm -rf /tmp/cis_countprev
    delegate_to: localhost
    register: countprevreg
    when: (server_type.stdout_lines[1] | regex_search('3')) == '3'
    tags:
      - countprevlogons
      - 2.3.7.6
      - two
      - all
      - rollback

  - name: Rollback countprevlogons
    win_regedit:
      path: HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon
      name: CachedLogonsCount
      data: "{{(database.stdout_lines[1]|from_json).countprevlogons_2376_actual | regex_replace('failed ', '')}}"
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - (( countprevreg.stdout | regex_search('(failed)') ))
    tags:
      - countprevlogons
      - 2.3.7.6
      - two
      - all
      - rollback
      
  - name: Rollback promptusrchgpwd
    shell: |
         a=$(seq 5 14 >> /tmp/cis_promptusr)
         if [ $(cat /tmp/cis_promptusr | grep -w "{{(database.stdout_lines[1]|from_json).promptusrchgpwd_2377_actual | replace('failed ', '')}}" | wc -l) -eq 1 ]; then
           echo "passed"
         else
           echo "failed"
         fi
         rm -rf /tmp/cis_promptusr
    delegate_to: localhost
    register: promptusrreg
    tags:
      - promptusrchgpwd
      - 2.3.7.7
      - two
      - all
      - rollback
      
  - name: Rollback promptusrchgpwd
    win_regedit:
      path: HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon
      name: PasswordExpiryWarning
      data: "{{(database.stdout_lines[1]|from_json).promptusrchgpwd_2377_actual | regex_replace('failed ', '')}}"
      type: dword
    when: (( promptusrreg.stdout | regex_search('(failed)') ))
    tags:
      - promptusrchgpwd
      - 2.3.7.7
      - two
      - all
      - rollback
      
  - name: Rollback dcauthenunlockws
    win_regedit:
      path: HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon
      name: ForceUnlockLogon
      data: 1
      type: dword
      state: absent
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).dcauthenunlockws_2378_actual) != "4,1"
    tags:
      - dcauthenunlockws
      - 2.3.7.8
      - two
      - all
      - rollback
      
  - name: Rollback smartcardremoval
    win_regedit:
      path: HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon
      name: ScRemoveOption
      data: 1
      type: string
      state: absent
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).smartcardremoval_2379_actual) != "MACHINE//Software//Microsoft//Windows NT//CurrentVersion//Winlogon//ScRemoveOption=1,1"
    tags:
      - smartcardremoval
      - 2.3.7.9
      - two
      - all
      - rollback
      
  - name: Rollback digisignclient
    win_regedit:
      path: HKLM:\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters
      name: RequireSecuritySignature
      data: 1
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).digisignclient_2381_actual) != "0x1"
    tags:
      - digisignclient
      - 2.3.8.1
      - two
      - all
      - rollback
      
  - name: Rollback digisignservagree
    win_regedit:
      path: HKLM:\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters
      name: EnableSecuritySignature
      data: 1
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).digisignservagree_2382_actual) != "0x1"
    tags:
      - digisignservagree
      - 2.3.8.2
      - two
      - all
      - rollback
      
  - name: Rollback sendunencryppwd
    win_regedit:
      path: HKLM:\System\CurrentControlSet\Services\LanmanWorkstation\Parameters
      name: EnablePlainTextPassword
      data: 0
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).sendunencryppwd_2383_actual) != "0x0"
    tags:
      - sendunencryppwd
      - 2.3.8.3
      - two
      - all
      - rollback
      
  - name: Rollback setidletime
    win_regedit:
      path: HKLM:\System\Currentcontrolset\Services\Lanmanserver\Parameters
      name: AutoDisconnect
      data: 15
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).setidletime_2391_actual) != "0xf"
    tags:
      - setidletime
      - 2.3.9.1
      - two
      - all
      - rollback
      
  - name: Rollback digisignserv
    win_regedit:
      path: HKLM:\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters
      name: RequireSecuritySignature
      data: 1
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).digisignserv_2392_actual) != "0x1"
    tags:
      - digisignserv
      - 2.3.9.2
      - two
      - all
      - rollback
      
  - name: Rollback digisigncliagree
    win_regedit:
      path: HKLM:\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters
      name: EnableSecuritySignature
      data: 1
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).digisigncliagree_2393_actual) != "0x1"
    tags:
      - digisigncliagree
      - 2.3.9.3
      - two
      - all
      - rollback
      
  - name: Rollback disconclilogonhrexp
    win_regedit:
      path: HKLM:\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters
      name: enableforcedlogoff
      data: 1
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).disconclilogonhrexp_2394_actual) != "0x1"
    tags:
      - disconclilogonhrexp
      - 2.3.9.4
      - two
      - all
      - rollback
      
  - name: Rollback spnnamevalidation
    win_regedit:
      path: HKLM:\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters
      name: SMBServerNameHardeningLevel
      data: 1
      type: dword
      state: absent
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).spnnamevalidation_2395_actual) != "0x1"
    tags:
      - spnnamevalidation
      - 2.3.9.5
      - two
      - all
      - rollback
      
  - name: Rollback allowanonysid
    win_security_policy:
      section: System Access
      key: LSAAnonymousNameLookup
      value: "{{(database.stdout_lines[1]|from_json).allowanonysid_23101_actual | regex_replace('failed ', '')}}"
    when: ((database.stdout_lines[1]|from_json).allowanonysid_23101_actual | regex_replace('failed ', '')) != "0"
    tags:
      - allowanonysid
      - 2.3.10.1
      - two
      - all
      - rollback
      
  - name: Rollback dontallowanonysamacc
    win_regedit:
      path: HKLM:\SYSTEM\CurrentControlSet\Control\Lsa
      name: RestrictAnonymousSAM
      data: 1
      type: dword
      state: absent
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).dontallowanonysamacc_23102_actual) != "0x1"
    tags:
      - dontallowanonysamacc
      - 2.3.10.2
      - two
      - all
      - rollback
      
  - name: Rollback dontallowanonysamaccshares
    win_regedit:
      path: HKLM:\SYSTEM\CurrentControlSet\Control\Lsa
      name: RestrictAnonymous
      data: 1
      type: dword
      state: absent
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).dontallowanonysamaccshares_23103_actual) != "0x1"
    tags:
      - dontallowanonysamaccshares
      - 2.3.10.3
      - two
      - all
      - rollback
      
  - name: Rollback dontallowstoragepwdcred
    win_regedit:
      path: HKLM:\SYSTEM\CurrentControlSet\Control\Lsa
      name: DisableDomainCreds
      data: 1
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).dontallowstoragepwdcred_23104_actual) != "0x1"
    tags:
      - dontallowstoragepwdcred
      - 2.3.10.4
      - two
      - all
      - rollback
      
  - name: Rollback anonyusrperm
    win_regedit:
      path: HKLM:\SYSTEM\CurrentControlSet\Control\Lsa
      name: EveryoneIncludesAnonymous
      data: 0
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).anonyusrperm_23105_actual) != "0x0"
    tags:
      - anonyusrperm
      - 2.3.10.5
      - two
      - all
      - rollback
      
  - name: Rollback namedpipesdc
    win_regedit:
      path: HKLM:\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters
      name: NullSessionPipes
      data: ""
      type: multistring
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).namedpipesdc_23106_actual | regex_replace('failed ', '')) != "7,LSARPC,NETLOGON,SAMR,BROWSER"
    tags:
      - namedpipesdc
      - 2.3.10.6
      - two
      - all
      - rollback
      
  - name: Rollback namedpipesms
    win_regedit:
      path: HKLM:\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters
      name: NullSessionPipes
      data: ""
      type: multistring
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).namedpipesms_23107_actual | regex_replace('failed ', '')) != "7,BROWSER"
    tags:
      - namedpipesms
      - 2.3.10.7
      - two
      - all
      - rollback
     
  - name: Rollback remoteaccesregpath
    shell: |
         echo "{{(database.stdout_lines[1]|from_json).remoteaccesregpath_23108_actual | replace('failed 7,', '')}}" >> /tmp/cisregpath
         sed -i 's~//~/~g; s/\//\\/g' /tmp/cisregpath
         cat /tmp/cisregpath
         rm -rf /tmp/cisregpath
    register: regpathreg
    delegate_to: localhost
    when: ((database.stdout_lines[1]|from_json).remoteaccesregpath_23108_actual | regex_search('System//CurrentControlSet//Control//ProductOptions,System//CurrentControlSet//Control//Server Applications,Software//Microsoft//Windows NT//CurrentVersion')) != "System//CurrentControlSet//Control//ProductOptions,System//CurrentControlSet//Control//Server Applications,Software//Microsoft//Windows NT//CurrentVersion"
    tags:
      - remoteaccesregpath
      - 2.3.10.8
      - two
      - all
      - rollback
      
  - name: Rollback remoteaccesregpath
    win_regedit:
       path: HKLM:\System\Currentcontrolset\Control\Securepipeservers\Winreg\Allowedexactpaths
       name: Machine
       data:  ["{{regpathreg.stdout}}"]
       type: multistring
    when: ((database.stdout_lines[1]|from_json).remoteaccesregpath_23108_actual | regex_search('System//CurrentControlSet//Control//ProductOptions,System//CurrentControlSet//Control//Server Applications,Software//Microsoft//Windows NT//CurrentVersion')) != "System//CurrentControlSet//Control//ProductOptions,System//CurrentControlSet//Control//Server Applications,Software//Microsoft//Windows NT//CurrentVersion"
    tags:
      - remoteaccesregpath
      - 2.3.10.8
      - two
      - all
      - rollback
      
  - name: Rollback remoteaccesregsubpath
    shell: |
         echo "{{(database.stdout_lines[1]|from_json).remoteaccesregsubpath_23109_actual | replace('failed 7,', '')}}" >> /tmp/cisregsubpath
         sed -i 's~//~/~g; s/\//\\/g' /tmp/cisregsubpath
         cat /tmp/cisregsubpath
         rm -rf /tmp/cisregsubpath
    register: regsubpathreg
    delegate_to: localhost
    when: ((database.stdout_lines[1]|from_json).remoteaccesregsubpath_23109_actual) != "7,System//CurrentControlSet//Control//Print//Printers,System//CurrentControlSet//Services//Eventlog,Software//Microsoft//OLAP Server,Software//Microsoft//Windows NT//CurrentVersion//Print,Software//Microsoft//Windows NT//CurrentVersion//Windows,System//CurrentControlSet//Control//ContentIndex,System//CurrentControlSet//Control//Terminal Server,System//CurrentControlSet//Control//Terminal Server//UserConfig,System//CurrentControlSet//Control//Terminal Server//DefaultUserConfiguration,Software//Microsoft//Windows NT//CurrentVersion//Perflib,System//CurrentControlSet//Services//SysmonLog"
    tags:
      - remoteaccesregsubpath
      - 2.3.10.9
      - two
      - all
      - rollback
      
  - name: Rollback remoteaccesregsubpath
    win_regedit:
      path: HKLM:\System\Currentcontrolset\Control\Securepipeservers\Winreg\Allowedpaths
      name: Machine
      data: ["{{regsubpathreg.stdout}}"]
      type: multistring
    when: ((database.stdout_lines[1]|from_json).remoteaccesregsubpath_23109_actual) != "7,System//CurrentControlSet//Control//Print//Printers,System//CurrentControlSet//Services//Eventlog,Software//Microsoft//OLAP Server,Software//Microsoft//Windows NT//CurrentVersion//Print,Software//Microsoft//Windows NT//CurrentVersion//Windows,System//CurrentControlSet//Control//ContentIndex,System//CurrentControlSet//Control//Terminal Server,System//CurrentControlSet//Control//Terminal Server//UserConfig,System//CurrentControlSet//Control//Terminal Server//DefaultUserConfiguration,Software//Microsoft//Windows NT//CurrentVersion//Perflib,System//CurrentControlSet//Services//SysmonLog"
    tags:
      - remoteaccesregsubpath
      - 2.3.10.9
      - two
      - all
      - rollback
      
  - name: Rollback restrictanonyacces
    win_regedit:
      path: HKLM:\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters
      name: RestrictNullSessAccess
      data: 1
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).restrictanonyacces_231010_actual) != "0x1"
    tags:
      - restrictanonyaccess
      - 2.3.10.10
      - two
      - all
      - rollback
      
  - name: Rollback restrictclitosam
    win_regedit:
      path: HKLM:\SYSTEM\CurrentControlSet\Control\Lsa
      name: restrictremotesam
      data: 0:BAG:BAD:(A;;RC;;;BA)
      type: string
      state: absent
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).restrictclitosam_231011_actual) != "0:BAG:BAD:(A;;RC;;;BA)"
    tags:
      - restrictclitosam
      - 2.3.10.11
      - two
      - all
      - rollback
      
  - name: Rollback sharesaccess
    win_regedit:
      path: HKLM:\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters
      name: NullSessionShares
      type: multistring
      state: absent
    when: ((database.stdout_lines[1]|from_json).sharesaccess_231012_actual) != "1"
    tags:
      - sharesaccess
      - 2.3.10.12
      - two
      - all
      - rollback
      
  - name: Rollback sharesecurlocalacc
    win_regedit:
      path: HKLM:\SYSTEM\CurrentControlSet\Control\Lsa
      name: ForceGuest
      data: 0
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).sharesecurlocalacc_231013_actual) != "0x0"
    tags:
      - sharesecurlocalacc
      - 2.3.10.13
      - two
      - all
      - rollback
      
  - name: Rollback allowlocalsys
    win_regedit:
      path: HKLM:\SYSTEM\CurrentControlSet\Control\Lsa
      name: UseMachineId
      data: 1
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).allowlocalsys_23111_actual) != "0x1"
    tags:
      - allowlocalsys
      - 2.3.11.1
      - two
      - all
      - rollback
      
  - name: Rollback allowlocalsysnull
    win_regedit:
      path: HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\MSV1_0
      name: AllowNullSessionFallback
      data: 0
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).allowlocalsysnull_23112_actual) != "0x0"
    tags:
      - allowlocalsysnull
      - 2.3.11.2
      - two
      - all
      - rollback
      
  - name: Rollback allowpku2uauthen
    win_regedit:
      path: HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\pku2u
      name: AllowOnlineID
      data: 0
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).allowpku2uauthen_23113_actual) != "0x0"
    tags:
      - allowpku2uauthen
      - 2.3.11.3
      - two
      - all
      - rollback
      
  - name: Rollback kerberosencryp
    win_regedit:
      path: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Kerberos\Parameters
      name: SupportedEncryptionTypes
      data: 0x7ffffff8
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).kerberosencryp_23114_actual) != "0x7ffffff8"
    tags:
      - kerberosencryp
      - 2.3.11.4
      - two
      - all
      - rollback
      
  - name: Rollback dontstorelanhashval
    win_regedit:
      path: HKLM:\SYSTEM\CurrentControlSet\Control\Lsa
      name: NoLMHash
      data: 1
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).dontstorelanhashval_23115_actual) != "0x1"
    tags:
      - dontstorelanhashval
      - 2.3.11.5
      - two
      - all
      - rollback
      
  - name: Rollback forcelogoff
    win_security_policy:
      section: System Access
      key: ForceLogoffWhenHourExpire
      value: "{{(database.stdout_lines[1]|from_json).forcelogoff_23116_actual | regex_replace('failed ', '')}}"
    when: ((database.stdout_lines[1]|from_json).forcelogoff_23116_actual | regex_replace('failed ', '')) != "1"
    tags:
      - forcelogoff
      - 2.3.11.6
      - two
      - all
      - rollback
      
  - name: Rollback lanmgrauthen
    win_regedit:
      path: HKLM:\SYSTEM\CurrentControlSet\Control\Lsa
      name: LmCompatibilityLevel
      data: 5
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).lanmgrauthen_23117_actual) != "0x5"
    tags:
      - lanmgrauthen
      - 2.3.11.7
      - two
      - all
      - rollback
      
  - name: Rollback ldapclisign
    win_regedit:
      path: HKLM:\SYSTEM\CurrentControlSet\Services\LDAP
      name: LDAPClientIntegrity
      data: 1
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).ldapclisign_23118_actual) != "0x1"
    tags:
      - ldapclisign
      - 2.3.11.8
      - two
      - all
      - rollback
      
  - name: Rollback minsessionsecurcli
    win_regedit:
      path: HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\MSV1_0
      name: NTLMMinClientS
      data: 537395200
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).minsessionsecurcli_23119_actual) != "0x537395200"
    tags:
      - minsessionsecurcli
      - 2.3.11.9
      - two
      - all
      - rollback
      
  - name: Rollback minsessionsecurserv
    win_regedit:
      path: HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\MSV1_0
      name: NTLMMinServerSec
      data: 537395200
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).minsessionsecurserv_231110_actual) != "0x20080000"
    tags:
      - minsessionsecurserv
      - 2.3.11.10
      - two
      - all
      - rollback
      
  - name: Rollback allowsysshutdown
    win_regedit:
      path: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
      name: ShutdownWithoutLogon
      data: 0
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).allowsysshutdown_23131_actual) != "0x0"
    tags:
      - allowsysshutdown
      - rollback
      - 2.3.13.1
      - two
      - all
      - rollback
      
  - name: Rollback caseinsensnonwins
    win_regedit:
      path: HKLM:\SYSTEM\CurrentControlSet\Control\SessionManager\Kernel
      name: ObCaseInsensitive
      data: 1
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).caseinsensnonwins_23151_actual) != "0x1"
    tags:
      - caseinsensnonwins
      - 2.3.15.1
      - two
      - all
      - rollback
      
  - name: Rollback strengthdefaultperm
    win_regedit:
      path: HKLM:\SYSTEM\CurrentControlSet\Control\SessionManager
      name: ProtectionMode
      data: 1
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).strengthdefaultperm_23152_actual) != "0x1"
    tags:
      - strengthdefaultperm
      - 2.3.15.2
      - two
      - all
      - rollback
      
  - name: Rollback setusraccctrl
    win_regedit:
      path: HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System
      name: FilterAdministratorToken
      data: 1
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).setusraccctrl_23171_actual) != "0x1"
    tags:
      - setusraccctrl
      - 2.3.17.1
      - two
      - all
      - rollback
      
  - name: Rollback elevationpromptadmin
    win_regedit:
      path: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
      name: ConsentPromptBehaviorAdmin
      data: 2
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).elevationpromptadmin_23172_actual) != "0x2"
    tags:
      - elevationpromptadmin
      - 2.3.17.2
      - two
      - all
      - rollback
      
  - name: Rollback elevationpromptusr
    win_regedit:
      path: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
      name: ConsentPromptBehaviorUser
      data: 0
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).elevationpromptusr_23173_actual) != "0x0"
    tags:
      - elevationpromptusr
      - 2.3.17.3
      - two
      - all
      - rollback
      
  - name: Rollback detectappinstal
    win_regedit:
      path: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
      name: EnableInstallerDetection
      data: 1
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).detectappinstal_23174_actual) != "0x1"
    tags:
      - detectappinstal
      - 2.3.17.4
      - two
      - all
      - rollback
      
  - name: Rollback elevateuiaccess
    win_regedit:
      path: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
      name: EnableSecureUIAPaths
      data: 1
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).elevateuiaccess_23175_actual) != "0x1"
    tags:
      - elevateuiaccess
      - 2.3.17.5
      - two
      - all
      - rollback
      
  - name: Rollback runalladministrator
    win_regedit:
      path: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
      name: EnableLUA
      data: 1
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).runalladministrator_23176_actual) != "0x1"
    tags:
      - runalladministrator
      - 2.3.17.6
      - two
      - all
      - rollback
      
  - name: Rollback switchsecuredesktop
    win_regedit:
      path: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
      name: PromptOnSecureDesktop
      data: 1
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).switchsecuredesktop_23177_actual) != "0x1"
    tags:
      - switchsecuredesktop
      - 2.3.17.7
      - two
      - all
      - rollback
      
  - name: Rollback virtualizefileregistry
    win_regedit:
      path: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
      name: EnableVirtualization
      data: 1
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).virtualizefileregistry_23178_actual) != "0x1"
    tags:
      - virtualizefileregistry
      - 2.3.17.8
      - two
      - all
      - rollback

####chap-9####

  - name: Rollback domainfirewallstate
    win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile
      name: "EnableFirewall"
      data: "1"
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).domainfirewallstate_911_actual) != "0x1"
    tags:
      - domainfirewallstate
      - 9.1.1
      - nine
      - all
      - rollback
      
  - name: Rollback inboundconn
    win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile
      name: "DefaultInboundAction"
      data: "1"
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).inboundconn_912_actual) != "0x1"
    tags:
      - inboundconn
      - 9.1.2
      - nine
      - all
      - rollback
      
  - name: Rollback outboundconn
    win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile
      name: "DefaultOutboundAction"
      data: "0"
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).outboundconn_913_actual) != "0x0"
    tags:
      - outboundconn
      - 9.1.3
      - nine
      - all
      - rollback
      
  - name: Rollback disablenotificdisplay
    win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile
      name: "DisableNotifications"
      data: "1"
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).disablenotificdisplay_914_actual) != "0x1"
    tags:
      - disablenotificdisplay
      - 9.1.4
      - nine
      - all
      - rollback
      
  - name: Rollback loggingname
    win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging
      name: "LogFilePath"
      data: "%SYSTEMROOT%\\System32\\logfiles\\firewall\\domainfw.log"
      type: string
      state: absent
    when: ((database.stdout_lines[1]|from_json).loggingname_915_actual) != "%SYSTEMROOT%//System32//logfiles//firewall//domainfw.log"
    tags:
      - loggingname
      - 9.1.5
      - nine
      - all
      - rollback
      
  - name: Rollback loggingsizelimit
    win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging
      name: "LogFileSize"
      data: "16384"
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).loggingsizelimit_916_actual) != "0x4000"
    tags:
      - loggingsizelimit
      - 9.1.6
      - nine
      - all
      - rollback
      
  - name: Rollback logginglogdroppack
    win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging
      name: "LogDroppedPackets"
      data: "1"
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).logginglogdroppack_917_actual) != "0x1"
    tags:
      - logginglogdroppack
      - 9.1.7
      - nine
      - all
      - rollback
      
  - name: Rollback logginglogsuccess
    win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging
      name: "LogSuccessfulConnections"
      data: "1"
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).logginglogsuccess_918_actual) != "0x1"
    tags:
      - logginglogsuccess
      - 9.1.8
      - nine
      - all
      - rollback
      
  - name: Rollback pvtfirewallstate
    win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile
      name: "EnableFirewall"
      data: "1"
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).pvtfirewallstate_921_actual) != "0x1"
    tags:
      - pvtfirewallstate
      - 9.2.1
      - nine
      - all
      - rollback
      
  - name: Rollback pvtinboundconn
    win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile
      name: "DefaultInboundAction"
      data: "1"
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).pvtinboundconn_922_actual) != "0x1"
    tags:
      - pvtinboundconn
      - 9.2.2
      - nine
      - all
      - rollback
      
  - name: Rollback pvtoutboundconn
    win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile
      name: "DefaultOutboundAction"
      data: "0"
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).pvtoutboundconn_923_actual) != "0x0"
    tags:
      - pvtoutboundconn
      - 9.2.3
      - nine
      - all
      - rollback
      
  - name: Rollback pvtdisablenotification
    win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile
      name: "DisableNotifications"
      data: "1"
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).pvtdisablenotification_924_actual) != "0x1"
    tags:
      - pvtdisablenotification
      - 9.2.4
      - nine
      - all
      - rollback
      
  - name: Rollback pvtloggingname
    win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging
      name: "LogFilePath"
      data: "%SYSTEMROOT%\\System32\\logfiles\\firewall\\Privatefw.log"
      type: string
      state: absent
    when: ((database.stdout_lines[1]|from_json).pvtloggingname_925_actual) != "%SYSTEMROOT%//System32//logfiles//firewall//Privatefw.log"
    tags:
      - pvtloggingname
      - 9.2.5
      - nine
      - all
      - rollback
      
  - name: Rollback pvtloggingsizelimit
    win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging
      name: "LogFileSize"
      data: "16384"
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).pvtloggingsizelimit_926_actual) != "0x4000"
    tags:
      - pvtloggingsizelimit
      - 9.2.6
      - nine
      - all
      - rollback
     
  - name: Rollback pvtlogginglogdroppack
    win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging
      name: "LogDroppedPackets"
      data: "1"
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).pvtlogginglogdroppack_927_actual) != "0x1"
    tags:
      - pvtlogginglogdroppack
      - 9.2.7
      - nine
      - all
      - rollback
      
  - name: Rollback pvtlogginglogsuccess
    win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging
      name: "LogSuccessfulConnections"
      data: "1"
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).pvtlogginglogsuccess_928_actual) != "0x1"
    tags:
      - pvtlogginglogsuccess
      - 9.2.8
      - nine
      - all
      - rollback
      
  - name: Rollback pubfirewallstate
    win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile
      name: "EnableFirewall"
      data: "1"
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).pubfirewallstate_931_actual) != "0x1"
    tags:
      - pubfirewallstate
      - 9.3.1
      - nine
      - all
      - rollback
      
  - name: Rollback pubinboundconn
    win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile
      name: "DefaultInboundAction"
      data: "1"
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).pubinboundconn_932_actual) != "0x1"
    tags:
      - pubinboundconn
      - 9.3.2
      - nine
      - all
      - rollback
      
  - name: Rollback puboutboundconn
    win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile
      name: "DefaultOutboundAction"
      data: "0"
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).puboutboundconn_933_actual) != "0x0"
    tags:
      - puboutboundconn
      - 9.3.3
      - nine
      - all
      - rollback
      
  - name: Rollback pubdisablenotification
    win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile
      name: "DisableNotifications"
      data: "1"
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).pubdisablenotification_934_actual) != "0x1"
    tags:
      - pubdisablenotification
      - 9.3.4
      - nine
      - all
      - rollback
      
  - name: Rollback localfirewallrules
    win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile
      name: "AllowLocalPolicyMerge"
      data: "0"
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).localfirewallrules_935_actual) != "0x0"
    tags:
      - localfirewallrules
      - 9.3.5
      - nine
      - all
      - rollback
      
  - name: Rollback localconnsecurules
    win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile
      name: "AllowLocalIPsecPolicyMerge"
      data: "0"
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).localconnsecurules_936_actual) != "0x0"
    tags:
      - localconnsecurules
      - 9.3.6
      - nine
      - all
      - rollback
      
  - name: Rollback publoggingname
    win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging
      name: "LogFilePath"
      data: "%SYSTEMROOT%\\System32\\logfiles\\firewall\\Publicfw.log"
      type: string
      state: absent
    when: ((database.stdout_lines[1]|from_json).publoggingname_937_actual) != "%SYSTEMROOT%//System32//logfiles//firewall//Publicfw.log"
    tags:
      - publoggingname
      - 9.3.7
      - nine
      - all
      - rollback
      
  - name: Rollback publoggingsizelimit
    win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging
      name: "LogFileSize"
      data: "16384"
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).publoggingsizelimit_938_actual) != "0x4000"
    tags:
      - publoggingsizelimit
      - 9.3.8
      - nine
      - all
      - rollback
      
  - name: Rollback publogginglogdroppack
    win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging
      name: "LogDroppedPackets"
      data: "1"
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).publogginglogdroppack_939_actual) != "0x1"
    tags:
      - publogginglogdroppack
      - 9.3.9
      - nine
      - all
      - rollback
      
  - name: Rollback publogginglogsuccess
    win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging
      name: "LogSuccessfulConnections"
      data: "1"
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).publogginglogsuccess_9310_actual) != "0x1"
    tags:
      - publogginglogsuccess
      - 9.3.10
      - nine
      - all
      - rollback
      
      
 ####ch-17###########
 
 
  - name: Rollback audcredvalidation
    win_audit_policy_system:
      subcategory: Credential Validation
      audit_type: "{{(database.stdout_lines[1]|from_json).audcredvalidation_1711_actual | regex_replace('failed ', '') | lower}}"
    when: ((database.stdout_lines[1]|from_json).audcredvalidation_1711_actual | regex_replace('failed ', '') | lower) != "success, failure"
    tags:
      - audcredvalidation
      - 17.1.1
      - seventeen
      - all
      - rollback
      
  - name: Rollback audkerbauthservice
    win_audit_policy_system:
      subcategory: Kerberos Authentication service
      audit_type: "{{(database.stdout_lines[1]|from_json).audkerbauthservice_1712_actual | regex_replace('failed ', '') | lower}}"
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).audkerbauthservice_1712_actual | regex_replace('failed ', '') | lower) != "success, failure"
    tags:
      - audkerbauthservice
      - 17.1.2
      - seventeen
      - all
      - rollback
      
  - name: Rollback audkerbservtickoperation
    win_audit_policy_system:
      subcategory: Kerberos Service Ticket Operations
      audit_type: "{{(database.stdout_lines[1]|from_json).audkerbservtickoperation_1713_actual | regex_replace('failed ', '') | lower}}"
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).audkerbservtickoperation_1713_actual | regex_replace('failed ', '') | lower) != "success, failure"
    tags:
      - audkerbservtickoperation
      - 17.1.3
      - seventeen
      - all
      - rollback
      
  - name: Rollback audappgrpmangment
    win_audit_policy_system:
      subcategory: Application Group Management
      audit_type: "{{(database.stdout_lines[1]|from_json).audappgrpmangment_1721_actual | regex_replace('failed ', '') | lower}}"
    when: ((database.stdout_lines[1]|from_json).audappgrpmangment_1721_actual | regex_replace('failed ', '') | lower) != "success, failure"
    tags:
      - audappgrpmangment
      - 17.2.1
      - seventeen
      - all
      - rollback
      
  - name: Rollback audcompaccmangment
    win_audit_policy_system:
      subcategory: Computer Account Management
      audit_type: "{{(database.stdout_lines[1]|from_json).audcompaccmangment_1722_actual | regex_replace('failed ', '') | lower}}"
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).audcompaccmangment_1722_actual | regex_replace('failed ', '') | lower) != "success"
    tags:
      - audcompaccmangment
      - 17.2.2
      - seventeen
      - all
      - rollback
      
  - name: Rollback auddistribgrpmangment
    win_audit_policy_system:
      subcategory: Distribution Group Management
      audit_type: "{{(database.stdout_lines[1]|from_json).auddistribgrpmangment_1723_actual | regex_replace('failed ', '') | lower}}"
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).auddistribgrpmangment_1723_actual | regex_replace('failed ', '') | lower) != "success"
    tags:
      - auddistribgrpmangment
      - 17.2.3
      - seventeen
      - all
      - rollback
      
  - name: Rollback audotheraccmangment
    win_audit_policy_system:
      subcategory: Other Account Management Events
      audit_type: "{{(database.stdout_lines[1]|from_json).audotheraccmangment_1724_actual | regex_replace('failed ', '') | lower}}"
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).audotheraccmangment_1724_actual | regex_replace('failed ', '') | lower) != "success"
    tags:
      - audotheraccmangment
      - 17.2.4
      - rollbackseventeen
      - all
      - rollback
      
  - name: Rollback audsecurgrpmangment
    win_audit_policy_system:
      subcategory: Security Group Management
      audit_type: "{{(database.stdout_lines[1]|from_json).audsecurgrpmangment_1725_actual | regex_replace('failed ', '') | lower}}"
    when: ((database.stdout_lines[1]|from_json).audsecurgrpmangment_1725_actual | regex_replace('failed ', '') | lower) != "success"
    tags:
      - audsecurgrpmangment
      - 17.2.5
      - seventeen
      - all
      - rollback
      
  - name: Rollback audusraccmangment
    win_audit_policy_system:
      subcategory: User Account Management
      audit_type: "{{(database.stdout_lines[1]|from_json).audusraccmangment_1726_actual | regex_replace('failed ', '') | lower}}"
    when: ((database.stdout_lines[1]|from_json).audusraccmangment_1726_actual | regex_replace('failed ', '') | lower) != "success, failure"
    tags:
      - audusraccmangment
      - 17.2.6
      - seventeen
      - all
      - rollback
      
  - name: Rollback auditpnpactivity
    win_audit_policy_system:
      subcategory: Plug and Play Events
      audit_type: "{{(database.stdout_lines[1]|from_json).auditpnpactivity_1731_actual | regex_replace('failed ', '') | lower}}"
    when: ((database.stdout_lines[1]|from_json).auditpnpactivity_1731_actual | regex_replace('failed ', '') | lower) != "success"
    tags:
      - auditpnpactivity
      - 17.3.1
      - seventeen
      - all
      - rollback
      
  - name: Rollback auditprocesscreation
    win_audit_policy_system:
      subcategory: Process Creation
      audit_type: "{{(database.stdout_lines[1]|from_json).auditprocesscreation_1732_actual | regex_replace('failed ', '') | lower}}"
    when: ((database.stdout_lines[1]|from_json).auditprocesscreation_1732_actual | regex_replace('failed ', '') | lower) != "success"
    tags:
      - auditprocesscreation
      - 17.3.2
      - seventeen
      - all
      - rollback
      
  - name: Rollback auditdirservaccess
    win_audit_policy_system:
      subcategory: Directory Service Access
      audit_type: "{{(database.stdout_lines[1]|from_json).auditdirservaccess_1741_actual | regex_replace('failed ', '') | lower}}"
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).auditdirservaccess_1741_actual | regex_replace('failed ', '') | lower) != "failure"
    tags:
      - auditdirservaccess
      - 17.4.1
      - seventeen
      - all
      - rollback
      
  - name: Rollback auditdirservchg
    win_audit_policy_system:
      subcategory: Directory Service Changes
      audit_type: "{{(database.stdout_lines[1]|from_json).auditdirservchg_1742_actual | regex_replace('failed ', '') | lower}}"
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).auditdirservchg_1742_actual | regex_replace('failed ', '') | lower) != "success"
    tags:
      - auditdirservchg
      - 17.4.2
      - seventeen
      - all
      - rollback
      
  - name: Rollback auditacclockout
    win_audit_policy_system:
      subcategory: Account Lockout
      audit_type: "{{(database.stdout_lines[1]|from_json).auditacclockout_1751_actual | regex_replace('failed ', '') | lower}}"
    when: ((database.stdout_lines[1]|from_json).auditacclockout_1751_actual | regex_replace('failed ', '') | lower) != "failure"
    tags:
      - auditacclockout
      - 17.5.1
      - seventeen
      - all
      - rollback
      
  - name: Rollback auditgrpmembership
    win_audit_policy_system:
      subcategory: Group Membership
      audit_type: "{{(database.stdout_lines[1]|from_json).auditgrpmembership_1752_actual | regex_replace('failed ', '') | lower}}"
    when: ((database.stdout_lines[1]|from_json).auditgrpmembership_1752_actual | regex_replace('failed ', '') | lower) != "success"
    tags:
      - auditgrpmembership
      - 17.5.2
      - seventeen
      - all
      - rollback
      
  - name: Rollback auditlogoff
    win_audit_policy_system:
      subcategory: Logoff
      audit_type: "{{(database.stdout_lines[1]|from_json).auditlogoff_1753_actual | regex_replace('failed ', '') | lower}}"
    when: ((database.stdout_lines[1]|from_json).auditlogoff_1753_actual | regex_replace('failed ', '') | lower) != "success"
    tags:
      - auditlogoff
      - 17.5.3
      - seventeen
      - all
      - rollback
      
  - name: Rollback auditlogon
    win_audit_policy_system:
      subcategory: Logon
      audit_type: "{{(database.stdout_lines[1]|from_json).auditlogon_1754_actual | regex_replace('failed ', '') | lower}}"
    when: ((database.stdout_lines[1]|from_json).auditlogon_1754_actual | regex_replace('failed ', '') | lower) != "success, failure"
    tags:
      - auditlogon
      - 17.5.4
      - seventeen
      - all
      - rollback
      
  - name: Rollback auditotherlogonoff
    win_audit_policy_system:
      subcategory: Other Logon/Logoff Events
      audit_type: "{{(database.stdout_lines[1]|from_json).auditotherlogonoff_1755_actual | regex_replace('failed ', '') | lower}}"
    when: ((database.stdout_lines[1]|from_json).auditotherlogonoff_1755_actual | regex_replace('failed ', '') | lower) != "success, failure"
    tags:
      - auditotherlogonoff
      - 17.5.5
      - seventeen
      - all
      - rollback
      
  - name: Rollback auditspeciallogon
    win_audit_policy_system:
      subcategory: Special Logon
      audit_type: "{{(database.stdout_lines[1]|from_json).auditspeciallogon_1756_actual | regex_replace('failed ', '') | lower}}"
    when: ((database.stdout_lines[1]|from_json).auditspeciallogon_1756_actual | regex_replace('failed ', '') | lower) != "success"
    tags:
      - auditspeciallogon
      - 17.5.6
      - seventeen
      - all
      - rollback
      
  - name: Rollback auditdetfileshare
    win_audit_policy_system:
      subcategory: Detailed File Share
      audit_type: "{{(database.stdout_lines[1]|from_json).auditdetfileshare_1761_actual | regex_replace('failed ', '') | lower}}"
    when: ((database.stdout_lines[1]|from_json).auditdetfileshare_1761_actual | regex_replace('failed ', '') | lower) != "failure"
    tags:
      - auditdetfileshare
      - 17.6.1
      - seventeen
      - all
      - rollback
      
  - name: Rollback auditfileshare
    win_audit_policy_system:
      subcategory: File Share
      audit_type: "{{(database.stdout_lines[1]|from_json).auditfileshare_1762_actual | regex_replace('failed ', '') | lower}}"
    when: ((database.stdout_lines[1]|from_json).auditfileshare_1762_actual | regex_replace('failed ', '') | lower) != "success, failure"
    tags:
      - auditfileshare
      - 17.6.2
      - seventeen
      - all
      - rollback
      
  - name: Rollback auditotherobjaccess
    win_audit_policy_system:
      subcategory: Other Object Access Events
      audit_type: "{{(database.stdout_lines[1]|from_json).auditotherobjaccess_1763_actual | regex_replace('failed ', '') | lower}}"
    when: ((database.stdout_lines[1]|from_json).auditotherobjaccess_1763_actual | regex_replace('failed ', '') | lower) != "success, failure"
    tags:
      - auditotherobjaccess
      - 17.6.3
      - seventeen
      - all
      - rollback
      
  - name: Rollback auditremovablestorage
    win_audit_policy_system:
      subcategory: Removable Storage
      audit_type: "{{(database.stdout_lines[1]|from_json).auditremovablestorage_1764_actual | regex_replace('failed ', '') | lower}}"
    when: ((database.stdout_lines[1]|from_json).auditremovablestorage_1764_actual | regex_replace('failed ', '') | lower) != "success, failure"
    tags:
      - auditremovablestorage
      - 17.6.4
      - seventeen
      - all
      - rollback
      
  - name: Rollback auditpolicychg
    win_audit_policy_system:
      subcategory: Audit Policy Change
      audit_type: "{{(database.stdout_lines[1]|from_json).auditpolicychg_1771_actual | regex_replace('failed ', '') | lower}}"
    when: ((database.stdout_lines[1]|from_json).auditpolicychg_1771_actual | regex_replace('failed ', '') | lower) != "success"
    tags:
      - auditpolicychg
      - 17.7.1
      - seventeen
      - all
      - rollback
   
  - name: Rollback auditauthenpolicychg
    win_audit_policy_system:
      subcategory: Authentication Policy Change
      audit_type: "{{(database.stdout_lines[1]|from_json).auditauthenpolicychg_1772_actual | regex_replace('failed ', '') | lower}}"
    when: ((database.stdout_lines[1]|from_json).auditauthenpolicychg_1772_actual | regex_replace('failed ', '') | lower) != "success"
    tags:
      - auditauthenpolicychg
      - 17.7.2
      - seventeen
      - all
      - rollback
      
  - name: Rollback auditauthornpolicychg
    win_audit_policy_system:
      subcategory: Authorization Policy Change
      audit_type: "{{(database.stdout_lines[1]|from_json).auditauthornpolicychg_1773_actual | regex_replace('failed ', '') | lower}}"
    when: ((database.stdout_lines[1]|from_json).auditauthornpolicychg_1773_actual | regex_replace('failed ', '') | lower) != "success"
    tags:
      - auditauthornpolicychg
      - 17.7.3
      - seventeen
      - all
      - rollback
      
  - name: Rollback auditmprulelevpolicychg
    win_audit_policy_system:
      subcategory: MPSSVC Rule-Level Policy Change
      audit_type: "{{(database.stdout_lines[1]|from_json).auditmprulelevpolicychg_1774_actual | regex_replace('failed ', '') | lower}}"
    when: ((database.stdout_lines[1]|from_json).auditmprulelevpolicychg_1774_actual | regex_replace('failed ', '') | lower) != "success, failure"
    tags:
      - auditmprulelevpolicychg
      - 17.7.4
      - seventeen
      - all
      - rollback
      
  - name: Rollback auditotherpolicychg
    win_audit_policy_system:
      subcategory: Other Policy Change Events
      audit_type: "{{(database.stdout_lines[1]|from_json).auditotherpolicychg_1775_actual | regex_replace('failed ', '') | lower}}"
    when: ((database.stdout_lines[1]|from_json).auditotherpolicychg_1775_actual | regex_replace('failed ', '') | lower) != "failure"
    tags:
      - auditotherpolicychg
      - 17.7.5
      - seventeen
      - all
      - rollback
      
  - name: Rollback auditsensitiveprivuse
    win_audit_policy_system:
      subcategory: Sensitive Privilege Use
      audit_type: "{{(database.stdout_lines[1]|from_json).auditsensitiveprivuse_1781_actual | regex_replace('failed ', '') | lower}}"
    when: ((database.stdout_lines[1]|from_json).auditsensitiveprivuse_1781_actual | regex_replace('failed ', '') | lower) != "success, failure"
    tags:
      - auditsensitiveprivuse
      - 17.8.1
      - seventeen
      - all
      - rollback
      
  - name: Rollback auditipsecdriver
    win_audit_policy_system:
      subcategory: IPsec Driver
      audit_type: "{{(database.stdout_lines[1]|from_json).auditipsecdriver_1791_actual | regex_replace('failed ', '') | lower}}"
    when: ((database.stdout_lines[1]|from_json).auditipsecdriver_1791_actual | regex_replace('failed ', '') | lower) != "success, failure"
    tags:
      - auditipsecdriver
      - 17.9.1
      - seventeen
      - all
      - rollback
      
  - name: Rollback auditothersysevents
    win_audit_policy_system:
      subcategory: Other System Events
      audit_type: "{{(database.stdout_lines[1]|from_json).auditothersysevents_1792_actual | regex_replace('failed ', '') | lower}}"
    when: ((database.stdout_lines[1]|from_json).auditothersysevents_1792_actual | regex_replace('failed ', '') | lower) != "success, failure"
    tags:
      - auditothersysevents
      - 17.9.2
      - seventeen
      - all
      - rollback
      
  - name: Rollback auditsecurstatechg
    win_audit_policy_system:
      subcategory: Security State Change
      audit_type: "{{(database.stdout_lines[1]|from_json).auditsecurstatechg_1793_actual | regex_replace('failed ', '') | lower}}"
    when: ((database.stdout_lines[1]|from_json).auditsecurstatechg_1793_actual | regex_replace('failed ', '') | lower) != "success"
    tags:
      - auditsecurstatechg
      - 17.9.3
      - seventeen
      - all
      - rollback
      
  - name: Rollback auditsecursysext
    win_audit_policy_system:
      subcategory: Security System Extension
      audit_type: "{{(database.stdout_lines[1]|from_json).auditsecursysext_1794_actual | regex_replace('failed ', '') | lower}}"
    when: ((database.stdout_lines[1]|from_json).auditsecursysext_1794_actual | regex_replace('failed ', '') | lower) != "success"
    tags:
      - auditsecursysext
      - 17.9.4
      - seventeen
      - all
      - rollback
      
  - name: Rollback auditsysintegrity
    win_audit_policy_system:
      subcategory: System Integrity
      audit_type: "{{(database.stdout_lines[1]|from_json).auditsysintegrity_1795_actual | regex_replace('failed ', '') | lower}}"
    when: ((database.stdout_lines[1]|from_json).auditsysintegrity_1795_actual | regex_replace('failed ', '') | lower) != "success, failure"
    tags:
      - auditsysintegrity
      - 17.9.5
      - seventeen
      - all
      - rollback
      
 ####ch-18########
 
  - name: copying enablelockscreencam file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/enablelockscreencam_18111.txt
      dest: C:\facts\policyfiles\enablelockscreencam_18111.txt
    when: ((database.stdout_lines[1]|from_json).enablelockscreencam_18111_actual) != "0x1"
    tags:
      - enablelockscreencam
      - eighteen
      - 18.1.1.1
      - all
      - rollback

  - name: adding value to the enablelockscreencam.pol file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\enablelockscreencam_18111.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).enablelockscreencam_18111_actual}}'
    when: ((database.stdout_lines[1]|from_json).enablelockscreencam_18111_actual) != "0x1" and ((database.stdout_lines[1]|from_json).enablelockscreencam_18111_actual) != "DELETE"
    tags:
      - enablelockscreencam
      - eighteen
      - 18.1.1.1
      - all
      - rollback

  - name: adding value to the enablelockscreencam18 file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\enablelockscreencam_18111.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).enablelockscreencam_18111_actual) == "DELETE"
    tags:
      - enablelockscreencam
      - eighteen
      - 18.1.1.1
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\enablelockscreencam_18111.txt'
    when: ((database.stdout_lines[1]|from_json).enablelockscreencam_18111_actual) != "0x1"
    tags:
      - enablelockscreencam
      - eighteen
      - 18.1.1.1
      - all
      - rollback
      
  - name: copying enablelockscreenslide file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/enablelockscreenslide_18112.txt
      dest: C:\facts\policyfiles\enablelockscreenslide_18112.txt
    when: ((database.stdout_lines[1]|from_json).enablelockscreenslide_18112_actual) != "0x1"
    tags:
      - enablelockscreenslide
      - eighteen
      - 18.1.1.2
      - all
      - rollback

  - name: adding value to the enablelockscreenslide file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\enablelockscreenslide_18112.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).enablelockscreenslide_18112_actual}}'
    when: ((database.stdout_lines[1]|from_json).enablelockscreenslide_18112_actual) != "0x1" and ((database.stdout_lines[1]|from_json).enablelockscreenslide_18112_actual) != "DELETE"
    tags:
      - enablelockscreenslide
      - eighteen
      - 18.1.1.2
      - all
      - rollback

  - name: adding value to the enablelockscreenslide file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\enablelockscreenslide_18112.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).enablelockscreenslide_18112_actual) == "DELETE"
    tags:
      - enablelockscreenslide
      - eighteen
      - 18.1.1.2
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\enablelockscreenslide_18112.txt'
    when: ((database.stdout_lines[1]|from_json).enablelockscreenslide_18112_actual) != "0x1"
    tags:
      - enablelockscreenslide
      - eighteen
      - 18.1.1.2
      - all
      - rollback

  - name: copying enableonlinespeechserv file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/enableonlinespeechserv_18122.txt
      dest: C:\facts\policyfiles\enableonlinespeechserv_18122.txt
    when: ((database.stdout_lines[1]|from_json).enableonlinespeechserv_18122_actual) != "0x1"
    tags:
      - enableonlinespeechserv
      - eighteen
      - 18.1.2.2
      - all
      - rollback

  - name: adding value to the enableonlinespeechserv file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\enableonlinespeechserv_18122.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).enableonlinespeechserv_18122_actual}}'
    when: ((database.stdout_lines[1]|from_json).enableonlinespeechserv_18122_actual) != "0x1" and ((database.stdout_lines[1]|from_json).enableonlinespeechserv_18122_actual) != "DELETE"
    tags:
      - enableonlinespeechserv
      - eighteen
      - 18.1.2.2
      - all
      - rollback

  - name: adding value to the enableonlinespeechserv file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\enableonlinespeechserv_18122.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).enableonlinespeechserv_18122_actual) == "DELETE"
    tags:
      - enableonlinespeechserv
      - eighteen
      - 18.1.2.2
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\enableonlinespeechserv_18122.txt'
    when: ((database.stdout_lines[1]|from_json).enableonlinespeechserv_18122_actual) != "0x1"
    tags:
      - enableonlinespeechserv
      - eighteen
      - 18.1.2.2
      - all
      - rollback

  - name: copying disableonlinetips file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/disableonlinetips_1813.txt
      dest: C:\facts\policyfiles\disableonlinetips_1813.txt
    when: ((database.stdout_lines[1]|from_json).disableonlinetips_1813_actual) != "0x1"
    tags:
      - disableonlinetips
      - eighteen
      - 18.1.3
      - all
      - rollback

  - name: adding value to the disableonlinetips file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\disableonlinetips_1813.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).disableonlinetips_1813_actual}}'
    when: ((database.stdout_lines[1]|from_json).disableonlinetips_1813_actual) != "0x1" and ((database.stdout_lines[1]|from_json).disableonlinetips_1813_actual) != "DELETE"
    tags:
      - disableonlinetips
      - eighteen
      - 18.1.3
      - all
      - rollback

  - name: adding value to the disableonlinetips file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\disableonlinetips_1813.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).disableonlinetips_1813_actual) == "DELETE"
    tags:
      - disableonlinetips
      - eighteen
      - 18.1.3
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\disableonlinetips_1813.txt'
    when: ((database.stdout_lines[1]|from_json).disableonlinetips_1813_actual) != "0x1"
    tags:
      - disableonlinetips
      - eighteen
      - 18.1.3
      - all
      - rollback
      
  - name: Uninstall lapsadmpwd MSI file
    win_package:
      path: C:\facts\laps\LAPS.x64.msi
      state: absent
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ansible_architecture == "64-bit"
      - ((database.stdout_lines[1]|from_json).lapsadmpwd_1821_actual) != "1"
    tags:
      - lapsadmpwd
      - rollbackeighteen
      - 18.2.1
      - all
      - rollback

  - name: Uninstall lapsadmpwd MSI file
    win_package:
      path: C:\facts\laps\LAPS.x86.msi
      state: absent
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ansible_architecture != "64-bit"
      - ((database.stdout_lines[1]|from_json).lapsadmpwd_1821_actual) != "1"
    tags:
      - lapsadmpwd
      - eighteen
      - 18.2.1
      - all
      - rollback
      
  - name: copying dontallowpwdexpirtime file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/dontallowpwdexpirtime_1822.txt
      dest: C:\facts\policyfiles\dontallowpwdexpirtime_1822.txt
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).dontallowpwdexpirtime_1822_actual) != "0x1"
    tags:
      - dontallowpwdexpirtime
      - eighteen
      - 18.2.2
      - all
      - rollback

  - name: adding value to the dontallowpwdexpirtime file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\dontallowpwdexpirtime_1822.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).dontallowpwdexpirtime_1822_actual}}'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).dontallowpwdexpirtime_1822_actual) != "0x1" and ((database.stdout_lines[1]|from_json).dontallowpwdexpirtime_1822_actual) != "DELETE"
    tags:
      - dontallowpwdexpirtime
      - eighteen
      - 18.2.2
      - all
      - rollback

  - name: adding value to the dontallowpwdexpirtime file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\dontallowpwdexpirtime_1822.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).dontallowpwdexpirtime_1822_actual) == "DELETE"
    tags:
      - dontallowpwdexpirtime
      - eighteen
      - 18.2.2
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\dontallowpwdexpirtime_1822.txt'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).dontallowpwdexpirtime_1822_actual) != "0x1"
    tags:
      - dontallowpwdexpirtime
      - eighteen
      - 18.2.2
      - all
      - rollback
      
  - name: copying localadmpwdmangment file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/localadmpwdmangment_1823.txt
      dest: C:\facts\policyfiles\localadmpwdmangment_1823.txt
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).localadmpwdmangment_1823_actual) != "0x1"
    tags:
      - localadmpwdmangment
      - rollbackeighteen
      - 18.2.3
      - all
      - rollback

  - name: adding value to the localadmpwdmangment file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\localadmpwdmangment_1823.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).localadmpwdmangment_1823_actual}}'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).localadmpwdmangment_1823_actual) != "0x1" and ((database.stdout_lines[1]|from_json).localadmpwdmangment_1823_actual) != "DELETE"
    tags:
      - localadmpwdmangment
      - eighteen
      - 18.2.3
      - all
      - rollback

  - name: adding value to the localadmpwdmangment file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\localadmpwdmangment_1823.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).localadmpwdmangment_1823_actual) == "DELETE"
    tags:
      - localadmpwdmangment
      - eighteen
      - 18.2.3
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\localadmpwdmangment_1823.txt'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).localadmpwdmangment_1823_actual) != "0x1"
    tags:
      - localadmpwdmangment
      - eighteen
      - 18.2.3
      - all
      - rollback
      
  - name: copying pwdcomplexity file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/pwdcomplexity_1824.txt
      dest: C:\facts\policyfiles\pwdcomplexity_1824.txt
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).pwdcomplexity_1824_actual) != "0x4"
    tags:
      - pwdcomplexity
      - eighteen
      - 18.2.4
      - all
      - rollback

  - name: adding value to the pwdcomplexity file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\pwdcomplexity_1824.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).pwdcomplexity_1824_actual}}'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).pwdcomplexity_1824_actual) != "0x4" and ((database.stdout_lines[1]|from_json).pwdcomplexity_1824_actual) != "DELETE"
    tags:
      - pwdcomplexity
      - eighteen
      - 18.2.4
      - all
      - rollback

  - name: adding value to the pwdcomplexity_1824 file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\pwdcomplexity_1824.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).pwdcomplexity_1824_actual) == "DELETE"
    tags:
      - pwdcomplexity
      - eighteen
      - 18.2.4
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\pwdcomplexity_1824.txt'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).pwdcomplexity_1824_actual) != "0x4"
    tags:
      - pwdcomplexity
      - eighteen
      - 18.2.4
      - all
      - rollback
      
  - name: copying pwdlength file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/pwdlength_1825.txt
      dest: C:\facts\policyfiles\pwdlength_1825.txt
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).pwdlength_1825_actual) != "0x15"
    tags:
      - pwdlength
      - eighteen
      - 18.2.5
      - all
      - rollback

  - name: adding value to the pwdlength file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\pwdlength_1825.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).pwdlength_1825_actual}}'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).pwdlength_1825_actual) != "0x15" and ((database.stdout_lines[1]|from_json).pwdlength_1825_actual) != "DELETE"
    tags:
      - pwdlength
      - eighteen
      - 18.2.5
      - all
      - rollback

  - name: adding value to the pwdlength file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\pwdlength_1825.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).pwdlength_1825_actual) == "DELETE"
    tags:
      - pwdlength
      - eighteen
      - 18.2.5
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\pwdlength_1825.txt'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).pwdlength_1825_actual) != "0x15"
    tags:
      - pwdlength
      - eighteen
      - 18.2.5
      - all
      - rollback
      
  - name: copying pwdage file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/pwdage_1826.txt
      dest: C:\facts\policyfiles\pwdage_1826.txt
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).pwdage_1826_actual) != "0x30"
    tags:
      - pwdage
      - eighteen
      - 18.2.6
      - all
      - rollback

  - name: adding value to the pwdlength file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\pwdage_1826.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).pwdage_1826_actual}}'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).pwdage_1826_actual) != "0x30" and ((database.stdout_lines[1]|from_json).pwdage_1826_actual) != "DELETE"
    tags:
      - pwdage
      - eighteen
      - 18.2.6
      - all
      - rollback

  - name: adding value to the pwdlength file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\pwdage_1826.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).pwdage_1826_actual) == "DELETE"
    tags:
      - pwdage
      - eighteen
      - 18.2.6
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\pwdage_1826.txt'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).pwdage_1826_actual) != "0x30"
    tags:
      - pwdage
      - eighteen
      - 18.2.6
      - all
      - rollback
      
  - name: copying uacrestrictlocalacc file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/uacrestrictlocalacc_1831.txt
      dest: C:\facts\policyfiles\uacrestrictlocalacc_1831.txt
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).uacrestrictlocalacc_1831_actual) != "0x1"
    tags:
      - uacrestrictlocalacc
      - rollbackeighteen
      - 18.3.1
      - all
      - rollback

  - name: adding value to the uacrestrictlocalacc file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\uacrestrictlocalacc_1831.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).uacrestrictlocalacc_1831_actual}}'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).uacrestrictlocalacc_1831_actual) != "0x1" and ((database.stdout_lines[1]|from_json).uacrestrictlocalacc_1831_actual) != "DELETE"
    tags:
      - uacrestrictlocalacc
      - eighteen
      - 18.3.1
      - all
      - rollback

  - name: adding value to the uacrestrictlocalacc file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\uacrestrictlocalacc_1831.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).uacrestrictlocalacc_1831_actual) == "DELETE"
    tags:
      - uacrestrictlocalacc
      - eighteen
      - 18.3.1
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\uacrestrictlocalacc_1831.txt'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).uacrestrictlocalacc_1831_actual) != "0x1"
    tags:
      - uacrestrictlocalacc
      - eighteen
      - 18.3.1
      - all
      - rollback
      
  - name: copying confsmbclient file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/confsmbclient_1832.txt
      dest: C:\facts\policyfiles\confsmbclient_1832.txt
    when: ((database.stdout_lines[1]|from_json).confsmbclient_1832_actual) != "0x4"
    tags:
      - confsmbclient
      - eighteen
      - 18.3.2
      - all
      - rollback

  - name: adding value to the confsmbclient file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confsmbclient_1832.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).confsmbclient_1832_actual}}'
    when: ((database.stdout_lines[1]|from_json).confsmbclient_1832_actual) != "0x4" and ((database.stdout_lines[1]|from_json).confsmbclient_1832_actual) != "DELETE"
    tags:
      - confsmbclient
      - eighteen
      - 18.3.2
      - all
      - rollback

  - name: adding value to the confsmbclient file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confsmbclient_1832.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).confsmbclient_1832_actual) == "DELETE"
    tags:
      - confsmbclient
      - eighteen
      - 18.3.2
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\confsmbclient_1832.txt'
    when: ((database.stdout_lines[1]|from_json).confsmbclient_1832_actual) != "0x4"
    tags:
      - confsmbclient
      - eighteen
      - 18.3.2
      - all
      - rollback

  - name: copying confsmbserver file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/confsmbserver_1833.txt
      dest: C:\facts\policyfiles\confsmbserver_1833.txt
    when: ((database.stdout_lines[1]|from_json).confsmbserver_1833_actual) != "0x0"
    tags:
      - confsmbserver
      - eighteen
      - 18.3.3
      - all
      - rollback

  - name: adding value to the confsmbserver file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confsmbserver_1833.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).confsmbserver_1833_actual}}'
    when: ((database.stdout_lines[1]|from_json).confsmbserver_1833_actual) != "0x0" and ((database.stdout_lines[1]|from_json).confsmbserver_1833_actual) != "DELETE"
    tags:
      - confsmbserver
      - eighteen
      - 18.3.3
      - all
      - rollback

  - name: adding value to the confsmbserver file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confsmbserver_1833.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).confsmbserver_1833_actual) == "DELETE"
    tags:
      - confsmbserver
      - eighteen
      - 18.3.3
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\confsmbserver_1833.txt'
    when: ((database.stdout_lines[1]|from_json).confsmbserver_1833_actual) != "0x0"
    tags:
      - confsmbserver
      - eighteen
      - 18.3.3
      - all
      - rollback
      
  - name: copying enablesehop file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/enablesehop_1834.txt
      dest: C:\facts\policyfiles\enablesehop_1834.txt
    when: ((database.stdout_lines[1]|from_json).enablesehop_1834_actual) != "0x0"
    tags:
      - enablesehop
      - eighteen
      - 18.3.4
      - all
      - rollback

  - name: adding value to the enablesehop file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\enablesehop_1834.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).enablesehop_1834_actual}}'
    when: ((database.stdout_lines[1]|from_json).enablesehop_1834_actual) != "0x0" and ((database.stdout_lines[1]|from_json).enablesehop_1834_actual) != "DELETE"
    tags:
      - enablesehop
      - eighteen
      - 18.3.4
      - all
      - rollback

  - name: adding value to the enablesehop file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\enablesehop_1834.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).enablesehop_1834_actual) == "DELETE"
    tags:
      - enablesehop
      - eighteen
      - 18.3.4
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\enablesehop_1834.txt'
    when: ((database.stdout_lines[1]|from_json).enablesehop_1834_actual) != "0x0"
    tags:
      - enablesehop
      - eighteen
      - 18.3.4
      - all
      - rollback
      
  - name: copying enableexprotldap file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/enableexprotldap_1835.txt
      dest: C:\facts\policyfiles\enableexprotldap_1835.txt
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).enableexprotldap_1835_actual) != "0x2"
    tags:
      - enableexprotldap
      - rollbackeighteen
      - 18.3.5
      - all
      - rollback

  - name: adding value to the enableexprotldap file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\enableexprotldap_1835.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).enableexprotldap_1835_actual}}'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).enableexprotldap_1835_actual) != "0x2" and ((database.stdout_lines[1]|from_json).enableexprotldap_1835_actual) != "DELETE"
    tags:
      - enableexprotldap
      - rollbackeighteen
      - 18.3.5
      - all
      - rollback

  - name: adding value to the enableexprotldap file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\enableexprotldap_1835.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).enableexprotldap_1835_actual) == "DELETE"
    tags:
      - enableexprotldap
      - rollbackeighteen
      - 18.3.5
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\enableexprotldap_1835.txt'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).enableexprotldap_1835_actual) != "0x2"
    tags:
      - enableexprotldap
      - rollbackeighteen
      - 18.3.5
      - all
      - rollback
      
  - name: copying netbiosnodetype file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/netbiosnodetype_1836.txt
      dest: C:\facts\policyfiles\netbiosnodetype_1836.txt
    when: ((database.stdout_lines[1]|from_json).netbiosnodetype_1836_actual) != "0x2"
    tags:
      - netbiosnodetype
      - rollbackeighteen
      - 18.3.6
      - all
      - rollback

  - name: adding value to the netbiosnodetype file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\netbiosnodetype_1836.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).netbiosnodetype_1836_actual}}'
    when: ((database.stdout_lines[1]|from_json).netbiosnodetype_1836_actual) != "0x2" and ((database.stdout_lines[1]|from_json).netbiosnodetype_1836_actual) != "DELETE"
    tags:
      - netbiosnodetype
      - eighteen
      - 18.3.6
      - all
      - rollback

  - name: adding value to the netbiosnodetype_1836 file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\netbiosnodetype_1836.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).netbiosnodetype_1836_actual) == "DELETE"
    tags:
      - netbiosnodetype
      - eighteen
      - 18.3.6
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\netbiosnodetype_1836.txt'
    when: ((database.stdout_lines[1]|from_json).netbiosnodetype_1836_actual) != "0x2"
    tags:
      - netbiosnodetype
      - eighteen
      - 18.3.6
      - all
      - rollback
      
  - name: copying wdigestauthen file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/wdigestauthen_1837.txt
      dest: C:\facts\policyfiles\wdigestauthen_1837.txt
    when: ((database.stdout_lines[1]|from_json).wdigestauthen_1837_actual) != "0x0"
    tags:
      - wdigestauthen
      - eighteen
      - 18.3.7
      - all
      - rollback

  - name: adding value to the wdigestauthen file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\wdigestauthen_1837.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).wdigestauthen_1837_actual}}'
    when: ((database.stdout_lines[1]|from_json).wdigestauthen_1837_actual) != "0x0" and ((database.stdout_lines[1]|from_json).wdigestauthen_1837_actual) != "DELETE"
    tags:
      - wdigestauthen
      - eighteen
      - 18.3.7
      - all
      - rollback

  - name: adding value to the wdigestauthen file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\wdigestauthen_1837.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).wdigestauthen_1837_actual) == "DELETE"
    tags:
      - wdigestauthen
      - eighteen
      - 18.3.7
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\wdigestauthen_1837.txt'
    when: ((database.stdout_lines[1]|from_json).wdigestauthen_1837_actual) != "0x0"
    tags:
      - wdigestauthen
      - eighteen
      - 18.3.7
      - all
      - rollback
      
  - name: copying autologon file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/autologon_1841.txt
      dest: C:\facts\policyfiles\autologon_1841.txt
    when: ((database.stdout_lines[1]|from_json).autologon_1841_actual) != "0"
    tags:
      - autologon
      - eighteen
      - 18.4.1
      - all
      - rollback

  - name: adding value to the autologon file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\autologon_1841.txt
       regex: '^(SZ:*)'
       line: 'SZ:{{(database.stdout_lines[1]|from_json).autologon_1841_actual}}'
    when: ((database.stdout_lines[1]|from_json).autologon_1841_actual) != "0" and ((database.stdout_lines[1]|from_json).autologon_1841_actual) != "DELETE"
    tags:
      - autologon
      - eighteen
      - 18.4.1
      - all
      - rollback

  - name: adding value to the autologon file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\autologon_1841.txt
       regex: '^(SZ:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).autologon_1841_actual) == "DELETE"
    tags:
      - autologon
      - eighteen
      - 18.4.1
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\autologon_1841.txt'
    when: ((database.stdout_lines[1]|from_json).autologon_1841_actual) != "0"
    tags:
      - autologon
      - eighteen
      - 18.4.1
      - all
      - rollback
      
  - name: copying ipsourcerouting file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/ipsourcerouting_1842.txt
      dest: C:\facts\policyfiles\ipsourcerouting_1842.txt
    when: ((database.stdout_lines[1]|from_json).ipsourcerouting_1842_actual) != "0x2"
    tags:
      - ipsourcerouting
      - eighteen
      - 18.4.2
      - all
      - rollback

  - name: adding value to the ipsourcerouting file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\ipsourcerouting_1842.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).ipsourcerouting_1842_actual}}'
    when: ((database.stdout_lines[1]|from_json).ipsourcerouting_1842_actual) != "0x2" and ((database.stdout_lines[1]|from_json).ipsourcerouting_1842_actual) != "DELETE"
    tags:
      - ipsourcerouting
      - eighteen
      - 18.4.2
      - all
      - rollback

  - name: adding value to the ipsourcerouting file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\ipsourcerouting_1842.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).ipsourcerouting_1842_actual) == "DELETE"
    tags:
      - ipsourcerouting
      - eighteen
      - 18.4.2
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\ipsourcerouting_1842.txt'
    when: ((database.stdout_lines[1]|from_json).ipsourcerouting_1842_actual) != "0x2"
    tags:
      - ipsourcerouting
      - eighteen
      - 18.4.2
      - all
      - rollback
      
  - name: copying ipsourceroutprotect file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/ipsourceroutprotect_1843.txt
      dest: C:\facts\policyfiles\ipsourceroutprotect_1843.txt
    when: ((database.stdout_lines[1]|from_json).ipsourceroutprotect_1843_actual) != "0x2"
    tags:
      - ipsourceroutprotect
      - eighteen
      - 18.4.3
      - all
      - rollback

  - name: adding value to the ipsourceroutprotect file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\ipsourceroutprotect_1843.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).ipsourceroutprotect_1843_actual}}'
    when: ((database.stdout_lines[1]|from_json).ipsourceroutprotect_1843_actual) != "0x2" and ((database.stdout_lines[1]|from_json).ipsourceroutprotect_1843_actual) != "DELETE"
    tags:
      - ipsourceroutprotect
      - eighteen
      - 18.4.3
      - all
      - rollback

  - name: adding value to the ipsourceroutprotect file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\ipsourceroutprotect_1843.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).ipsourceroutprotect_1843_actual) == "DELETE"
    tags:
      - ipsourceroutprotect
      - eighteen
      - 18.4.3
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\ipsourceroutprotect_1843.txt'
    when: ((database.stdout_lines[1]|from_json).ipsourceroutprotect_1843_actual) != "0x2"
    tags:
      - ipsourceroutprotect
      - eighteen
      - 18.4.3
      - all
      - rollback
      
  - name: copying icmpredirects file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/icmpredirects_1844.txt
      dest: C:\facts\policyfiles\icmpredirects_1844.txt
    when: ((database.stdout_lines[1]|from_json).icmpredirects_1844_actual) != "0x0"
    tags:
      - icmpredirects
      - eighteen
      - 18.4.4
      - all
      - rollback

  - name: adding value to the icmpredirects file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\icmpredirects_1844.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).icmpredirects_1844_actual}}'
    when: ((database.stdout_lines[1]|from_json).icmpredirects_1844_actual) != "0x0" and ((database.stdout_lines[1]|from_json).icmpredirects_1844_actual) != "DELETE"
    tags:
      - icmpredirects
      - eighteen
      - 18.4.4
      - all
      - rollback

  - name: adding value to the icmpredirects file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\icmpredirects_1844.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).icmpredirects_1844_actual) == "DELETE"
    tags:
      - icmpredirects
      - eighteen
      - 18.4.4
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\icmpredirects_1844.txt'
    when: ((database.stdout_lines[1]|from_json).icmpredirects_1844_actual) != "0x0"
    tags:
      - icmpredirects
      - eighteen
      - 18.4.4
      - all
      - rollback
      
  - name: copying keepalivetime file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/keepalivetime_1845.txt
      dest: C:\facts\policyfiles\keepalivetime_1845.txt
    when: ((database.stdout_lines[1]|from_json).keepalivetime_1845_actual) != "0x493e0"
    tags:
      - keepalivetime
      - eighteen
      - 18.4.5
      - all
      - rollback

  - name: adding value to the keepalivetime file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\keepalivetime_1845.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).keepalivetime_1845_actual}}'
    when: ((database.stdout_lines[1]|from_json).keepalivetime_1845_actual) != "0x493e0" and ((database.stdout_lines[1]|from_json).keepalivetime_1845_actual) != "DELETE"
    tags:
      - keepalivetime
      - eighteen
      - 18.4.5
      - all
      - rollback

  - name: adding value to the keepalivetime file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\keepalivetime_1845.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).keepalivetime_1845_actual) == "DELETE"
    tags:
      - keepalivetime
      - eighteen
      - 18.4.5
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\keepalivetime_1845.txt'
    when: ((database.stdout_lines[1]|from_json).keepalivetime_1845_actual) != "0x493e0"
    tags:
      - keepalivetime
      - eighteen
      - 18.4.5
      - all
      - rollback
      
  - name: copying nonamerelease file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/nonamerelease_1846.txt
      dest: C:\facts\policyfiles\nonamerelease_1846.txt
    when: ((database.stdout_lines[1]|from_json).nonamerelease_1846_actual) != "0x1"
    tags:
      - nonamerelease
      - eighteen
      - 18.4.6
      - all
      - rollback

  - name: adding value to the nonamerelease file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\nonamerelease_1846.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).nonamerelease_1846_actual}}'
    when: ((database.stdout_lines[1]|from_json).nonamerelease_1846_actual) != "0x1" and ((database.stdout_lines[1]|from_json).nonamerelease_1846_actual) != "DELETE"
    tags:
      - nonamerelease
      - eighteen
      - 18.4.6
      - all
      - rollback

  - name: adding value to the nonamerelease file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\nonamerelease_1846.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).nonamerelease_1846_actual) == "DELETE"
    tags:
      - nonamerelease
      - eighteen
      - 18.4.6
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\nonamerelease_1846.txt'
    when: ((database.stdout_lines[1]|from_json).nonamerelease_1846_actual) != "0x1"
    tags:
      - nonamerelease
      - eighteen
      - 18.4.6
      - all
      - rollback
      
  - name: copying perfroutdiscovery file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/perfroutdiscovery_1847.txt
      dest: C:\facts\policyfiles\perfroutdiscovery_1847.txt
    when: ((database.stdout_lines[1]|from_json).perfroutdiscovery_1847_actual) != "0x0"
    tags:
      - perfroutdiscovery
      - eighteen
      - 18.4.7
      - all
      - rollback

  - name: adding value to the perfroutdiscovery file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\perfroutdiscovery_1847.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).perfroutdiscovery_1847_actual}}'
    when: ((database.stdout_lines[1]|from_json).perfroutdiscovery_1847_actual) != "0x0" and ((database.stdout_lines[1]|from_json).perfroutdiscovery_1847_actual) != "DELETE"
    tags:
      - perfroutdiscovery
      - eighteen
      - 18.4.7
      - all
      - rollback

  - name: adding value to the perfroutdiscovery file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\perfroutdiscovery_1847.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).perfroutdiscovery_1847_actual) == "DELETE"
    tags:
      - perfroutdiscovery
      - eighteen
      - 18.4.7
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\perfroutdiscovery_1847.txt'
    when: ((database.stdout_lines[1]|from_json).perfroutdiscovery_1847_actual) != "0x0"
    tags:
      - perfroutdiscovery
      - eighteen
      - 18.4.7
      - all
      - rollback
      
  - name: copying safedllsearchmode file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/safedllsearchmode_1848.txt
      dest: C:\facts\policyfiles\safedllsearchmode_1848.txt
    when: ((database.stdout_lines[1]|from_json).safedllsearchmode_1848_actual) != "0x1"
    tags:
      - safedllsearchmode
      - eighteen
      - 18.4.8
      - all
      - rollback

  - name: adding value to the safedllsearchmode file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\safedllsearchmode_1848.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).safedllsearchmode_1848_actual}}'
    when: ((database.stdout_lines[1]|from_json).safedllsearchmode_1848_actual) != "0x1" and ((database.stdout_lines[1]|from_json).safedllsearchmode_1848_actual) != "DELETE"
    tags:
      - safedllsearchmode
      - eighteen
      - 18.4.8
      - all
      - rollback

  - name: adding value to the safedllsearchmode file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\safedllsearchmode_1848.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).safedllsearchmode_1848_actual) == "DELETE"
    tags:
      - safedllsearchmode
      - eighteen
      - 18.4.8
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\safedllsearchmode_1848.txt'
    when: ((database.stdout_lines[1]|from_json).safedllsearchmode_1848_actual) != "0x1"
    tags:
      - safedllsearchmode
      - eighteen
      - 18.4.8
      - all
      - rollback
      
  - name: copying screensavertime file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/screensavertime_1849.txt
      dest: C:\facts\policyfiles\screensavertime_1849.txt
    when: ((database.stdout_lines[1]|from_json).screensavertime_1849_actual) > "5"
    tags:
      - screensavertime
      - eighteen
      - 18.4.9
      - all
      - rollback

  - name: adding value to the screensavertime file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\screensavertime_1849.txt
       regex: '^(SZ:*)'
       line: 'SZ:{{(database.stdout_lines[1]|from_json).screensavertime_1849_actual}}'
    when: ((database.stdout_lines[1]|from_json).screensavertime_1849_actual) > "5" and ((database.stdout_lines[1]|from_json).screensavertime_1849_actual) != "DELETE"
    tags:
      - screensavertime
      - eighteen
      - 18.4.9
      - all
      - rollback

  - name: adding value to the screensavertime file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\screensavertime_1849.txt
       regex: '^(SZ:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).screensavertime_1849_actual) == "DELETE"
    tags:
      - screensavertime
      - eighteen
      - 18.4.9
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\screensavertime_1849.txt'
    when: ((database.stdout_lines[1]|from_json).screensavertime_1849_actual) > "5"
    tags:
      - screensavertime
      - eighteen
      - 18.4.9
      - all
      - rollback
      
  - name: copying tcpmaxdataretransipv6 file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/tcpmaxdataretransipv6_18410.txt
      dest: C:\facts\policyfiles\tcpmaxdataretransipv6_18410.txt
    when: ((database.stdout_lines[1]|from_json).tcpmaxdataretransipv6_18410_actual) != "0x1"
    tags:
      - tcpmaxdataretransipv6
      - eighteen
      - 18.4.10
      - all
      - rollback

  - name: adding value to the tcpmaxdataretransipv6 file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\tcpmaxdataretransipv6_18410.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).tcpmaxdataretransipv6_18410_actual}}'
    when: ((database.stdout_lines[1]|from_json).tcpmaxdataretransipv6_18410_actual) != "0x1" and ((database.stdout_lines[1]|from_json).tcpmaxdataretransipv6_18410_actual) != "DELETE"
    tags:
      - tcpmaxdataretransipv6
      - eighteen
      - 18.4.10
      - all
      - rollback

  - name: adding value to the tcpmaxdataretransipv6 file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\tcpmaxdataretransipv6_18410.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).tcpmaxdataretransipv6_18410_actual) == "DELETE"
    tags:
      - tcpmaxdataretransipv6
      - eighteen
      - 18.4.10
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\tcpmaxdataretransipv6_18410.txt'
    when: ((database.stdout_lines[1]|from_json).tcpmaxdataretransipv6_18410_actual) != "0x1"
    tags:
      - tcpmaxdataretransipv6
      - eighteen
      - 18.4.10
      - all
      - rollback
      
  - name: copying tcpmaxdataretrans file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/tcpmaxdataretrans_18411.txt
      dest: C:\facts\policyfiles\tcpmaxdataretrans_18411.txt
    when: ((database.stdout_lines[1]|from_json).tcpmaxdataretrans_18411_actual) != "0x1"
    tags:
      - tcpmaxdataretrans
      - eighteen
      - 18.4.11
      - all
      - rollback

  - name: adding value to the tcpmaxdataretrans file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\tcpmaxdataretrans_18411.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).tcpmaxdataretrans_18411_actual}}'
    when: ((database.stdout_lines[1]|from_json).tcpmaxdataretrans_18411_actual) != "0x1" and ((database.stdout_lines[1]|from_json).tcpmaxdataretrans_18411_actual) != "DELETE"
    tags:
      - tcpmaxdataretrans
      - eighteen
      - 18.4.11
      - all
      - rollback

  - name: adding value to the tcpmaxdataretrans file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\tcpmaxdataretrans_18411.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).tcpmaxdataretrans_18411_actual) == "DELETE"
    tags:
      - tcpmaxdataretrans
      - eighteen
      - 18.4.11
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\tcpmaxdataretrans_18411.txt'
    when: ((database.stdout_lines[1]|from_json).tcpmaxdataretrans_18411_actual) != "0x1"
    tags:
      - tcpmaxdataretrans
      - eighteen
      - 18.4.11
      - all
      - rollback
      
  - name: copying warninglevel file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/warninglevel_18412.txt
      dest: C:\facts\policyfiles\warninglevel_18412.txt
    when: ((database.stdout_lines[1]|from_json).warninglevel_18412_actual) != "0x5a"
    tags:
      - warninglevel
      - eighteen
      - 18.4.12
      - all
      - rollback

  - name: adding value to the warninglevel file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\warninglevel_18412.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).warninglevel_18412_actual}}'
    when: ((database.stdout_lines[1]|from_json).warninglevel_18412_actual) != "0x5a" and ((database.stdout_lines[1]|from_json).warninglevel_18412_actual) != "DELETE"
    tags:
      - warninglevel
      - eighteen
      - 18.4.12
      - all
      - rollback

  - name: adding value to the warninglevel file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\warninglevel_18412.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).warninglevel_18412_actual) == "DELETE"
    tags:
      - warninglevel
      - eighteen
      - 18.4.12
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\warninglevel_18412.txt'
    when: ((database.stdout_lines[1]|from_json).warninglevel_18412_actual) != "0x5a"
    tags:
      - warninglevel
      - eighteen
      - 18.4.12
      - all
      - rollback
      
  - name: copying turnoffmulticastname file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnoffmulticastname_18541.txt
      dest: C:\facts\policyfiles\turnoffmulticastname_18541.txt
    when: ((database.stdout_lines[1]|from_json).turnoffmulticastname_18541_actual) != "0x1"
    tags:
      - turnoffmulticastname
      - eighteen
      - 18.5.4.1
      - all
      - rollback

  - name: adding value to the turnoffmulticastname file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffmulticastname_18541.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnoffmulticastname_18541_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnoffmulticastname_18541_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnoffmulticastname_18541_actual) != "DELETE"
    tags:
      - turnoffmulticastname
      - eighteen
      - 18.5.4.1
      - all
      - rollback

  - name: adding value to the turnoffmulticastname file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffmulticastname_18541.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnoffmulticastname_18541_actual) == "DELETE"
    tags:
      - turnoffmulticastname
      - eighteen
      - 18.5.4.1
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffmulticastname_18541.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffmulticastname_18541_actual) != "0x1"
    tags:
      - turnoffmulticastname
      - eighteen
      - 18.5.4.1
      - all
      - rollback
      
  - name: copying fontproviders file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/fontproviders_18551.txt
      dest: C:\facts\policyfiles\fontproviders_18551.txt
    when: ((database.stdout_lines[1]|from_json).fontproviders_18551_actual) != "0x0"
    tags:
      - fontproviders
      - 18.5.5.1
      - eighteen
      - all
      - rollback

  - name: adding value to the fontproviders file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\fontproviders_18551.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).fontproviders_18551_actual}}'
    when: ((database.stdout_lines[1]|from_json).fontproviders_18551_actual) != "0x0" and ((database.stdout_lines[1]|from_json).fontproviders_18551_actual) != "DELETE"
    tags:
      - fontproviders
      - 18.5.5.1
      - eighteen
      - all
      - rollback

  - name: adding value to the fontproviders file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\fontproviders_18551.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).fontproviders_18551_actual) == "DELETE"
    tags:
      - fontproviders
      - 18.5.5.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\fontproviders_18551.txt'
    when: ((database.stdout_lines[1]|from_json).fontproviders_18551_actual) != "0x0"
    tags:
      - fontproviders
      - 18.5.5.1
      - eighteen
      - all
      - rollback
      
  - name: copying insecureguestlogon file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/insecureguestlogon_18581.txt
      dest: C:\facts\policyfiles\insecureguestlogon_18581.txt
    when: ((database.stdout_lines[1]|from_json).insecureguestlogon_18581_actual) != "0x0"
    tags:
      - insecureguestlogon
      - 18.5.8.1
      - eighteen
      - all
      - rollback

  - name: adding value to the insecureguestlogon file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\insecureguestlogon_18581.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).insecureguestlogon_18581_actual}}'
    when: ((database.stdout_lines[1]|from_json).insecureguestlogon_18581_actual) != "0x0" and ((database.stdout_lines[1]|from_json).insecureguestlogon_18581_actual) != "DELETE"
    tags:
      - insecureguestlogon
      - 18.5.8.1
      - eighteen
      - all
      - rollback

  - name: adding value to the insecureguestlogon file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\insecureguestlogon_18581.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).insecureguestlogon_18581_actual) == "DELETE"
    tags:
      - insecureguestlogon
      - 18.5.8.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\insecureguestlogon_18581.txt'
    when: ((database.stdout_lines[1]|from_json).insecureguestlogon_18581_actual) != "0x0"
    tags:
      - insecureguestlogon
      - 18.5.8.1
      - eighteen
      - all
      - rollback
      
  - name: copying mapperiodriver file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/mapperiodriver_18591.txt
      dest: C:\facts\policyfiles\mapperiodriver_18591.txt
    when: ((database.stdout_lines[1]|from_json).mapperiodriver_18591_actual) != "0x0 0x0 0x0 0x0"
    tags:
      - mapperiodriver
      - 18.5.9.1
      - eighteen
      - all
      - rollback

  - name: adding value to the mapperiodriver file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\mapperiodriver_18591.txt
       regex: '{{ item.regex }}'
       line: '{{ item.line }}'
    with_items:
       - { regex: "^(AllowLLTDIOOnDomain )", line: "AllowLLTDIOOnDomain\nDWORD:{{ (database.stdout_lines[1]|from_json).mapperiodriver_18591_actual.split(' ')[0] }}" }
       - { regex: "^(AllowLLTDIOOnPublicNet )", line: "AllowLLTDIOOnPublicNet\nDWORD:{{ (database.stdout_lines[1]|from_json).mapperiodriver_18591_actual.split(' ')[1] }}" }
       - { regex: "^(EnableLLTDIO )", line: "EnableLLTDIO\nDWORD:{{ (database.stdout_lines[1]|from_json).mapperiodriver_18591_actual.split(' ')[2] }}" }
       - { regex: "^(ProhibitLLTDIOOnPrivateNet )", line: "ProhibitLLTDIOOnPrivateNet\nDWORD:{{ (database.stdout_lines[1]|from_json).mapperiodriver_18591_actual.split(' ')[3] }}" }	   
    when: ((database.stdout_lines[1]|from_json).mapperiodriver_18591_actual) != "0x0 0x0 0x0 0x0" and ((database.stdout_lines[1]|from_json).mapperiodriver_18591_actual) != "DELETE"
    tags:
      - mapperiodriver
      - 18.5.9.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the mapperiodriver file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\mapperiodriver_18591.txt
       regex: '{{ item.regex }}'
       line: '{{ item.line }}'
    with_items:
       - { regex: "^(AllowLLTDIOOnDomain )", line: "AllowLLTDIOOnDomain\nDELETE" }
       - { regex: "^(AllowLLTDIOOnPublicNet )", line: "AllowLLTDIOOnPublicNet\nDELETE" }
       - { regex: "^(EnableLLTDIO )", line: "EnableLLTDIO\nDELETE" }
       - { regex: "^(ProhibitLLTDIOOnPrivateNet )", line: "ProhibitLLTDIOOnPrivateNet\nDELETE" }	   
    when: ((database.stdout_lines[1]|from_json).mapperiodriver_18591_actual) == "DELETE"
    tags:
      - mapperiodriver
      - 18.5.9.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\mapperiodriver_18591.txt'
    when: ((database.stdout_lines[1]|from_json).mapperiodriver_18591_actual) != "0x0 0x0 0x0 0x0"
    tags:
      - mapperiodriver
      - 18.5.9.1
      - eighteen
      - all
      - rollback
      
  - name: copying responderdriver file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/responderdriver_18592.txt
      dest: C:\facts\policyfiles\responderdriver_18592.txt
    when: ((database.stdout_lines[1]|from_json).responderdriver_18592_actual) != "0x0 0x0 0x0 0x0"
    tags:
      - responderdriver
      - 18.5.9.2
      - eighteen
      - all
      - rollback

  - name: adding value to the responderdriver file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\responderdriver_18592.txt
       regex: '{{ item.regex }}'
       line: '{{ item.line }}'
    with_items:
       - { regex: '^(AllowRspndrOnDomain )', line: "AllowRspndrOnDomain\nDWORD:{{ (database.stdout_lines[1]|from_json).responderdriver_18592_actual.split(' ')[0] }}" }
       - { regex: '^(AllowRspndrOnPublicNet )', line: "AllowRspndrOnPublicNet\nDWORD:{{ (database.stdout_lines[1]|from_json).responderdriver_18592_actual.split(' ')[1] }}" }
       - { regex: '^(EnableRspndr )', line: "EnableRspndr\nDWORD:{{ (database.stdout_lines[1]|from_json).responderdriver_18592_actual.split(' ')[2] }}" }
       - { regex: '^(ProhibitRspndrOnPrivateNet )', line: "ProhibitRspndrOnPrivateNet\nDWORD:{{ (database.stdout_lines[1]|from_json).responderdriver_18592_actual.split(' ')[3] }}" }	   
    when: ((database.stdout_lines[1]|from_json).responderdriver_18592_actual) != "0x0 0x0 0x0 0x0" and ((database.stdout_lines[1]|from_json).responderdriver_18592_actual) != "DELETE"
    tags:
      - responderdriver
      - 18.5.9.2
      - eighteen
      - all
      - rollback

  - name: adding value to the responderdriver file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\responderdriver_18592.txt
       regex: '{{ item.regex }}'
       line: '{{ item.line }}'
    with_items:
       - { regex: '^(AllowRspndrOnDomain )', line: "AllowRspndrOnDomain\nDELETE" }
       - { regex: '^(AllowRspndrOnPublicNet )', line: "AllowRspndrOnPublicNet\nDELETE" }
       - { regex: '^(EnableRspndr )', line: "EnableRspndr\nDELETE" }
       - { regex: '^(ProhibitRspndrOnPrivateNet )', line: "ProhibitRspndrOnPrivateNet\nDELETE" } 
    when: ((database.stdout_lines[1]|from_json).responderdriver_18592_actual) == "DELETE"
    tags:
      - responderdriver
      - 18.5.9.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\responderdriver_18592.txt'
    when: ((database.stdout_lines[1]|from_json).responderdriver_18592_actual) != "0x0 0x0 0x0 0x0"
    tags:
      - responderdriver
      - 18.5.9.2
      - eighteen
      - all
      - rollback
      
  - name: copying mspeernetserv file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/mspeernetserv_185102.txt
      dest: C:\facts\policyfiles\mspeernetserv_185102.txt
    when: ((database.stdout_lines[1]|from_json).mspeernetserv_185102_actual) != "0x1"
    tags:
      - mspeernetserv
      - 18.5.10.2
      - eighteen
      - all
      - rollback

  - name: adding value to the mspeernetserv file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\mspeernetserv_185102.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).mspeernetserv_185102_actual}}'
    when: ((database.stdout_lines[1]|from_json).mspeernetserv_185102_actual) != "0x1" and ((database.stdout_lines[1]|from_json).mspeernetserv_185102_actual) != "DELETE"
    tags:
      - mspeernetserv
      - 18.5.10.2
      - eighteen
      - all
      - rollback

  - name: adding value to the mspeernetserv file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\mspeernetserv_185102.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).mspeernetserv_185102_actual) == "DELETE"
    tags:
      - mspeernetserv
      - 18.5.10.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\mspeernetserv_185102.txt'
    when: ((database.stdout_lines[1]|from_json).mspeernetserv_185102_actual) != "0x1"
    tags:
      - mspeernetserv
      - 18.5.10.2
      - eighteen
      - all
      - rollback
      
  - name: copying confnetbridge file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/confnetbridge_185112.txt
      dest: C:\facts\policyfiles\confnetbridge_185112.txt
    when: ((database.stdout_lines[1]|from_json).confnetbridge_185112_actual) != "0x0"
    tags:
      - confnetbridge
      - 18.5.11.2
      - eighteen
      - all
      - rollback

  - name: adding value to the confnetbridge file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confnetbridge_185112.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).confnetbridge_185112_actual}}'
    when: ((database.stdout_lines[1]|from_json).confnetbridge_185112_actual) != "0x0" and ((database.stdout_lines[1]|from_json).confnetbridge_185112_actual) != "DELETE"
    tags:
      - confnetbridge
      - 18.5.11.2
      - eighteen
      - all
      - rollback

  - name: adding value to the confnetbridge file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confnetbridge_185112.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).confnetbridge_185112_actual) == "DELETE"
    tags:
      - confnetbridge
      - 18.5.11.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\confnetbridge_185112.txt'
    when: ((database.stdout_lines[1]|from_json).confnetbridge_185112_actual) != "0x0"
    tags:
      - confnetbridge
      - 18.5.11.2
      - eighteen
      - all
      - rollback
      
  - name: copying interconnsharing file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/interconnsharing_185113.txt
      dest: C:\facts\policyfiles\interconnsharing_185113.txt
    when: ((database.stdout_lines[1]|from_json).interconnsharing_185113_actual) != "0x1"
    tags:
      - interconnsharing
      - 18.5.11.3
      - eighteen
      - all
      - rollback

  - name: adding value to the interconnsharing file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\interconnsharing_185113.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).interconnsharing_185113_actual}}'
    when: ((database.stdout_lines[1]|from_json).interconnsharing_185113_actual) != "0x1" and ((database.stdout_lines[1]|from_json).interconnsharing_185113_actual) != "DELETE"
    tags:
      - interconnsharing
      - 18.5.11.3
      - eighteen
      - all
      - rollback

  - name: adding value to the interconnsharing file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\interconnsharing_185113.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).interconnsharing_185113_actual) == "DELETE"
    tags:
      - interconnsharing
      - 18.5.11.3
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\interconnsharing_185113.txt'
    when: ((database.stdout_lines[1]|from_json).interconnsharing_185113_actual) != "0x1"
    tags:
      - interconnsharing
      - 18.5.11.3
      - eighteen
      - all
      - rollback
      
  - name: copying domainusrnetloc file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/domainusrnetloc_185114.txt
      dest: C:\facts\policyfiles\domainusrnetloc_185114.txt
    when: ((database.stdout_lines[1]|from_json).domainusrnetloc_185114_actual) != "0x1"
    tags:
      - domainusrnetloc
      - 18.5.11.4
      - eighteen
      - all
      - rollback

  - name: adding value to the domainusrnetloc file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\domainusrnetloc_185114.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).domainusrnetloc_185114_actual}}'
    when: ((database.stdout_lines[1]|from_json).domainusrnetloc_185114_actual) != "0x1" and ((database.stdout_lines[1]|from_json).domainusrnetloc_185114_actual) != "DELETE"
    tags:
      - domainusrnetloc
      - 18.5.11.4
      - eighteen
      - all
      - rollback

  - name: adding value to the domainusrnetloc file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\domainusrnetloc_185114.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).domainusrnetloc_185114_actual) == "DELETE"
    tags:
      - domainusrnetloc
      - 18.5.11.4
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\domainusrnetloc_185114.txt'
    when: ((database.stdout_lines[1]|from_json).domainusrnetloc_185114_actual) != "0x1"
    tags:
      - domainusrnetloc
      - 18.5.11.4
      - eighteen
      - all
      - rollback

  - name: copying hardeneduncpath file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/hardeneduncpath_185141.txt
      dest: C:\facts\policyfiles\hardeneduncpath_185141.txt
    when: ((database.stdout_lines[1]|from_json).hardeneduncpath_185141_actual) != "1 1"
    tags:
      - hardeneduncpath
      - 18.5.14.1
      - eighteen
      - all
      - rollback

  - name: adding value to the hardeneduncpath file for rollback
    win_shell: |
       Add-Content -Path "C:\facts\policyfiles\hardeneduncpath_185141.txt" -Value "`r`nComputer`r`nSoftware\Policies\Microsoft\Windows\NetworkProvider\HardenedPaths`r`n\\*\NETLOGON`r`nDELETE"
       Add-Content -Path "C:\facts\policyfiles\hardeneduncpath_185141.txt" -Value "`r`nComputer`r`nSoftware\Policies\Microsoft\Windows\NetworkProvider\HardenedPaths`r`n\\*\SYSVOL`r`nDELETE"
    when: ((database.stdout_lines[1]|from_json).hardeneduncpath_185141_actual) != "1 1" and ((database.stdout_lines[1]|from_json).hardeneduncpath_185141_actual) != "DELETE"
    tags:
      - hardeneduncpath
      - 18.5.14.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: '{{ item }}'
    with_items:
      - 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\hardeneduncpath_185141.txt'
      - 'Clear-Content C:\facts\policyfiles\hardeneduncpath_185141.txt'
    when: ((database.stdout_lines[1]|from_json).hardeneduncpath_185141_actual) != "1 1" and ((database.stdout_lines[1]|from_json).hardeneduncpath_185141_actual) != "DELETE"
    tags:
      - hardeneduncpath
      - 18.5.14.1
      - eighteen
      - all
      - rollback

  - name: adding content to set hardeneduncpath file
    win_shell: |
       Add-Content -Path "C:\facts\policyfiles\hardeneduncpath_185141.txt" -Value "`r`nComputer`r`nSoftware\Policies\Microsoft\Windows\NetworkProvider\HardenedPaths`r`n{{ item }}`r`nSZ:1"
    loop: "{{(database.stdout_lines[1]|from_json).hardeneduncpath_185141_actual.split(' ')}}"
    when: ((database.stdout_lines[1]|from_json).hardeneduncpath_185141_actual) != "1 1" and ((database.stdout_lines[1]|from_json).hardeneduncpath_185141_actual) != "DELETE"
    tags:
      - hardeneduncpath
      - 18.5.14.1
      - eighteen
      - all
      - rollback

  - name: adding content to set hardeneduncpath file
    win_shell: |
       Add-Content -Path "C:\facts\policyfiles\hardeneduncpath_185141.txt" -Value "`r`nComputer`r`nSoftware\Policies\Microsoft\Windows\NetworkProvider\HardenedPaths`r`n\\*\NETLOGON`r`nDELETE"
       Add-Content -Path "C:\facts\policyfiles\hardeneduncpath_185141.txt" -Value "`r`nComputer`r`nSoftware\Policies\Microsoft\Windows\NetworkProvider\HardenedPaths`r`n\\*\SYSVOL`r`nDELETE"
    when: ((database.stdout_lines[1]|from_json).hardeneduncpath_185141_actual) == "DELETE"
    tags:
      - hardeneduncpath
      - 18.5.14.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\hardeneduncpath_185141.txt'
    when: ((database.stdout_lines[1]|from_json).hardeneduncpath_185141_actual) != "1 1"
    tags:
      - hardeneduncpath
      - 18.5.14.1
      - eighteen
      - all
      - rollback
      
  - name: Rollback disableipv6
    win_regedit:
      path: HKLM:\SYSTEM\CurrentControlSet\Services\TCPIP6\Parameters
      name: "DisabledComponents"
      data: "0xff"
      type: dword
      state: absent
    when: ((database.stdout_lines[1]|from_json).disableipv6_1851921_actual) != "0xff"
    tags:
      - disableipv6
      - 18.5.19.2.1
      - eighteen
      - all
      - rollback
      
  - name: copying confwirelessset file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/confwirelessset_185201.txt
      dest: C:\facts\policyfiles\confwirelessset_185201.txt
    when: ((database.stdout_lines[1]|from_json).confwirelessset_185201_actual) != "0x0 0x0 0x0 0x0 0x0"
    tags:
      - confwirelessset
      - 18.5.20.1
      - eighteen
      - all 
      - rollback

  - name: adding value to the confwirelesssel file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confwirelessset_185201.txt
       regex: '{{ item.regex }}'
       line: '{{ item.line }}'
    with_items:
       - { regex: "^(EnableRegistrars )", line: "EnableRegistrars\nDWORD:{{ (database.stdout_lines[1]|from_json).confwirelessset_185201_actual.split(' ')[0] }}" }
       - { regex: "^(DisableUPnPRegistrar )", line: "DisableUPnPRegistrar\nDWORD:{{ (database.stdout_lines[1]|from_json).confwirelessset_185201_actual.split(' ')[1] }}" }
       - { regex: "^(DisableInBand802DOT11Registrar )", line: "DisableInBand802DOT11Registrar\nDWORD:{{ (database.stdout_lines[1]|from_json).confwirelessset_185201_actual.split(' ')[2] }}" }
       - { regex: "^(DisableFlashConfigRegistrar )", line: "DisableFlashConfigRegistrar\nDWORD:{{ (database.stdout_lines[1]|from_json).confwirelessset_185201_actual.split(' ')[3] }}" }
       - { regex: "^(DisableWPDRegistrar )", line: "DisableWPDRegistrar\nDWORD:{{ (database.stdout_lines[1]|from_json).confwirelessset_185201_actual.split(' ')[4] }}" }
    when: ((database.stdout_lines[1]|from_json).confwirelessset_185201_actual) != "0x0 0x0 0x0 0x0 0x0" and ((database.stdout_lines[1]|from_json).confwirelessset_185201_actual) != "DELETE"
    tags:
      - confwirelessset
      - 18.5.20.1
      - eighteen
      - all 
      - rollback

  - name: adding value to the confwirelessset file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confwirelessset_185201.txt
       regex: '{{ item.regex }}'
       line: '{{ item.line }}'
    with_items:
       - { regex: "^(EnableRegistrars )", line: "EnableRegistrars\nDELETE" }
       - { regex: "^(DisableUPnPRegistrar )", line: "DisableUPnPRegistrar\nDELETE" }
       - { regex: "^(DisableInBand802DOT11Registrar )", line: "DisableInBand802DOT11Registrar\nDELETE" }
       - { regex: "^(DisableFlashConfigRegistrar )", line: "DisableFlashConfigRegistrar\nDELETE" }
       - { regex: "^(DisableWPDRegistrar )", line: "DisableWPDRegistrar\nDELETE" } 
    when: ((database.stdout_lines[1]|from_json).confwirelessset_185201_actual) == "DELETE"
    tags:
      - confwirelessset
      - 18.5.20.1
      - eighteen
      - all 
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\confwirelessset_185201.txt'
    when: ((database.stdout_lines[1]|from_json).confwirelessset_185201_actual) != "0x0 0x0 0x0 0x0 0x0"
    tags:
      - confwirelessset
      - 18.5.20.1
      - eighteen
      - all 
      - rollback

  - name: copying winsconnectnowwiz file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/winsconnectnowwiz_185202.txt
      dest: C:\facts\policyfiles\winsconnectnowwiz_185202.txt
    when: ((database.stdout_lines[1]|from_json).winsconnectnowwiz_185202_actual) != "0x1"
    tags:
      - winsconnectnowwiz
      - 18.5.20.2
      - eighteen
      - all
      - rollback

  - name: adding value to the winsconnectnowwiz file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\winsconnectnowwiz_185202.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).winsconnectnowwiz_185202_actual}}'
    when: ((database.stdout_lines[1]|from_json).winsconnectnowwiz_185202_actual) != "0x1" and ((database.stdout_lines[1]|from_json).winsconnectnowwiz_185202_actual) != "DELETE"
    tags:
      - winsconnectnowwiz
      - 18.5.20.2
      - eighteen
      - all
      - rollback

  - name: adding value to the winsconnectnowwiz file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\winsconnectnowwiz_185202.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).winsconnectnowwiz_185202_actual) == "DELETE"
    tags:
      - winsconnectnowwiz
      - 18.5.20.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\winsconnectnowwiz_185202.txt'
    when: ((database.stdout_lines[1]|from_json).winsconnectnowwiz_185202_actual) != "0x1"
    tags:
      - winsconnectnowwiz
      - 18.5.20.2
      - eighteen
      - all
      - rollback

  - name: copying minimizeinetconn file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/minimizeinetconn_185211.txt
      dest: C:\facts\policyfiles\minimizeinetconn_185211.txt
    when: ((database.stdout_lines[1]|from_json).minimizeinetconn_185211_actual) != "0x1"
    tags:
      - minimizeinetconn
      - 18.5.21.1
      - eighteen
      - all 
      - rollback

  - name: adding value to the minimizeinetconn file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\minimizeinetconn_185211.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).minimizeinetconn_185211_actual}}'
    when: ((database.stdout_lines[1]|from_json).minimizeinetconn_185211_actual) != "0x1" and ((database.stdout_lines[1]|from_json).minimizeinetconn_185211_actual) != "DELETE"
    tags:
      - minimizeinetconn
      - 18.5.21.1
      - eighteen
      - all 
      - rollback

  - name: adding value to the minimizeinetconn file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\minimizeinetconn_185211.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).minimizeinetconn_185211_actual) == "DELETE"
    tags:
      - minimizeinetconn
      - 18.5.21.1
      - eighteen
      - all 
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\minimizeinetconn_185211.txt'
    when: ((database.stdout_lines[1]|from_json).minimizeinetconn_185211_actual) != "0x1"
    tags:
      - minimizeinetconn
      - 18.5.21.1
      - eighteen
      - all 
      - rollback

  - name: copying prohconnnondomnet file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/prohconnnondomnet_185212.txt
      dest: C:\facts\policyfiles\prohconnnondomnet_185212.txt
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).prohconnnondomnet_185212_actual) != "0x1"
    tags:
      - prohconnnondomnet
      - 18.5.21.2
      - rollbackeighteen
      - all
      - rollback

  - name: adding value to the prohconnnondomnet file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\prohconnnondomnet_185212.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).prohconnnondomnet_185212_actual}}'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).prohconnnondomnet_185212_actual) != "0x1" and ((database.stdout_lines[1]|from_json).prohconnnondomnet_185212_actual) != "DELETE"
    tags:
      - prohconnnondomnet
      - 18.5.21.2
      - eighteen
      - all
      - rollback

  - name: adding value to the prohconnnondomnet file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\prohconnnondomnet_185212.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).prohconnnondomnet_185212_actual) == "DELETE"
    tags:
      - prohconnnondomnet
      - 18.5.21.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\prohconnnondomnet_185212.txt'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).prohconnnondomnet_185212_actual) != "0x1"
    tags:
      - prohconnnondomnet
      - 18.5.21.2
      - eighteen
      - all
      - rollback

  - name: copying offnotifnetusage file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/offnotifnetusage_18711.txt
      dest: C:\facts\policyfiles\offnotifnetusage_18711.txt
    when: ((database.stdout_lines[1]|from_json).offnotifnetusage_18711_actual) != "0x1"
    tags:
      - offnotifnetusage
      - 18.7.1.1
      - eighteen
      - all
      - rollback

  - name: adding value to the offnotifnetusage file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\offnotifnetusage_18711.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).offnotifnetusage_18711_actual}}'
    when: ((database.stdout_lines[1]|from_json).offnotifnetusage_18711_actual) != "0x1" and ((database.stdout_lines[1]|from_json).offnotifnetusage_18711_actual) != "DELETE"
    tags:
      - offnotifnetusage
      - 18.7.1.1
      - eighteen
      - all
      - rollback

  - name: adding value to the offnotifnetusage file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\offnotifnetusage_18711.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).offnotifnetusage_18711_actual) == "DELETE"
    tags:
      - offnotifnetusage
      - 18.7.1.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\offnotifnetusage_18711.txt'
    when: ((database.stdout_lines[1]|from_json).offnotifnetusage_18711_actual) != "0x1"
    tags:
      - offnotifnetusage
      - 18.7.1.1
      - eighteen
      - all
      - rollback

  - name: copying cmdlineprocesscreate file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/cmdlineprocesscreate_18831.txt
      dest: C:\facts\policyfiles\cmdlineprocesscreate_18831.txt
    when: ((database.stdout_lines[1]|from_json).cmdlineprocesscreate_18831_actual) != "0x0"
    tags:
      - cmdlineprocesscreate
      - 18.8.3.1
      - eighteen
      - all
      - rollback

  - name: adding value to the cmdlineprocesscreate file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\cmdlineprocesscreate_18831.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).cmdlineprocesscreate_18831_actual}}'
    when: ((database.stdout_lines[1]|from_json).cmdlineprocesscreate_18831_actual) != "0x0" and ((database.stdout_lines[1]|from_json).cmdlineprocesscreate_18831_actual) != "DELETE"
    tags:
      - cmdlineprocesscreate
      - 18.8.3.1
      - eighteen
      - all
      - rollback

  - name: adding value to the cmdlineprocesscreate file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\cmdlineprocesscreate_18831.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).cmdlineprocesscreate_18831_actual) == "DELETE"
    tags:
      - cmdlineprocesscreate
      - 18.8.3.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\cmdlineprocesscreate_18831.txt'
    when: ((database.stdout_lines[1]|from_json).cmdlineprocesscreate_18831_actual) != "0x0"
    tags:
      - cmdlineprocesscreate
      - 18.8.3.1
      - eighteen
      - all
      - rollback

  - name: copying encryporaclerem file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/encryporaclerem_18841.txt
      dest: C:\facts\policyfiles\encryporaclerem_18841.txt
    when: ((database.stdout_lines[1]|from_json).encryptoraclerem_18841_actual) != "0x0"
    tags:
      - encryptoraclerem
      - 18.8.4.1
      - rollbackeighteen
      - all
      - rollback

  - name: adding value to the enbencryporaclerem file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\encryporaclerem_18841.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).encryporaclerem_18841_actual}}'
    when: ((database.stdout_lines[1]|from_json).encryptoraclerem_18841_actual) != "0x0" and ((database.stdout_lines[1]|from_json).encryptoraclerem_18841_actual) != "DELETE"
    tags:
      - encryptoraclerem
      - 18.8.4.1
      - eighteen
      - all
      - rollback

  - name: adding value to the enbencryporaclerem file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\encryporaclerem_18841.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).encryptoraclerem_18841_actual) == "DELETE"
    tags:
      - encryptoraclerem
      - 18.8.4.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\encryporaclerem_18841.txt'
    when: ((database.stdout_lines[1]|from_json).encryptoraclerem_18841_actual) != "0x0"
    tags:
      - encryptoraclerem
      - 18.8.4.1
      - eighteen
      - all
      - rollback

  - name: copying nonexportablecred file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/nonexportablecred_18842.txt
      dest: C:\facts\policyfiles\nonexportablecred_18842.txt
    when: ((database.stdout_lines[1]|from_json).nonexportablecred_18842_actual) != "0x1"
    tags:
      - nonexportablecred
      - 18.8.4.2
      - eighteen
      - all
      - rollback

  - name: adding value to the nonexportablecred file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\nonexportablecred_18842.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).nonexportablecred_18842_actual}}'
    when: ((database.stdout_lines[1]|from_json).nonexportablecred_18842_actual) != "0x1" and ((database.stdout_lines[1]|from_json).nonexportablecred_18842_actual) != "DELETE"
    tags:
      - nonexportablecred
      - 18.8.4.2
      - eighteen
      - all
      - rollback

  - name: adding value to the nonexportablecred file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\nonexportablecred_18842.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).nonexportablecred_18842_actual) == "DELETE"
    tags:
      - nonexportablecred
      - 18.8.4.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\nonexportablecred_18842.txt'
    when: ((database.stdout_lines[1]|from_json).nonexportablecred_18842_actual) != "0x1"
    tags:
      - nonexportablecred
      - 18.8.4.2
      - eighteen
      - all
      - rollback

  - name: copying turnonvirtual file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnonvirtual_18851.txt
      dest: C:\facts\policyfiles\turnonvirtual_18851.txt
    when: ((database.stdout_lines[1]|from_json).turnonvirtual_18851_actual) != "0x1"
    tags:
      - turnonvirtual
      - 18.8.5.1
      - eighteen
      - all
      - rollback

  - name: adding value to the turnonvirtual file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnonvirtual_18851.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnonvirtual_18851_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnonvirtual_18851_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnonvirtual_18851_actual) != "DELETE"
    tags:
      - turnonvirtual
      - 18.8.5.1
      - eighteen
      - all
      - rollback

  - name: adding value to the turnonvirtual file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnonvirtual_18851.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnonvirtual_18851_actual) == "DELETE"
    tags:
      - turnonvirtual
      - 18.8.5.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnonvirtual_18851.txt'
    when: ((database.stdout_lines[1]|from_json).turnonvirtual_18851_actual) != "0x1"
    tags:
      - turnonvirtual
      - 18.8.5.1
      - eighteen
      - all
      - rollback

  - name: copying turnonvirtplatform file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnonvirtplatform_18852.txt
      dest: C:\facts\policyfiles\turnonvirtplatform_18852.txt
    when: ((database.stdout_lines[1]|from_json).turnonvirtplatform_18852_actual) != "0x3"
    tags:
      - turnonvirtplatform
      - 18.8.5.2
      - eighteen
      - all
      - rollback

  - name: adding value to the turnonvirtplatform file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnonvirtplatform_18852.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnonvirtplatform_18852_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnonvirtplatform_18852_actual) != "0x3" and ((database.stdout_lines[1]|from_json).turnonvirtplatform_18852_actual) != "DELETE"
    tags:
      - turnonvirtplatform
      - 18.8.5.2
      - eighteen
      - all
      - rollback

  - name: adding value to the turnonvirtplatform file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnonvirtplatform_18852.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnonvirtplatform_18852_actual) == "DELETE"
    tags:
      - turnonvirtplatform
      - 18.8.5.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnonvirtplatform_18852.txt'
    when: ((database.stdout_lines[1]|from_json).turnonvirtplatform_18852_actual) != "0x3"
    tags:
      - turnonvirtplatform
      - 18.8.5.2
      - eighteen
      - all
      - rollback

  - name: copying turnonvirtcodeinteg file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnonvirtcodeinteg_18853.txt
      dest: C:\facts\policyfiles\turnonvirtcodeinteg_18853.txt
    when: ((database.stdout_lines[1]|from_json).turnonvirtcodeinteg_18853_actual) != "0x1"
    tags:
      - turnonvirtcodeinteg
      - 18.8.5.3
      - eighteen
      - all 
      - rollback

  - name: adding value to the turnonvirtcodeinteg file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnonvirtcodeinteg_18853.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnonvirtcodeinteg_18853_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnonvirtcodeinteg_18853_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnonvirtcodeinteg_18853_actual) != "DELETE"
    tags:
      - turnonvirtcodeinteg
      - 18.8.5.3
      - eighteen
      - all 
      - rollback

  - name: adding value to the turnonvirtcodeinteg file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnonvirtcodeinteg_18853.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnonvirtcodeinteg_18853_actual) == "DELETE"
    tags:
      - turnonvirtcodeinteg
      - 18.8.5.3
      - eighteen
      - all 
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnonvirtcodeinteg_18853.txt'
    when: ((database.stdout_lines[1]|from_json).turnonvirtcodeinteg_18853_actual) != "0x1"
    tags:
      - turnonvirtcodeinteg
      - 18.8.5.3
      - eighteen
      - all 
      - rollback

  - name: copying turnonvirtuefimem file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnonvirtuefimem_18854.txt
      dest: C:\facts\policyfiles\turnonvirtuefimem_18854.txt
    when: ((database.stdout_lines[1]|from_json).turnonvirtuefimem_18854_actual) != "0x1"
    tags:
      - turnonvirtuefimem
      - 18.8.5.4
      - eighteen
      - all
      - rollback

  - name: adding value to the turnonvirtuefimem file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnonvirtuefimem_18854.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnonvirtuefimem_18854_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnonvirtuefimem_18854_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnonvirtuefimem_18854_actual) != "DELETE"
    tags:
      - turnonvirtuefimem
      - 18.8.5.4
      - eighteen
      - all
      - rollback

  - name: adding value to the turnonvirtuefimem file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnonvirtuefimem_18854.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnonvirtuefimem_18854_actual) == "DELETE"
    tags:
      - turnonvirtuefimem
      - 18.8.5.4
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnonvirtuefimem_18854.txt'
    when: ((database.stdout_lines[1]|from_json).turnonvirtuefimem_18854_actual) != "0x1"
    tags:
      - turnonvirtuefimem
      - 18.8.5.4
      - eighteen
      - all
      - rollback

  - name: copying turnonvirtcredconf file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnonvirtcredconf_18855.txt
      dest: C:\facts\policyfiles\turnonvirtcredconf_18855.txt
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).turnonvirtcredconf_18855_actual) != "0x1"
    tags:
      - turnonvirtcredconf
      - 18.8.5.5
      - eighteen
      - all
      - rollback

  - name: adding value to the turnonvirtcredconf file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnonvirtcredconf_18855.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnonvirtcredconf_18855_actual}}'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).turnonvirtcredconf_18855_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnonvirtcredconf_18855_actual) != "DELETE"
    tags:
      - turnonvirtcredconf
      - 18.8.5.5
      - eighteen
      - all
      - rollback

  - name: adding value to the turnonvirtcredconf file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnonvirtcredconf_18855.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).turnonvirtcredconf_18855_actual) == "DELETE"
    tags:
      - turnonvirtcredconf
      - 18.8.5.5
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnonvirtcredconf_18855.txt'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).turnonvirtcredconf_18855_actual) != "0x1"
    tags:
      - turnonvirtcredconf
      - 18.8.5.5
      - eighteen
      - all
      - rollback

  - name: copying disabvbscredconf file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/disabvbscredconf_18856.txt
      dest: C:\facts\policyfiles\disabvbscredconf_18856.txt
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).disabvbscredconf_18856_actual) != "0x0"
    tags:
      - disabvbscredconf
      - 18.8.5.6
      - eighteen
      - all 
      - rollback

  - name: adding value to the disabvbscredconf file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\disabvbscredconf_18856.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).disabvbscredconf_18856_actual}}'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).disabvbscredconf_18856_actual) != "0x0" and ((database.stdout_lines[1]|from_json).disabvbscredconf_18856_actual) != "DELETE"
    tags:
      - disabvbscredconf
      - 18.8.5.6
      - eighteen
      - all 
      - rollback

  - name: adding value to the disabvbscredconf file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\disabvbscredconf_18856.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).disabvbscredconf_18856_actual) == "DELETE"
    tags:
      - disabvbscredconf
      - 18.8.5.6
      - eighteen
      - all 
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\disabvbscredconf_18856.txt'
    when:
      - (server_type.stdout_lines[1] | regex_search('5')) == '5'
      - ((database.stdout_lines[1]|from_json).disabvbscredconf_18856_actual) != "0x0"
    tags:
      - disabvbscredconf
      - 18.8.5.6
      - eighteen
      - all 
      - rollback

  - name: copying envbslaunchconf file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/envbslaunchconf_18857.txt
      dest: C:\facts\policyfiles\envbslaunchconf_18857.txt
    when: ((database.stdout_lines[1]|from_json).envbslaunchconf_18857_actual) != "0x1"
    tags:
      - envbslaunchconf
      - 18.8.5.7
      - eighteen
      - all
      - rollback

  - name: adding value to the envbslaunchconf file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\envbslaunchconf_18857.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).envbslaunchconf_18857_actual}}'
    when: ((database.stdout_lines[1]|from_json).envbslaunchconf_18857_actual) != "0x1" and ((database.stdout_lines[1]|from_json).envbslaunchconf_18857_actual) != "DELETE"
    tags:
      - envbslaunchconf
      - 18.8.5.7
      - eighteen
      - all
      - rollback

  - name: adding value to the envbslaunchconf file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\envbslaunchconf_18857.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).envbslaunchconf_18857_actual) == "DELETE"
    tags:
      - envbslaunchconf
      - 18.8.5.7
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\envbslaunchconf_18857.txt'
    when: ((database.stdout_lines[1]|from_json).envbslaunchconf_18857_actual) != "0x1"
    tags:
      - envbslaunchconf
      - 18.8.5.7
      - eighteen
      - all
      - rollback

  - name: copying bootstartdrivpolicy file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/bootstartdrivpolicy_188141.txt
      dest: C:\facts\policyfiles\bootstartdrivpolicy_188141.txt
    when: ((database.stdout_lines[1]|from_json).bootstartdrivpolicy_188141_actual) != "0x1"
    tags:
      - bootstartdrivpolicy
      - 18.8.14.1
      - eighteen
      - all
      - rollback

  - name: adding value to the bootstartdrivpolicy file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\bootstartdrivpolicy_188141.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).bootstartdrivpolicy_188141_actual}}'
    when: ((database.stdout_lines[1]|from_json).bootstartdrivpolicy_188141_actual) != "0x1" and ((database.stdout_lines[1]|from_json).bootstartdrivpolicy_188141_actual) != "DELETE"
    tags:
      - bootstartdrivpolicy
      - 18.8.14.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\bootstartdrivpolicy_188141.txt'
    when: ((database.stdout_lines[1]|from_json).bootstartdrivpolicy_188141_actual) != "0x1" and ((database.stdout_lines[1]|from_json).bootstartdrivpolicy_188141_actual) != "DELETE"
    tags:
      - bootstartdrivpolicy
      - 18.8.14.1
      - eighteen
      - all
      - rollback

  - name: adding value to the bootstartdrivpolicy file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\bootstartdrivpolicy_188141.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).bootstartdrivpolicy_188141_actual) == "DELETE"
    tags:
      - bootstartdrivpolicy
      - 18.8.14.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\bootstartdrivpolicy_188141.txt'
    when: ((database.stdout_lines[1]|from_json).bootstartdrivpolicy_188141_actual) == "DELETE"
    tags:
      - bootstartdrivpolicy
      - 18.8.14.1
      - eighteen
      - all
      - rollback

  - name: copying bootstartdrivpolicy file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/bootstartdrivpolicy_188141.txt
      dest: C:\facts\policyfiles\bootstartdrivpolicy_188141.txt
    when: ((database.stdout_lines[1]|from_json).bootstartdrivpolicy_188141_actual) != "0x1"
    tags:
      - bootstartdrivpolicy
      - 18.8.14.1
      - eighteen
      - all
      - rollback

  - name: adding value to the bootstartdrivpolicy file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\bootstartdrivpolicy_188141.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).bootstartdrivpolicy_188141_actual}}'
    when: ((database.stdout_lines[1]|from_json).bootstartdrivpolicy_188141_actual) != "0x1" and ((database.stdout_lines[1]|from_json).bootstartdrivpolicy_188141_actual) != "DELETE"
    tags:
      - bootstartdrivpolicy
      - 18.8.14.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\bootstartdrivpolicy_188141.txt'
    when: ((database.stdout_lines[1]|from_json).bootstartdrivpolicy_188141_actual) != "0x1" and ((database.stdout_lines[1]|from_json).bootstartdrivpolicy_188141_actual) != "DELETE"
    tags:
      - bootstartdrivpolicy
      - 18.8.14.1
      - eighteen
      - all
      - rollback
 
  - name: adding value to the bootstartdrivpolicy file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\bootstartdrivpolicy_188141.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).bootstartdrivpolicy_188141_actual) == "DELETE"
    tags:
      - bootstartdrivpolicy
      - 18.8.14.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\bootstartdrivpolicy_188141.txt'
    when: ((database.stdout_lines[1]|from_json).bootstartdrivpolicy_188141_actual) == "DELETE"
    tags:
      - bootstartdrivpolicy
      - 18.8.14.1
      - eighteen
      - all
      - rollback

  - name: copying regpolbackgrdprocess file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/regpolbackgrdprocess_188212.txt
      dest: C:\facts\policyfiles\regpolbackgrdprocess_188212.txt
    when: ((database.stdout_lines[1]|from_json).regpolbackgrdprocess_188212_actual) != "0x1"
    tags:
      - regpolbackgrdprocess
      - 18.8.21.2
      - eighteen
      - all
      - rollback

  - name: adding value to the regpolbackgrdprocess file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\regpolbackgrdprocess_188212.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).regpolbackgrdprocess_188212_actual}}'
    when: ((database.stdout_lines[1]|from_json).regpolbackgrdprocess_188212_actual) != "0x1" and ((database.stdout_lines[1]|from_json).regpolbackgrdprocess_188212_actual) != "DELETE"
    tags:
      - regpolbackgrdprocess
      - 18.8.21.2
      - eighteen
      - all
      - rollback

  - name: adding value to the regpolbackgrdprocess file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\regpolbackgrdprocess_188212.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).regpolbackgrdprocess_188212_actual) == "DELETE"
    tags:
      - regpolbackgrdprocess
      - 18.8.21.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\regpolbackgrdprocess_188212.txt'
    when: ((database.stdout_lines[1]|from_json).regpolbackgrdprocess_188212_actual) != "0x1"
    tags:
      - regpolbackgrdprocess
      - 18.8.21.2
      - eighteen
      - all
      - rollback

  - name: copying regpolgrppolicychg file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/regpolgrppolicychg_188213.txt
      dest: C:\facts\policyfiles\regpolgrppolicychg_188213.txt
    when: ((database.stdout_lines[1]|from_json).regpolgrppolicychg_188213_actual) != "0x1"
    tags:
      - regpolgrppolicychg
      - 18.8.21.3
      - eighteen
      - all
      - rollback

  - name: adding value to the regpolgrppolicychg file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\regpolgrppolicychg_188213.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).regpolgrppolicychg_188213_actual}}'
    when: ((database.stdout_lines[1]|from_json).regpolgrppolicychg_188213_actual) != "0x1" and ((database.stdout_lines[1]|from_json).regpolgrppolicychg_188213_actual) != "DELETE"
    tags:
      - regpolgrppolicychg
      - 18.8.21.3
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\regpolgrppolicychg_188213.txt'
    when: ((database.stdout_lines[1]|from_json).regpolgrppolicychg_188213_actual) != "0x1" and ((database.stdout_lines[1]|from_json).regpolgrppolicychg_188213_actual) != "DELETE"
    tags:
      - regpolgrppolicychg
      - 18.8.21.3
      - eighteen
      - all
      - rollback
 
  - name: adding value to the regpolgrppolicychg file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\regpolgrppolicychg_188213.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).regpolgrppolicychg_188213_actual) == "DELETE"
    tags:
      - regpolgrppolicychg
      - 18.8.21.3
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\regpolgrppolicychg_188213.txt'
    when: ((database.stdout_lines[1]|from_json).regpolgrppolicychg_188213_actual) == "DELETE"
    tags:
      - regpolgrppolicychg
      - 18.8.21.3
      - eighteen
      - all
      - rollback

  - name: copying experdevice file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/experdevice_188214.txt
      dest: C:\facts\policyfiles\experdevice_188214.txt
    when: ((database.stdout_lines[1]|from_json).experdevice_188214_actual) != "0x1"
    tags:
      - experdevice
      - 18.8.21.4
      - eighteen
      - all
      - rollback

  - name: adding value to the experdevice file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\experdevice_188214.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).experdevice_188214_actual}}'
    when: ((database.stdout_lines[1]|from_json).experdevice_188214_actual) != "0x1" and ((database.stdout_lines[1]|from_json).experdevice_188214_actual) != "DELETE"
    tags:
      - experdevice
      - 18.8.21.4
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\experdevice_188214.txt'
    when: ((database.stdout_lines[1]|from_json).experdevice_188214_actual) != "0x1" and ((database.stdout_lines[1]|from_json).experdevice_188214_actual) != "DELETE"
    tags:
      - experdevice
      - 18.8.21.4
      - eighteen
      - all
      - rollback
 
  - name: adding value to the experdevice file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\experdevice_188214.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).experdevice_188214_actual) == "DELETE"
    tags:
      - experdevice
      - 18.8.21.4
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\experdevice_188214.txt'
    when: ((database.stdout_lines[1]|from_json).experdevice_188214_actual) == "DELETE"
    tags:
      - experdevice
      - 18.8.21.4
      - eighteen
      - all
      - rollback

  - name: copying backgrprefresh file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/backgrprefresh_188215.txt
      dest: C:\facts\policyfiles\backgrprefresh_188215.txt
    when: ((database.stdout_lines[1]|from_json).backgrprefresh_188215_actual) != "0x0"
    tags:
      - backgrprefresh
      - 18.8.21.5
      - eighteen
      - all
      - rollback

  - name: adding value to the backgrprefresh file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\backgrprefresh_188215.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).backgrprefresh_188215_actual}}'
    when: ((database.stdout_lines[1]|from_json).backgrprefresh_188215_actual) != "0x0" and ((database.stdout_lines[1]|from_json).backgrprefresh_188215_actual) != "DELETE"
    tags:
      - backgrprefresh
      - 18.8.21.5
      - eighteen
      - all
      - rollback

  - name: adding value to the backgrprefresh file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\backgrprefresh_188215.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).backgrprefresh_188215_actual) == "DELETE"
    tags:
      - backgrprefresh
      - 18.8.21.5
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\backgrprefresh_188215.txt'
    when: ((database.stdout_lines[1]|from_json).backgrprefresh_188215_actual) != "0x0"
    tags:
      - backgrprefresh
      - 18.8.21.5
      - eighteen
      - all
      - rollback

  - name: copying turnoffprintdriver file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnoffprintdriver_1882211.txt
      dest: C:\facts\policyfiles\turnoffprintdriver_1882211.txt
    when: ((database.stdout_lines[1]|from_json).turnoffprintdriver_1882211_actual) != "0x1"
    tags:
      - turnoffprintdriver
      - 18.8.22.1.1
      - eighteen
      - all
      - rollback

  - name: adding value to the turnoffprintdriver file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffprintdriver_1882211.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnoffprintdriver_1882211_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnoffprintdriver_1882211_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnoffprintdriver_1882211_actual) != "DELETE"
    tags:
      - turnoffprintdriver
      - 18.8.22.1.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffprintdriver_1882211.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffprintdriver_1882211_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnoffprintdriver_1882211_actual) != "DELETE"
    tags:
      - turnoffprintdriver
      - 18.8.22.1.1
      - eighteen
      - all
      - rollback
 
  - name: adding value to the turnoffprintdriver file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffprintdriver_1882211.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnoffprintdriver_1882211_actual) == "DELETE"
    tags:
      - turnoffprintdriver
      - 18.8.22.1.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffprintdriver_1882211.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffprintdriver_1882211_actual) == "DELETE"
    tags:
      - turnoffprintdriver
      - 18.8.22.1.1
      - eighteen
      - all
      - rollback

  - name: copying turnoffdatasharing file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnoffdatasharing_1882212.txt
      dest: C:\facts\policyfiles\turnoffdatasharing_1882212.txt
    when: ((database.stdout_lines[1]|from_json).turnoffdatasharing_1882212_actual) != "0x1"
    tags:
      - turnoffdatasharing
      - 18.8.22.1.2
      - eighteen
      - all
      - rollback

  - name: adding value to the turnoffdatasharing file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffdatasharing_1882212.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnoffdatasharing_1882212_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnoffdatasharing_1882212_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnoffdatasharing_1882212_actual) != "DELETE"
    tags:
      - turnoffdatasharing
      - 18.8.22.1.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffdatasharing_1882212.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffdatasharing_1882212_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnoffdatasharing_1882212_actual) != "DELETE"
    tags:
      - turnoffdatasharing
      - 18.8.22.1.2
      - eighteen
      - all
      - rollback
 
  - name: adding value to the turnoffdatasharingfile for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffdatasharing_1882212.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnoffdatasharing_1882212_actual) == "DELETE"
    tags:
      - turnoffdatasharing
      - 18.8.22.1.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffdatasharing_1882212.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffdatasharing_1882212_actual) == "DELETE"
    tags:
      - turnoffdatasharing
      - 18.8.22.1.2
      - eighteen
      - all
      - rollback

  - name: copying turnofferrorreport file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnofferrorreport_1882213.txt
      dest: C:\facts\policyfiles\turnofferrorreport_1882213.txt
    when: ((database.stdout_lines[1]|from_json).turnofferrorreport_1882213_actual) != "0x1"
    tags:
      - turnofferrorreport
      - 18.8.22.1.3
      - eighteen
      - all
      - rollback

  - name: adding value to the turnofferrorreport file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnofferrorreport_1882213.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnofferrorreport_1882213_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnofferrorreport_1882213_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnofferrorreport_1882213_actual) != "DELETE"
    tags:
      - turnofferrorreport
      - 18.8.22.1.3
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnofferrorreport_1882213.txt'
    when: ((database.stdout_lines[1]|from_json).turnofferrorreport_1882213_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnofferrorreport_1882213_actual) != "DELETE"
    tags:
      - turnofferrorreport
      - 18.8.22.1.3
      - eighteen
      - all
      - rollback
 
  - name: adding value to the turnofferrorreport file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnofferrorreport_1882213.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnofferrorreport_1882213_actual) == "DELETE"
    tags:
      - turnofferrorreport
      - 18.8.22.1.3
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnofferrorreport_1882213.txt'
    when: ((database.stdout_lines[1]|from_json).turnofferrorreport_1882213_actual) == "DELETE"
    tags:
      - turnofferrorreport
      - 18.8.22.1.3
      - eighteen
      - all
      - rollback

  - name: copying turnoffinetconnwiz file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnoffinetconnwiz_1882214.txt
      dest: C:\facts\policyfiles\turnoffinetconnwiz_1882214.txt
    when: ((database.stdout_lines[1]|from_json).turnoffinetconnwiz_1882214_actual) != "0x1"
    tags:
      - turnoffinetconnwiz
      - 18.8.22.1.4
      - eighteen
      - all
      - rollback

  - name: adding value to the turnoffinetconnwiz file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffinetconnwiz_1882214.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnoffinetconnwiz_1882214_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnoffinetconnwiz_1882214_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnoffinetconnwiz_1882214_actual) != "DELETE"
    tags:
      - turnoffinetconnwiz
      - 18.8.22.1.4
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffinetconnwiz_1882214.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffinetconnwiz_1882214_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnoffinetconnwiz_1882214_actual) != "DELETE"
    tags:
      - turnoffinetconnwiz
      - 18.8.22.1.4
      - eighteen
      - all
      - rollback
 
  - name: adding value to the turnoffinetconnwiz file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffinetconnwiz_1882214.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnoffinetconnwiz_1882214_actual) == "DELETE"
    tags:
      - turnoffinetconnwiz
      - 18.8.22.1.4
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffinetconnwiz_1882214.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffinetconnwiz_1882214_actual) == "DELETE"
    tags:
      - turnoffinetconnwiz
      - 18.8.22.1.4
      - eighteen
      - all
      - rollback

  - name: copying turnoffinetdownload file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnoffinetdownload_1882215.txt
      dest: C:\facts\policyfiles\turnoffinetdownload_1882215.txt
    when: ((database.stdout_lines[1]|from_json).turnoffinetdownload_1882215_actual) != "0x1"
    tags:
      - turnoffinetdownload
      - 18.8.22.1.5
      - eighteen
      - all
      - rollback

  - name: adding value to the turnoffinetdownload file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffinetdownload_1882215.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnoffinetdownload_1882215_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnoffinetdownload_1882215_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnoffinetdownload_1882215_actual) != "DELETE"
    tags:
      - turnoffinetdownload
      - 18.8.22.1.5
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffinetdownload_1882215.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffinetdownload_1882215_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnoffinetdownload_1882215_actual) != "DELETE"
    tags:
      - turnoffinetdownload
      - 18.8.22.1.5
      - eighteen
      - all
      - rollback
 
  - name: adding value to the turnoffinetdownload file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffinetdownload_1882215.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnoffinetdownload_1882215_actual) == "DELETE"
    tags:
      - turnoffinetdownload
      - 18.8.22.1.5
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffinetdownload_1882215.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffinetdownload_1882215_actual) == "DELETE"
    tags:
      - turnoffinetdownload
      - 18.8.22.1.5
      - eighteen
      - all
      - rollback

  - name: copying turnoffprinting file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnoffprinting_1882216.txt
      dest: C:\facts\policyfiles\turnoffprinting_1882216.txt
    when: ((database.stdout_lines[1]|from_json).turnoffprinting_1882216_actual) != "0x1"
    tags:
      - turnoffprinting
      - 18.8.22.1.6
      - eighteen
      - all
      - rollback

  - name: adding value to the turnoffprinting file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffprinting_1882216.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnoffprinting_1882216_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnoffprinting_1882216_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnoffprinting_1882216_actual) != "DELETE"
    tags:
      - turnoffprinting
      - 18.8.22.1.6
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffprinting_1882216.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffprinting_1882216_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnoffprinting_1882216_actual) != "DELETE"
    tags:
      - turnoffprinting
      - 18.8.22.1.6
      - eighteen
      - all
      - rollback
 
  - name: adding value to the turnoffprinting file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffprinting_1882216.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnoffprinting_1882216_actual) == "DELETE"
    tags:
      - turnoffprinting
      - 18.8.22.1.6
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffprinting_1882216.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffprinting_1882216_actual) == "DELETE"
    tags:
      - turnoffprinting
      - 18.8.22.1.6
      - eighteen
      - all
      - rollback

  - name: copying turnoffregistry file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnoffregistry_1882217.txt
      dest: C:\facts\policyfiles\turnoffregistry_1882217.txt
    when: ((database.stdout_lines[1]|from_json).turnoffregistry_1882217_actual) != "0x1"
    tags:
      - turnoffregistry
      - 18.8.22.1.7
      - eighteen
      - all
      - rollback

  - name: adding value to the turnoffregistry file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffregistry_1882217.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnoffregistry_1882217_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnoffregistry_1882217_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnoffregistry_1882217_actual) != "DELETE"
    tags:
      - turnoffregistry
      - 18.8.22.1.7
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffregistry_1882217.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffregistry_1882217_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnoffregistry_1882217_actual) != "DELETE"
    tags:
      - turnoffregistry
      - 18.8.22.1.7
      - eighteen
      - all
      - rollback
 
  - name: adding value to the turnoffregistry file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffregistry_1882217.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnoffregistry_1882217_actual) == "DELETE"
    tags:
      - turnoffregistry
      - 18.8.22.1.7
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffregistry_1882217.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffregistry_1882217_actual) == "DELETE"
    tags:
      - turnoffregistry
      - 18.8.22.1.7
      - eighteen
      - all
      - rollback

  - name: copying turnoffsearchcomp file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnoffsearchcomp_1882218.txt
      dest: C:\facts\policyfiles\turnoffsearchcomp_1882218.txt
    when: ((database.stdout_lines[1]|from_json).turnoffsearchcomp_1882218_actual) != "0x1 0x0"
    tags:
      - turnoffsearchcomp
      - 18.8.22.1.8
      - eighteen
      - all
      - rollback

  - name: adding value to the turnoffsearchcomp file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffsearchcomp_1882218.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnoffsearchcomp_1882218_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnoffsearchcomp_1882218_actual) != "0x1 0x0" and ((database.stdout_lines[1]|from_json).turnoffsearchcomp_1882218_actual) != "DELETE"
    tags:
      - turnoffsearchcomp
      - 18.8.22.1.8
      - eighteen
      - all
      - rollback

  - name: adding value to the turnoffsearchcomp file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffsearchcomp_1882218.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnoffsearchcomp_1882218_actual) == "DELETE"
    tags:
      - turnoffsearchcomp
      - 18.8.22.1.8
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffsearchcomp_1882218.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffsearchcomp_1882218_actual) != "0x1 0x0"
    tags:
      - turnoffsearchcomp
      - 18.8.22.1.8
      - eighteen
      - all
      - rollback

  - name: copying turnofforderprints file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnofforderprints_1882219.txt
      dest: C:\facts\policyfiles\turnofforderprints_1882219.txt
    when: ((database.stdout_lines[1]|from_json).turnofforderprints_1882219_actual) != "0x1"
    tags:
      - turnofforderprints
      - 18.8.22.1.9
      - eighteen
      - all
      - rollback

  - name: adding value to the turnofforderprints file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnofforderprints_1882219.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnofforderprints_1882219_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnofforderprints_1882219_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnofforderprints_1882219_actual) != "DELETE"
    tags:
      - turnofforderprints
      - 18.8.22.1.9
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnofforderprints_1882219.txt'
    when: ((database.stdout_lines[1]|from_json).turnofforderprints_1882219_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnofforderprints_1882219_actual) != "DELETE"
    tags:
      - turnofforderprints
      - 18.8.22.1.9
      - eighteen
      - all
      - rollback
 
  - name: adding value to the turnofforderprints file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnofforderprints_1882219.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnofforderprints_1882219_actual) == "DELETE"
    tags:
      - turnofforderprints
      - 18.8.22.1.9
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnofforderprints_1882219.txt'
    when: ((database.stdout_lines[1]|from_json).turnofforderprints_1882219_actual) == "DELETE"
    tags:
      - turnofforderprints
      - 18.8.22.1.9
      - eighteen
      - all
      - rollback

  - name: copying turnoffpublishweb file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnoffpublishweb_18822110.txt
      dest: C:\facts\policyfiles\turnoffpublishweb_18822110.txt
    when: ((database.stdout_lines[1]|from_json).turnoffpublishweb_18822110_actual) != "0x1"
    tags:
      - turnoffpublishweb
      - 18.8.22.1.10
      - eighteen
      - all
      - rollback

  - name: adding value to the turnoffpublishweb file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffpublishweb_18822110.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnoffpublishweb_18822110_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnoffpublishweb_18822110_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnoffpublishweb_18822110_actual) != "DELETE"
    tags:
      - turnoffpublishweb
      - 18.8.22.1.10
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffpublishweb_18822110.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffpublishweb_18822110_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnoffpublishweb_18822110_actual) != "DELETE"
    tags:
      - turnoffpublishweb
      - 18.8.22.1.10
      - eighteen
      - all
      - rollback
 
  - name: adding value to the turnoffsearchcomp file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffpublishweb_18822110.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnoffpublishweb_18822110_actual) == "DELETE"
    tags:
      - turnoffpublishweb
      - 18.8.22.1.10
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffpublishweb_18822110.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffpublishweb_18822110_actual) == "DELETE"
    tags:
      - turnoffpublishweb
      - 18.8.22.1.10
      - eighteen
      - all
      - rollback

  - name: copying turnoffwmceip file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnoffwmceip_18822111.txt
      dest: C:\facts\policyfiles\turnoffwmceip_18822111.txt
    when: ((database.stdout_lines[1]|from_json).turnoffwmceip_18822111_actual) != "0x2"
    tags:
      - turnoffwmceip
      - 18.8.22.1.11
      - eighteen
      - all
      - rollback

  - name: adding value to the turnoffwmceip file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffwmceip_18822111.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnoffwmceip_18822111_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnoffwmceip_18822111_actual) != "0x2" and ((database.stdout_lines[1]|from_json).turnoffwmceip_18822111_actual) != "DELETE"
    tags:
      - turnoffwmceip
      - 18.8.22.1.11
      - eighteen
      - all
      - rollback

  - name: adding value to the turnoffwmceip file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffwmceip_18822111.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnoffwmceip_18822111_actual) == "DELETE"
    tags:
      - turnoffwmceip
      - 18.8.22.1.11
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffwmceip_18822111.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffwmceip_18822111_actual) != "0x2"
    tags:
      - turnoffwmceip
      - 18.8.22.1.11
      - eighteen
      - all
      - rollback

  - name: copying turnoffwceip file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnoffwceip_18822112.txt
      dest: C:\facts\policyfiles\turnoffwceip_18822112.txt
    when: ((database.stdout_lines[1]|from_json).turnoffwceip_18822112_actual) != "0x0"
    tags:
      - turnoffwceip
      - 18.8.22.1.12
      - eighteen
      - all
      - rollback

  - name: adding value to the turnoffwceip  file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffwceip_18822112.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnoffwceip_18822112_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnoffwceip_18822112_actual) != "0x0" and ((database.stdout_lines[1]|from_json).turnoffwceip_18822112_actual) != "DELETE"
    tags:
      - turnoffwceip
      - 18.8.22.1.12
      - eighteen
      - all
      - rollback

  - name: adding value to the turnoffwceip file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffwceip_18822112.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnoffwceip_18822112_actual) == "DELETE"
    tags:
      - turnoffwceip
      - 18.8.22.1.12
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffwceip_18822112.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffwceip_18822112_actual) != "0x0"
    tags:
      - turnoffwceip
      - 18.8.22.1.12
      - eighteen
      - all
      - rollback

  - name: copying turnoffwinerrorep file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnoffwinerrorep_18822113.txt
      dest: C:\facts\policyfiles\turnoffwinerrorep_18822113.txt
    when: ((database.stdout_lines[1]|from_json).turnoffwinerrorep_18822113_actual) != "0x1 0x0"
    tags:
      - turnoffwinerrorep
      - 18.8.22.1.13
      - eighteen
      - all
      - rollback

  - name: adding value to the turnoffwinerrorep file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffwinerrorep_18822113.txt
       regex: '{{ item.regex }}'
       line: '{{ item.line }}'
    with_items:
      - { regex: "^(Disabled )", line: "Disabled\nDWORD:{{ (database.stdout_lines[1]|from_json).turnoffwinerrorep_18822113_actual.split(' ')[0] }}" }
      - { regex: "^(DoReport )", line: "DoReport\nDWORD:{{ (database.stdout_lines[1]|from_json).turnoffwinerrorep_18822113_actual.split(' ')[1] }}" }
    when: ((database.stdout_lines[1]|from_json).turnoffwinerrorep_18822113_actual) != "0x1 0x0" and ((database.stdout_lines[1]|from_json).turnoffwinerrorep_18822113_actual) != "DELETE"
    tags:
      - turnoffwinerrorep
      - 18.8.22.1.13
      - eighteen
      - all
      - rollback

  - name: adding value to the turnoffwinerrorep file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffwinerrorep_18822113.txt
       regex: '{{ item.regex }}'
       line: '{{ item.line }}'
    with_items:
      - { regex: "^(Disabled )", line: "Disabled\nDELETE" }
      - { regex: "^(DoReport )", line: "DoReport\nDELETE" }
    when: ((database.stdout_lines[1]|from_json).turnoffwinerrorep_18822113_actual) == "DELETE"
    tags:
      - turnoffwinerrorep
      - 18.8.22.1.13
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffwinerrorep_18822113.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffwinerrorep_18822113_actual) != "0x1 0x0"
    tags:
      - turnoffwinerrorep
      - 18.8.22.1.13
      - eighteen
      - all
      - rollback
 
  - name: copying supportdevauthen file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/supportdevauthen_188251.txt
      dest: C:\facts\policyfiles\supportdevauthen_188251.txt
    when: ((database.stdout_lines[1]|from_json).supportdevauthen_188251_actual) != "0x1"
    tags:
      - supportdevauthen
      - 18.8.25.1
      - eighteen
      - all
      - rollback

  - name: adding value to the supportdevauthen file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\supportdevauthen_188251.txt
       regex: '{{ item.regex }}'
       line: '{{ item.line }}'
    with_items:
      - { regex: "^(DevicePKInitBehavior )", line: "DevicePKInitBehavior\nDWORD:{{ (database.stdout_lines[1]|from_json).supportdevauthen_188251_actual.split(' ')[0] }}" }
      - { regex: "^(DevicePKInitEnabled )", line: "DevicePKInitEnabled\nDWORD:{{ (database.stdout_lines[1]|from_json).supportdevauthen_188251_actual.split(' ')[1] }}" }
    when: ((database.stdout_lines[1]|from_json).supportdevauthen_188251_actual) != "0x1" and ((database.stdout_lines[1]|from_json).supportdevauthen_188251_actual) != "DELETE"
    tags:
      - supportdevauthen
      - 18.8.25.1
      - eighteen
      - all
      - rollback

  - name: adding value to the supportdevauthen file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\supportdevauthen_188251.txt
       regex: '{{ item.regex }}'
       line: '{{ item.line }}'
    with_items:
      - { regex: "^(DevicePKInitBehavior )", line: "DevicePKInitBehavior\nDELETE" }
      - { regex: "^(DevicePKInitEnabled )", line: "DevicePKInitEnabled\nDELETE" }
    when: ((database.stdout_lines[1]|from_json).supportdevauthen_188251_actual) == "DELETE"
    tags:
      - supportdevauthen
      - 18.8.25.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\supportdevauthen_188251.txt'
    when: ((database.stdout_lines[1]|from_json).supportdevauthen_188251_actual) != "0x1"
    tags:
      - supportdevauthen
      - 18.8.25.1
      - eighteen
      - all
      - rollback
 
  - name: copying enpolicyextdevice file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/enpolicyextdevice_188261.txt
      dest: C:\facts\policyfiles\enpolicyextdevice_188261.txt
    when: ((database.stdout_lines[1]|from_json).enpolicyextdevice_188261_actual) != "0x1"
    tags:
      - enpolicyextdevice
      - 18.8.26.1
      - eighteen
      - all
      - rollback

  - name: adding value to the enpolicyextdevice file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\enpolicyextdevice_188261.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).enpolicyextdevice_188261_actual}}'
    when: ((database.stdout_lines[1]|from_json).enpolicyextdevice_188261_actual) != "0x1" and ((database.stdout_lines[1]|from_json).enpolicyextdevice_188261_actual) != "DELETE"
    tags:
      - enpolicyextdevice
      - 18.8.26.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\enpolicyextdevice_188261.txt'
    when: ((database.stdout_lines[1]|from_json).enpolicyextdevice_188261_actual) != "0x1" and ((database.stdout_lines[1]|from_json).enpolicyextdevice_188261_actual) != "DELETE"
    tags:
      - enpolicyextdevice
      - 18.8.26.1
      - eighteen
      - all
      - rollback
 
  - name: adding value to the enpolicyextdevice file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\enpolicyextdevice_188261.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).enpolicyextdevice_188261_actual) == "DELETE"
    tags:
      - enpolicyextdevice
      - 18.8.26.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\enpolicyextdevice_188261.txt'
    when: ((database.stdout_lines[1]|from_json).enpolicyextdevice_188261_actual) == "DELETE"
    tags:
      - enpolicyextdevice
      - 18.8.26.1
      - eighteen
      - all
      - rollback

  - name: copying disallowcopyusrinput file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/disallowcopyusrinput_188271.txt
      dest: C:\facts\policyfiles\disallowcopyusrinput_188271.txt
    when: ((database.stdout_lines[1]|from_json).disallowcopyusrinput_188271_actual) != "0x1"
    tags:
      - disallowcopyusrinput
      - 18.8.27.1
      - eighteen
      - all
      - rollback

  - name: adding value to the disallowcopyusrinput file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\disallowcopyusrinput_188271.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).disallowcopyusrinput_188271_actual}}'
    when: ((database.stdout_lines[1]|from_json).disallowcopyusrinput_188271_actual) != "0x1" and ((database.stdout_lines[1]|from_json).disallowcopyusrinput_188271_actual) != "DELETE"
    tags:
      - disallowcopyusrinput
      - 18.8.27.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\disallowcopyusrinput_188271.txt'
    when: ((database.stdout_lines[1]|from_json).disallowcopyusrinput_188271_actual) != "0x1" and ((database.stdout_lines[1]|from_json).disallowcopyusrinput_188271_actual) != "DELETE"
    tags:
      - disallowcopyusrinput
      - 18.8.27.1
      - eighteen
      - all
      - rollback
 
  - name: adding value to the disallowcopyusrinput file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\disallowcopyusrinput_188271.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).disallowcopyusrinput_188271_actual) == "DELETE"
    tags:
      - disallowcopyusrinput
      - 18.8.27.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\disallowcopyusrinput_188271.txt'
    when: ((database.stdout_lines[1]|from_json).disallowcopyusrinput_188271_actual) == "DELETE"
    tags:
      - disallowcopyusrinput
      - 18.8.27.1
      - eighteen
      - all
      - rollback

  - name: copying blockusracc file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/blockusracc_188281.txt
      dest: C:\facts\policyfiles\blockusracc_188281.txt
    when: ((database.stdout_lines[1]|from_json).blockusracc_188281_actual) != "0x1"
    tags:
      - blockusracc
      - 18.8.28.1
      - eighteen
      - all
      - rollback

  - name: adding value to the blockusracc file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\blockusracc_188281.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).blockusracc_188281_actual}}'
    when: ((database.stdout_lines[1]|from_json).blockusracc_188281_actual) != "0x1" and ((database.stdout_lines[1]|from_json).blockusracc_188281_actual) != "DELETE"
    tags:
      - blockusracc
      - 18.8.28.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\blockusracc_188281.txt'
    when: ((database.stdout_lines[1]|from_json).blockusracc_188281_actual) != "0x1" and ((database.stdout_lines[1]|from_json).blockusracc_188281_actual) != "DELETE"
    tags:
      - blockusracc
      - 18.8.28.1
      - eighteen
      - all
      - rollback
 
  - name: adding value to the blockusracc file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\blockusracc_188281.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).blockusracc_188281_actual) == "DELETE"
    tags:
      - blockusracc
      - 18.8.28.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\blockusracc_188281.txt'
    when: ((database.stdout_lines[1]|from_json).blockusracc_188281_actual) == "DELETE"
    tags:
      - blockusracc
      - 18.8.28.1
      - eighteen
      - all
      - rollback

  - name: copying dontdisplaynetui file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/dontdisplaynetui_188282.txt
      dest: C:\facts\policyfiles\dontdisplaynetui_188282.txt
    when: ((database.stdout_lines[1]|from_json).dontdisplaynetui_188282_actual) != "0x1"
    tags:
      - dontdisplaynetui
      - 18.8.28.2
      - eighteen
      - all
      - rollback

  - name: adding value to the dontdisplaynetui file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\dontdisplaynetui_188282.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).dontdisplaynetui_188282_actual}}'
    when: ((database.stdout_lines[1]|from_json).dontdisplaynetui_188282_actual) != "0x1" and ((database.stdout_lines[1]|from_json).dontdisplaynetui_188282_actual) != "DELETE"
    tags:
      - dontdisplaynetui
      - 18.8.28.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\dontdisplaynetui_188282.txt'
    when: ((database.stdout_lines[1]|from_json).dontdisplaynetui_188282_actual) != "0x1" and ((database.stdout_lines[1]|from_json).dontdisplaynetui_188282_actual) != "DELETE"
    tags:
      - dontdisplaynetui
      - 18.8.28.2
      - eighteen
      - all
      - rollback
 
  - name: adding value to the dontdisplaynetui file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\dontdisplaynetui_188282.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).dontdisplaynetui_188282_actual) == "DELETE"
    tags:
      - dontdisplaynetui
      - 18.8.28.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\dontdisplaynetui_188282.txt'
    when: ((database.stdout_lines[1]|from_json).dontdisplaynetui_188282_actual) == "DELETE"
    tags:
      - dontdisplaynetui
      - 18.8.28.2
      - eighteen
      - all
      - rollback

  - name: copying dontenumconnusr file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/dontenumconnusr_188283.txt
      dest: C:\facts\policyfiles\dontenumconnusr_188283.txt
    when: ((database.stdout_lines[1]|from_json).dontenumconnusr_188283_actual) != "0x1"
    tags:
      - dontenumconnusr
      - 18.8.28.3
      - eighteen
      - all
      - rollback

  - name: adding value to the dontenumconnusr file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\dontenumconnusr_188283.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).dontenumconnusr_188283_actual}}'
    when: ((database.stdout_lines[1]|from_json).dontenumconnusr_188283_actual) != "0x1" and ((database.stdout_lines[1]|from_json).dontenumconnusr_188283_actual) != "DELETE"
    tags:
      - dontenumconnusr
      - 18.8.28.3
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\dontenumconnusr_188283.txt'
    when: ((database.stdout_lines[1]|from_json).dontenumconnusr_188283_actual) != "0x1" and ((database.stdout_lines[1]|from_json).dontenumconnusr_188283_actual) != "DELETE"
    tags:
      - dontenumconnusr
      - 18.8.28.3
      - eighteen
      - all
      - rollback
 
  - name: adding value to the dontenumconnusr file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\dontenumconnusr_188283.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).dontenumconnusr_188283_actual) == "DELETE"
    tags:
      - dontenumconnusr
      - 18.8.28.3
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\dontenumconnusr_188283.txt'
    when: ((database.stdout_lines[1]|from_json).dontenumconnusr_188283_actual) == "DELETE"
    tags:
      - dontenumconnusr
      - 18.8.28.3
      - eighteen
      - all
      - rollback

  - name: copying enumlocalusr file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/enumlocalusr_188284.txt
      dest: C:\facts\policyfiles\enumlocalusr_188284.txt
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).enumlocalusr_188284_actual) != "0x1"
    tags:
      - enumlocalusr
      - 18.8.28.4
      - eighteen
      - all
      - rollback

  - name: adding value to the enumlocalusr file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\enumlocalusr_188284.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).enumlocalusr_188284_actual}}'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).enumlocalusr_188284_actual) != "0x1" and ((database.stdout_lines[1]|from_json).enumlocalusr_188284_actual) != "DELETE"
    tags:
      - enumlocalusr
      - 18.8.28.4
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\enumlocalusr_188284.txt'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).enumlocalusr_188284_actual) != "0x1" and ((database.stdout_lines[1]|from_json).enumlocalusr_188284_actual) != "DELETE"
    tags:
      - enumlocalusr
      - 18.8.28.4
      - eighteen
      - all
      - rollback
 
  - name: adding value to the enumlocalusr file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\enumlocalusr_188284.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).enumlocalusr_188284_actual) == "DELETE"
    tags:
      - enumlocalusr
      - 18.8.28.4
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\enumlocalusr_188284.txt'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).enumlocalusr_188284_actual) != "0x1" and ((database.stdout_lines[1]|from_json).enumlocalusr_188284_actual) == "DELETE"
    tags:
      - enumlocalusr
      - 18.8.28.4
      - eighteen
      - all
      - rollback

  - name: copying turnoffappnotfic file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnoffappnotfic_188285.txt
      dest: C:\facts\policyfiles\turnoffappnotfic_188285.txt
    when: ((database.stdout_lines[1]|from_json).turnoffappnotfic_188285_actual) != "0x1"
    tags:
      - turnoffappnotfic
      - 18.8.28.5
      - eighteen
      - all
      - rollback

  - name: adding value to the turnoffappnotfic file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffappnotfic_188285.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnoffappnotfic_188285_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnoffappnotfic_188285_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnoffappnotfic_188285_actual) != "DELETE"
    tags:
      - turnoffappnotfic
      - 18.8.28.5
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffappnotfic_188285.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffappnotfic_188285_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnoffappnotfic_188285_actual) != "DELETE"
    tags:
      - turnoffappnotfic
      - 18.8.28.5
      - eighteen
      - all
      - rollback
 
  - name: adding value to the turnoffappnotfic file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffappnotfic_188285.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnoffappnotfic_188285_actual) == "DELETE"
    tags:
      - turnoffappnotfic
      - 18.8.28.5
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffappnotfic_188285.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffappnotfic_188285_actual) == "DELETE"
    tags:
      - turnoffappnotfic
      - 18.8.28.5
      - eighteen
      - all
      - rollback

  - name: copying turnoffpicpwdsignin file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnoffpicpwdsignin_188286.txt
      dest: C:\facts\policyfiles\turnoffpicpwdsignin_188286.txt
    when: ((database.stdout_lines[1]|from_json).turnoffpicpwdsignin_188286_actual) != "0x1"
    tags:
      - turnoffpicpwdsignin
      - 18.8.28.6
      - eighteen
      - all
      - rollback

  - name: adding value to the turnoffpicpwdsignin file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffpicpwdsignin_188286.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnoffpicpwdsignin_188286_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnoffpicpwdsignin_188286_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnoffpicpwdsignin_188286_actual) != "DELETE"
    tags:
      - turnoffpicpwdsignin
      - 18.8.28.6
      - eighteen
      - all
      - rollback

  - name: adding value to the turnoffpicpwdsignin file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffpicpwdsignin_188286.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnoffpicpwdsignin_188286_actual) == "DELETE"
    tags:
      - turnoffpicpwdsignin
      - 18.8.28.6
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffpicpwdsignin_188286.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffpicpwdsignin_188286_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnoffpicpwdsignin_188286_actual) == "DELETE"
    tags:
      - turnoffpicpwdsignin
      - 18.8.28.6
      - eighteen
      - all
      - rollback

  - name: copying turnoffpinsignin file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnoffpinsignin_188287.txt
      dest: C:\facts\policyfiles\turnoffpinsignin_188287.txt
    when: ((database.stdout_lines[1]|from_json).turnoffpinsignin_188287_actual) != "0x1"
    tags:
      - turnoffpinsignin
      - 18.8.28.7
      - eighteen
      - all
      - rollback

  - name: adding value to the turnoffpinsignin file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffpinsignin_188287.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnoffpinsignin_188287_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnoffpinsignin_188287_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnoffpinsignin_188287_actual) != "DELETE"
    tags:
      - turnoffpinsignin
      - 18.8.28.7
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffpinsignin_188287.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffpinsignin_188287_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnoffpinsignin_188287_actual) != "DELETE"
    tags:
      - turnoffpinsignin
      - 18.8.28.7
      - eighteen
      - all
      - rollback
 
  - name: adding value to the turnoffpinsignin file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffpinsignin_188287.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnoffpinsignin_188287_actual) == "DELETE"
    tags:
      - turnoffpinsignin
      - 18.8.28.7
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffpinsignin_188287.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffpinsignin_188287_actual) == "DELETE"
    tags:
      - turnoffpinsignin
      - 18.8.28.7
      - eighteen
      - all
      - rollback

  - name: copying disableclipsync file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/disableclipsync_188311.txt
      dest: C:\facts\policyfiles\disableclipsync_188311.txt
    when: ((database.stdout_lines[1]|from_json).disableclipsync_188311_actual) != "0x1"
    tags:
      - disableclipsync
      - 18.8.31.1
      - eighteen
      - all
      - rollback

  - name: adding value to the disableclipsync file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\disableclipsync_188311.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).disableclipsync_188311_actual}}'
    when: ((database.stdout_lines[1]|from_json).disableclipsync_188311_actual) != "0x1" and ((database.stdout_lines[1]|from_json).disableclipsync_188311_actual) != "DELETE"
    tags:
      - disableclipsync
      - 18.8.31.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\disableclipsync_188311.txt'
    when: ((database.stdout_lines[1]|from_json).disableclipsync_188311_actual) != "0x1" and ((database.stdout_lines[1]|from_json).disableclipsync_188311_actual) != "DELETE"
    tags:
      - disableclipsync
      - 18.8.31.1
      - eighteen
      - all
      - rollback
 
  - name: adding value to the disableclipsync file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\disableclipsync_188311.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).disableclipsync_188311_actual) == "DELETE"
    tags:
      - disableclipsync
      - 18.8.31.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\disableclipsync_188311.txt'
    when: ((database.stdout_lines[1]|from_json).disableclipsync_188311_actual) == "DELETE"
    tags:
      - disableclipsync
      - 18.8.31.1
      - eighteen
      - all
      - rollback

  - name: copying disableuploadusract file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/disableuploadusract_188312.txt
      dest: C:\facts\policyfiles\disableuploadusract_188312.txt
    when: ((database.stdout_lines[1]|from_json).disableuploadusract_188312_actual) != "0x1"
    tags:
      - disableuploadusract
      - 18.8.31.2
      - eighteen
      - all
      - rollback

  - name: adding value to the disableuploadusract file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\disableuploadusract_188312.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).disableuploadusract_188312_actual}}'
    when: ((database.stdout_lines[1]|from_json).disableuploadusract_188312_actual) != "0x1" and ((database.stdout_lines[1]|from_json).disableuploadusract_188312_actual) != "DELETE"
    tags:
      - disableuploadusract
      - 18.8.31.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\disableuploadusract_188312.txt'
    when: ((database.stdout_lines[1]|from_json).disableuploadusract_188312_actual) != "0x1" and ((database.stdout_lines[1]|from_json).disableuploadusract_188312_actual) != "DELETE"
    tags:
      - disableuploadusract
      - 18.8.31.2
      - eighteen
      - all
      - rollback
 
  - name: adding value to the disableuploadusract file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\disableuploadusract_188312.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).disableuploadusract_188312_actual) == "DELETE"
    tags:
      - disableuploadusract
      - 18.8.31.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\disableuploadusract_188312.txt'
    when: ((database.stdout_lines[1]|from_json).disableuploadusract_188312_actual) == "DELETE"
    tags:
      - disableuploadusract
      - 18.8.31.2
      - eighteen
      - all
      - rollback

  - name: copying netconnonbattery file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/netconnonbattery_1883461.txt
      dest: C:\facts\policyfiles\netconnonbattery_1883461.txt
    when: ((database.stdout_lines[1]|from_json).netconnonbattery_1883461_actual) != "0x1"
    tags:
      - netconnonbattery
      - 18.8.34.6.1
      - eighteen
      - all
      - rollback

  - name: adding value to the netconnonbattery file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\netconnonbattery_1883461.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).netconnonbattery_1883461_actual}}'
    when: ((database.stdout_lines[1]|from_json).netconnonbattery_1883461_actual) != "0x1" and ((database.stdout_lines[1]|from_json).netconnonbattery_1883461_actual) != "DELETE"
    tags:
      - netconnonbattery
      - 18.8.34.6.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\netconnonbattery_1883461.txt'
    when: ((database.stdout_lines[1]|from_json).netconnonbattery_1883461_actual) != "0x1" and ((database.stdout_lines[1]|from_json).netconnonbattery_1883461_actual) != "DELETE"
    tags:
      - netconnonbattery
      - 18.8.34.6.1
      - eighteen
      - all
      - rollback
 
  - name: adding value to the netconnonbattery file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\netconnonbattery_1883461.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).netconnonbattery_1883461_actual) == "DELETE"
    tags:
      - netconnonbattery
      - 18.8.34.6.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\netconnonbattery_1883461.txt'
    when: ((database.stdout_lines[1]|from_json).netconnonbattery_1883461_actual) == "DELETE"
    tags:
      - netconnonbattery
      - 18.8.34.6.1
      - eighteen
      - all
      - rollback

  - name: copying netconnpluggedin file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/netconnpluggedin_1883462.txt
      dest: C:\facts\policyfiles\netconnpluggedin_1883462.txt
    when: ((database.stdout_lines[1]|from_json).netconnpluggedin_1883462_actual) != "0x1"
    tags:
      - netconnpluggedin
      - 18.8.34.6.2
      - eighteen
      - all
      - rollback

  - name: adding value to the netconnpluggedin file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\netconnpluggedin_1883462.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).netconnpluggedin_1883462_actual}}'
    when: ((database.stdout_lines[1]|from_json).netconnpluggedin_1883462_actual) != "0x1" and ((database.stdout_lines[1]|from_json).netconnpluggedin_1883462_actual) != "DELETE"
    tags:
      - netconnpluggedin
      - 18.8.34.6.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\netconnpluggedin_1883462.txt'
    when: ((database.stdout_lines[1]|from_json).netconnpluggedin_1883462_actual) != "0x1" and ((database.stdout_lines[1]|from_json).netconnpluggedin_1883462_actual) != "DELETE"
    tags:
      - netconnpluggedin
      - 18.8.34.6.2
      - eighteen
      - all
      - rollback
 
  - name: adding value to the netconnpluggedin file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\netconnpluggedin_1883462.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).netconnpluggedin_1883462_actual) == "DELETE"
    tags:
      - netconnpluggedin
      - 18.8.34.6.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\netconnpluggedin_1883462.txt'
    when: ((database.stdout_lines[1]|from_json).netconnpluggedin_1883462_actual) == "DELETE"
    tags:
      - netconnpluggedin
      - 18.8.34.6.2
      - eighteen
      - all
      - rollback

  - name: copying pwdcompwakesonbattery file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/pwdcompwakesonbattery_1883463.txt
      dest: C:\facts\policyfiles\pwdcompwakesonbattery_1883463.txt
    when: ((database.stdout_lines[1]|from_json).pwdcompwakesonbattery_1883463_actual) != "0x1"
    tags:
      - pwdcompwakesonbattery
      - 18.8.34.6.3
      - eighteen
      - all
      - rollback

  - name: adding value to the pwdcompwakesonbattery file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\pwdcompwakesonbattery_1883463.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).pwdcompwakesonbattery_1883463_actual}}'
    when: ((database.stdout_lines[1]|from_json).pwdcompwakesonbattery_1883463_actual) != "0x1" and ((database.stdout_lines[1]|from_json).pwdcompwakesonbattery_1883463_actual) != "DELETE"
    tags:
      - pwdcompwakesonbattery
      - 18.8.34.6.3
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\pwdcompwakesonbattery_1883463.txt'
    when: ((database.stdout_lines[1]|from_json).pwdcompwakesonbattery_1883463_actual) != "0x1" and ((database.stdout_lines[1]|from_json).pwdcompwakesonbattery_1883463_actual) != "DELETE"
    tags:
      - pwdcompwakesonbattery
      - 18.8.34.6.3
      - eighteen
      - all
      - rollback
 
  - name: adding value to the pwdcompwakesonbattery file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\pwdcompwakesonbattery_1883463.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).pwdcompwakesonbattery_1883463_actual) == "DELETE"
    tags:
      - pwdcompwakesonbattery
      - 18.8.34.6.3
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\pwdcompwakesonbattery_1883463.txt'
    when: ((database.stdout_lines[1]|from_json).pwdcompwakesonbattery_1883463_actual) == "DELETE"
    tags:
      - pwdcompwakesonbattery
      - 18.8.34.6.3
      - eighteen
      - all
      - rollback

  - name: copying pwdcompwakespluggedin file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/pwdcompwakespluggedin_1883464.txt
      dest: C:\facts\policyfiles\pwdcompwakespluggedin_1883464.txt
    when: ((database.stdout_lines[1]|from_json).pwdcompwakespluggedin_1883464_actual) != "0x1"
    tags:
      - pwdcompwakespluggedin
      - 18.8.34.6.4
      - eighteen
      - all
      - rollback

  - name: adding value to the pwdcompwakespluggedin file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\pwdcompwakespluggedin_1883464.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).pwdcompwakespluggedin_1883464_actual}}'
    when: ((database.stdout_lines[1]|from_json).pwdcompwakespluggedin_1883464_actual) != "0x1" and ((database.stdout_lines[1]|from_json).pwdcompwakespluggedin_1883464_actual) != "DELETE"
    tags:
      - pwdcompwakespluggedin
      - 18.8.34.6.4
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\pwdcompwakespluggedin_1883464.txt'
    when: ((database.stdout_lines[1]|from_json).pwdcompwakespluggedin_1883464_actual) != "0x1" and ((database.stdout_lines[1]|from_json).pwdcompwakespluggedin_1883464_actual) != "DELETE"
    tags:
      - pwdcompwakespluggedin
      - 18.8.34.6.4
      - eighteen
      - all
      - rollback
 
  - name: adding value to the pwdcompwakespluggedin file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\pwdcompwakespluggedin_1883464.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).pwdcompwakespluggedin_1883464_actual) == "DELETE"
    tags:
      - pwdcompwakespluggedin
      - 18.8.34.6.4
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\pwdcompwakespluggedin_1883464.txt'
    when: ((database.stdout_lines[1]|from_json).pwdcompwakespluggedin_1883464_actual) == "DELETE"
    tags:
      - pwdcompwakespluggedin
      - 18.8.34.6.4
      - eighteen
      - all
      - rollback

  - name: copying confofferremoteassist file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/confofferremoteassist_188361.txt
      dest: C:\facts\policyfiles\confofferremoteassist_188361.txt
    when: ((database.stdout_lines[1]|from_json).confofferremoteassist_188361_actual) != "0x1"
    tags:
      - confofferremoteassist
      - 18.8.36.1
      - eighteen
      - all
      - rollback

  - name: adding value to the confofferremoteassist file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confofferremoteassist_188361.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).confofferremoteassist_188361_actual}}'
    when: ((database.stdout_lines[1]|from_json).confofferremoteassist_188361_actual) != "0x1" and ((database.stdout_lines[1]|from_json).confofferremoteassist_188361_actual) != "DELETE"
    tags:
      - confofferremoteassist
      - 18.8.36.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\confofferremoteassist_188361.txt'
    when: ((database.stdout_lines[1]|from_json).confofferremoteassist_188361_actual) != "0x1" and ((database.stdout_lines[1]|from_json).confofferremoteassist_188361_actual) != "DELETE"
    tags:
      - confofferremoteassist
      - 18.8.36.1
      - eighteen
      - all
      - rollback
 
  - name: adding value to the confofferremoteassist file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confofferremoteassist_188361.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).confofferremoteassist_188361_actual) == "DELETE"
    tags:
      - confofferremoteassist
      - 18.8.36.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\confofferremoteassist_188361.txt'
    when: ((database.stdout_lines[1]|from_json).confofferremoteassist_188361_actual) == "DELETE"
    tags:
      - confofferremoteassist
      - 18.8.36.1
      - eighteen
      - all
      - rollback

  - name: copying confsolicremoteassist file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/confsolicremoteassist_188362.txt
      dest: C:\facts\policyfiles\confsolicremoteassist_188362.txt
    when: ((database.stdout_lines[1]|from_json).confsolicremoteassist_188362_actual) != "0x1"
    tags:
      - confsolicremoteassist
      - 18.8.36.2
      - eighteen
      - all
      - rollback

  - name: adding value to the confsolicremoteassist file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confsolicremoteassist_188362.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).confsolicremoteassist_188362_actual}}'
    when: ((database.stdout_lines[1]|from_json).confsolicremoteassist_188362_actual) != "0x1" and ((database.stdout_lines[1]|from_json).confsolicremoteassist_188362_actual) != "DELETE"
    tags:
      - confsolicremoteassist
      - 18.8.36.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\confsolicremoteassist_188362.txt'
    when: ((database.stdout_lines[1]|from_json).confsolicremoteassist_188362_actual) != "0x1" and ((database.stdout_lines[1]|from_json).confsolicremoteassist_188362_actual) != "DELETE"
    tags:
      - confsolicremoteassist
      - 18.8.36.2
      - eighteen
      - all
      - rollback
 
  - name: adding value to the confsolicremoteassist file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confsolicremoteassist_188362.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).confsolicremoteassist_188362_actual) == "DELETE"
    tags:
      - confsolicremoteassist
      - 18.8.36.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\confsolicremoteassist_188362.txt'
    when: ((database.stdout_lines[1]|from_json).confsolicremoteassist_188362_actual) == "DELETE"
    tags:
      - confsolicremoteassist
      - 18.8.36.2
      - eighteen
      - all
      - rollback

  - name: copying rpcemcliauthen file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/rpcemcliauthen_188371.txt
      dest: C:\facts\policyfiles\rpcemcliauthen_188371.txt
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).rpcemcliauthen_188371_actual) != "0x1"
    tags:
      - rpcemcliauthen
      - 18.8.37.1
      - eighteen
      - all
      - rollback

  - name: adding value to the rpcemcliauthen file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\rpcemcliauthen_188371.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).rpcemcliauthen_188371_actual}}'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).rpcemcliauthen_188371_actual) != "0x1" and ((database.stdout_lines[1]|from_json).rpcemcliauthen_188371_actual) != "DELETE"
    tags:
      - rpcemcliauthen
      - 18.8.37.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\rpcemcliauthen_188371.txt'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).rpcemcliauthen_188371_actual) != "0x1" and ((database.stdout_lines[1]|from_json).rpcemcliauthen_188371_actual) != "DELETE"
    tags:
      - rpcemcliauthen
      - 18.8.37.1
      - eighteen
      - all
      - rollback
 
  - name: adding value to the rpcemcliauthen file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\rpcemcliauthen_188371.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).rpcemcliauthen_188371_actual) == "DELETE"
    tags:
      - rpcemcliauthen
      - 18.8.37.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\rpcemcliauthen_188371.txt'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).rpcemcliauthen_188371_actual) == "DELETE"
    tags:
      - rpcemcliauthen
      - 18.8.37.1
      - eighteen
      - all
      - rollback

  - name: copying unauthenrpccli file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/unauthenrpccli_188372.txt
      dest: C:\facts\policyfiles\unauthenrpccli_188372.txt
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).unauthenrpccli_188372_actual) != "0x1"
    tags:
      - unauthenrpccli
      - 18.8.37.2
      - eighteen
      - all
      - rollback

  - name: adding value to the unauthenrpccli file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\unauthenrpccli_188372.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).unauthenrpccli_188372_actual}}'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).unauthenrpccli_188372_actual) != "0x1" and ((database.stdout_lines[1]|from_json).unauthenrpccli_188372_actual) != "DELETE"
    tags:
      - unauthenrpccli
      - 18.8.37.2
      - eighteen
      - all
      - rollback

  - name: adding value to the unauthenrpccli file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\unauthenrpccli_188372.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).unauthenrpccli_188372_actual) == "DELETE"
    tags:
      - unauthenrpccli
      - 18.8.37.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\unauthenrpccli_188372.txt'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).unauthenrpccli_188372_actual) != "0x1" and ((database.stdout_lines[1]|from_json).unauthenrpccli_188372_actual) != "DELETE"
    tags:
      - unauthenrpccli
      - 18.8.37.2
      - eighteen
      - all
      - rollback

  - name: copying msdiagnostictool file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/msdiagnostictool_1884751.txt
      dest: C:\facts\policyfiles\msdiagnostictool_1884751.txt
    when: ((database.stdout_lines[1]|from_json).msdiagnostictool_1884751_actual) != "0x1"
    tags:
      - msdiagnostictool
      - 18.8.47.5.1
      - eighteen
      - all
      - rollback

  - name: adding value to the msdiagnostictool file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\msdiagnostictool_1884751.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).msdiagnostictool_1884751_actual}}'
    when: ((database.stdout_lines[1]|from_json).msdiagnostictool_1884751_actual) != "0x1" and ((database.stdout_lines[1]|from_json).msdiagnostictool_1884751_actual) != "DELETE"
    tags:
      - msdiagnostictool
      - 18.8.47.5.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\msdiagnostictool_1884751.txt'
    when: ((database.stdout_lines[1]|from_json).msdiagnostictool_1884751_actual) != "0x1" and ((database.stdout_lines[1]|from_json).msdiagnostictool_1884751_actual) != "DELETE"
    tags:
      - msdiagnostictool
      - 18.8.47.5.1
      - eighteen
      - all
      - rollback
 
  - name: adding value to the msdiagnostictool file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\msdiagnostictool_1884751.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).msdiagnostictool_1884751_actual) == "DELETE"
    tags:
      - msdiagnostictool
      - 18.8.47.5.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\msdiagnostictool_1884751.txt'
    when: ((database.stdout_lines[1]|from_json).msdiagnostictool_1884751_actual) == "DELETE"
    tags:
      - msdiagnostictool
      - 18.8.47.5.1
      - eighteen
      - all
      - rollback

  - name: copying msdiagnostictool file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/msdiagnostictool_1884751.txt
      dest: C:\facts\policyfiles\msdiagnostictool_1884751.txt
    when: ((database.stdout_lines[1]|from_json).msdiagnostictool_1884751_actual) != "0x1"
    tags:
      - msdiagnostictool
      - 18.8.47.11.1
      - eighteen
      - all
      - rollback

  - name: adding value to the msdiagnostictool file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\msdiagnostictool_1884751.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).msdiagnostictool_1884751_actual}}'
    when: ((database.stdout_lines[1]|from_json).msdiagnostictool_1884751_actual) != "0x1" and ((database.stdout_lines[1]|from_json).msdiagnostictool_1884751_actual) != "DELETE"
    tags:
      - msdiagnostictool
      - 18.8.47.11.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\msdiagnostictool_1884751.txt'
    when: ((database.stdout_lines[1]|from_json).msdiagnostictool_1884751_actual) != "0x1" and ((database.stdout_lines[1]|from_json).msdiagnostictool_1884751_actual) != "DELETE"
    tags:
      - msdiagnostictool
      - 18.8.47.11.1
      - eighteen
      - all
      - rollback
 
  - name: adding value to the msdiagnostictool file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\msdiagnostictool_1884751.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).msdiagnostictool_1884751_actual) == "DELETE"
    tags:
      - msdiagnostictool
      - 18.8.47.11.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\msdiagnostictool_1884751.txt'
    when: ((database.stdout_lines[1]|from_json).msdiagnostictool_1884751_actual) == "DELETE"
    tags:
      - msdiagnostictool
      - 18.8.47.11.1
      - eighteen
      - all
      - rollback

  - name: copying perftrack file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/perftrack_18847111.txt
      dest: C:\facts\policyfiles\perftrack_18847111.txt
    when: ((database.stdout_lines[1]|from_json).perftrack_18847111_actual) != "0x1"
    tags:
      - perftrack
      - 18.8.47.11.1
      - eighteen
      - all
      - rollback

  - name: adding value to the perftrack file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\perftrack_18847111.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).perftrack_18847111_actual}}'
    when: ((database.stdout_lines[1]|from_json).perftrack_18847111_actual) != "0x1" and ((database.stdout_lines[1]|from_json).perftrack_18847111_actual) != "DELETE"
    tags:
      - perftrack
      - 18.8.47.11.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\perftrack_18847111.txt'
    when: ((database.stdout_lines[1]|from_json).perftrack_18847111_actual) != "0x1" and ((database.stdout_lines[1]|from_json).perftrack_18847111_actual) != "DELETE"
    tags:
      - perftrack
      - 18.8.47.11.1
      - eighteen
      - all
      - rollback
 
  - name: adding value to the perftrack file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\perftrack_18847111.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).perftrack_18847111_actual) == "DELETE"
    tags:
      - perftrack
      - 18.8.47.11.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\perftrack_18847111.txt'
    when: ((database.stdout_lines[1]|from_json).perftrack_18847111_actual) == "DELETE"
    tags:
      - perftrack
      - 18.8.47.11.1
      - eighteen
      - all
      - rollback

  - name: copying turnoffadvertid file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnoffadvertid_188491.txt
      dest: C:\facts\policyfiles\turnoffadvertid_188491.txt
    when: ((database.stdout_lines[1]|from_json).turnoffadvertid_188491_actual) != "0x1"
    tags:
      - turnoffadvertid
      - 18.8.49.1
      - eighteen
      - all
      - rollback

  - name: adding value to the turnoffadvertid file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffadvertid_188491.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnoffadvertid_188491_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnoffadvertid_188491_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnoffadvertid_188491_actual) != "DELETE"
    tags:
      - turnoffadvertid
      - 18.8.49.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffadvertid_188491.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffadvertid_188491_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnoffadvertid_188491_actual) != "DELETE"
    tags:
      - turnoffadvertid
      - 18.8.49.1
      - eighteen
      - all
      - rollback
 
  - name: adding value to the turnoffadvertid file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffadvertid_188491.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnoffadvertid_188491_actual) == "DELETE"
    tags:
      - turnoffadvertid
      - 18.8.49.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffadvertid_188491.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffadvertid_188491_actual) == "DELETE"
    tags:
      - turnoffadvertid
      - 18.8.49.1
      - eighteen
      - all
      - rollback

  - name: copying enablewinntpcli file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/enablewinntpcli_1885211.txt
      dest: C:\facts\policyfiles\enablewinntpcli_1885211.txt
    when: ((database.stdout_lines[1]|from_json).enablewinntpcli_1885211_actual) != "0x1"
    tags:
      - enablewinntpcli
      - 18.8.52.1.1
      - eighteen
      - all
      - rollback

  - name: adding value to the enablewinntpcli file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\enablewinntpcli_1885211.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).enablewinntpcli_1885211_actual}}'
    when: ((database.stdout_lines[1]|from_json).enablewinntpcli_1885211_actual) != "0x1" and ((database.stdout_lines[1]|from_json).enablewinntpcli_1885211_actual) != "DELETE"
    tags:
      - enablewinntpcli
      - 18.8.52.1.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\enablewinntpcli_1885211.txt'
    when: ((database.stdout_lines[1]|from_json).enablewinntpcli_1885211_actual) != "0x1" and ((database.stdout_lines[1]|from_json).enablewinntpcli_1885211_actual) != "DELETE"
    tags:
      - enablewinntpcli
      - 18.8.52.1.1
      - eighteen
      - all
      - rollback
 
  - name: adding value to the enablewinntpcli file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\enablewinntpcli_1885211.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).enablewinntpcli_1885211_actual) == "DELETE"
    tags:
      - enablewinntpcli
      - 18.8.52.1.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\enablewinntpcli_1885211.txt'
    when: ((database.stdout_lines[1]|from_json).enablewinntpcli_1885211_actual) == "DELETE"
    tags:
      - enablewinntpcli
      - 18.8.52.1.1
      - eighteen
      - all
      - rollback

  - name: copying enablewinntpserv file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/enablewinntpserv_1885212.txt
      dest: C:\facts\policyfiles\enablewinntpserv_1885212.txt
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).enablewinntpserv_1885212_actual) != "0x1"
    tags:
      - enablewinntpserv
      - 18.8.52.1.2
      - eighteen
      - all
      - rollback

  - name: adding value to the bootstartdrivpolicy file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\enablewinntpserv_1885212.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).enablewinntpserv_1885212_actual}}'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).enablewinntpserv_1885212_actual) != "0x1" and ((database.stdout_lines[1]|from_json).enablewinntpserv_1885212_actual) != "DELETE"
    tags:
      - enablewinntpserv
      - 18.8.52.1.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\enablewinntpserv_1885212.txt'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).enablewinntpserv_1885212_actual) != "0x1" and ((database.stdout_lines[1]|from_json).enablewinntpserv_1885212_actual) != "DELETE"
    tags:
      - enablewinntpserv
      - 18.8.52.1.2
      - eighteen
      - all
      - rollback
 
  - name: adding value to the enablewinntpserv file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\enablewinntpserv_1885212.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).enablewinntpserv_1885212_actual) == "DELETE"
    tags:
      - enablewinntpserv
      - 18.8.52.1.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\enablewinntpserv_1885212.txt'
    when:
      - (server_type.stdout_lines[1] | regex_search('3')) == '3'
      - ((database.stdout_lines[1]|from_json).enablewinntpserv_1885212_actual) == "DELETE"
    tags:
      - enablewinntpserv
      - 18.8.52.1.2
      - eighteen
      - all
      - rollback

  - name: copying allowwinapp file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/allowwinapp_18941.txt
      dest: C:\facts\policyfiles\allowwinapp_18941.txt
    when: ((database.stdout_lines[1]|from_json).allowwinapp_18941_actual) != "0x1"
    tags:
      - allowwinapp
      - 18.9.4.1
      - eighteen
      - all
      - rollback

  - name: adding value to the allowwinapp file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\allowwinapp_18941.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).allowwinapp_18941_actual}}'
    when: ((database.stdout_lines[1]|from_json).allowwinapp_18941_actual) != "0x1" and ((database.stdout_lines[1]|from_json).allowwinapp_18941_actual) != "DELETE"
    tags:
      - allowwinapp
      - 18.9.4.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\allowwinapp_18941.txt'
    when: ((database.stdout_lines[1]|from_json).allowwinapp_18941_actual) != "0x1" and ((database.stdout_lines[1]|from_json).allowwinapp_18941_actual) != "DELETE"
    tags:
      - allowwinapp
      - 18.9.4.1
      - eighteen
      - all
      - rollback
 
  - name: adding value to the allowwinapp file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\allowwinapp_18941.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).allowwinapp_18941_actual) == "DELETE"
    tags:
      - allowwinapp
      - 18.9.4.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\allowwinapp_18941.txt'
    when: ((database.stdout_lines[1]|from_json).allowwinapp_18941_actual) == "DELETE"
    tags:
      - allowwinapp
      - 18.9.4.1
      - eighteen
      - all
      - rollback

  - name: copying allowmsacc file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/allowmsacc_18961.txt
      dest: C:\facts\policyfiles\allowmsacc_18961.txt
    when: ((database.stdout_lines[1]|from_json).allowmsacc_18961_actual) != "0x1"
    tags:
      - allowmsacc
      - 18.9.6.1
      - eighteen
      - all
      - rollback

  - name: adding value to the allowmsacc file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\allowmsacc_18961.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).allowmsacc_18961_actual}}'
    when: ((database.stdout_lines[1]|from_json).allowmsacc_18961_actual) != "0x1" and ((database.stdout_lines[1]|from_json).allowmsacc_18961_actual) != "DELETE"
    tags:
      - allowmsacc
      - 18.9.6.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\allowmsacc_18961.txt'
    when: ((database.stdout_lines[1]|from_json).allowmsacc_18961_actual) != "0x1" and ((database.stdout_lines[1]|from_json).allowmsacc_18961_actual) != "DELETE"
    tags:
      - allowmsacc
      - 18.9.6.1
      - eighteen
      - all
      - rollback
 
  - name: adding value to the allowmsacc file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\allowmsacc_18961.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).allowmsacc_18961_actual) == "DELETE"
    tags:
      - allowmsacc
      - 18.9.6.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\allowmsacc_18961.txt'
    when: ((database.stdout_lines[1]|from_json).allowmsacc_18961_actual) == "DELETE"
    tags:
      - allowmsacc
      - 18.9.6.1
      - eighteen
      - all
      - rollback
      
  - name: copying autoplaynonvoldev file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/autoplaynonvoldev_18981.txt
      dest: C:\facts\policyfiles\autoplaynonvoldev_18981.txt
    when: ((database.stdout_lines[1]|from_json).autoplaynonvoldev_18981_actual) != "0x1"
    tags:
      - autoplaynonvoldev
      - 18.9.8.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the autoplaynonvoldev file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\autoplaynonvoldev_18981.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).autoplaynonvoldev_18981_actual}}'
    when: ((database.stdout_lines[1]|from_json).autoplaynonvoldev_18981_actual) != "0x1" and ((database.stdout_lines[1]|from_json).autoplaynonvoldev_18981_actual) != "DELETE"
    tags:
      - autoplaynonvoldev
      - 18.9.8.1
      - eighteen
      - all
      - rollback
            
  - name: adding value to the autoplaynonvoldev file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\autoplaynonvoldev_18981.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).autoplaynonvoldev_18981_actual) == "DELETE"
    tags:
      - autoplaynonvoldev
      - 18.9.8.1
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\autoplaynonvoldev_18981.txt'
    when: ((database.stdout_lines[1]|from_json).autoplaynonvoldev_18981_actual) != "0x1"
    tags:
      - autoplaynonvoldev
      - 18.9.8.1
      - eighteen
      - all
      - rollback
      
  - name: copying defaultautorun file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/defaultautorun_18982.txt
      dest: C:\facts\policyfiles\defaultautorun_18982.txt
    when: ((database.stdout_lines[1]|from_json).defaultautorun_18982_actual) != "0x1"
    tags:
      - defaultautorun
      - 18.9.8.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the defaultautorun file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\defaultautorun_18982.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).defaultautorun_18982_actual}}'
    when: ((database.stdout_lines[1]|from_json).defaultautorun_18982_actual) != "0x1" and ((database.stdout_lines[1]|from_json).defaultautorun_18982_actual) != "DELETE"
    tags:
      - defaultautorun
      - 18.9.8.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the defaultautorun file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\defaultautorun_18982.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).defaultautorun_18982_actual) == "DELETE"
    tags:
      - defaultautorun
      - 18.9.8.2
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\defaultautorun_18982.txt'
    when: ((database.stdout_lines[1]|from_json).defaultautorun_18982_actual) != "0x1"
    tags:
      - defaultautorun
      - 18.9.8.2
      - eighteen
      - all
      - rollback
      
  - name: copying turnoffautoplay file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnoffautoplay_18983.txt
      dest: C:\facts\policyfiles\turnoffautoplay_18983.txt
    when: ((database.stdout_lines[1]|from_json).turnoffautoplay_18983_actual) != "0xff"
    tags:
      - turnoffautoplay
      - 18.9.8.3
      - eighteen
      - all
      - rollback
      
  - name: adding value to the turnoffautoplay file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffautoplay_18983.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnoffautoplay_18983_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnoffautoplay_18983_actual) != "0xff" and ((database.stdout_lines[1]|from_json).turnoffautoplay_18983_actual) != "DELETE"
    tags:
      - turnoffautoplay
      - 18.9.8.3
      - eighteen
      - all
      - rollback
      
  - name: adding value to the turnoffautoplay file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffautoplay_18983.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnoffautoplay_18983_actual) == "DELETE"
    tags:
      - turnoffautoplay
      - 18.9.8.3
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffautoplay_18983.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffautoplay_18983_actual) != "0xff"
    tags:
      - turnoffautoplay
      - 18.9.8.3
      - eighteen
      - all
      - rollback
      
  - name: copying confantispoof file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/confantispoof_1891011.txt
      dest: C:\facts\policyfiles\confantispoof_1891011.txt
    when: ((database.stdout_lines[1]|from_json).confantispoof_1891011_actual) != "0x1"
    tags:
      - confantispoof
      - 18.9.10.1.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the confantispoof file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confantispoof_1891011.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).confantispoof_1891011_actual}}'
    when: ((database.stdout_lines[1]|from_json).confantispoof_1891011_actual) != "0x1" and ((database.stdout_lines[1]|from_json).confantispoof_1891011_actual) != "DELETE"
    tags:
      - confantispoof
      - 18.9.10.1.1
      - eighteen
      - all
      - rollback
            
  - name: adding value to the confantispoof file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confantispoof_1891011.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).confantispoof_1891011_actual) == "DELETE"
    tags:
      - confantispoof
      - 18.9.10.1.1
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\confantispoof_1891011.txt'
    when: ((database.stdout_lines[1]|from_json).confantispoof_1891011_actual) != "0x1"
    tags:
      - confantispoof
      - 18.9.10.1.1
      - eighteen
      - all
      - rollback

  - name: copying allowcamera file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/allowcamera_189121.txt
      dest: C:\facts\policyfiles\allowcamera_189121.txt
    when: ((database.stdout_lines[1]|from_json).allowcamera_189121_actual) != "0x0"
    tags:
      - allowcamera
      - 18.9.12.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the allowcamera file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\allowcamera_189121.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).allowcamera_189121_actual}}'
    when: ((database.stdout_lines[1]|from_json).allowcamera_189121_actual) != "0x0" and ((database.stdout_lines[1]|from_json).allowcamera_189121_actual) != "DELETE"
    tags:
      - allowcamera
      - 18.9.12.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the allowcamera file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\allowcamera_189121.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).allowcamera_189121_actual) == "DELETE"
    tags:
      - allowcamera
      - 18.9.12.1
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\allowcamera_189121.txt'
    when: ((database.stdout_lines[1]|from_json).allowcamera_189121_actual) != "0x0"
    tags:
      - allowcamera
      - 18.9.12.1
      - eighteen
      - all
      - rollback
  
  - name: copying turnoffmsconsumer file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnoffmsconsumer_189131.txt
      dest: C:\facts\policyfiles\turnoffmsconsumer_189131.txt
    when: ((database.stdout_lines[1]|from_json).turnoffmsconsumer_189131_actual) != "0x1"
    tags:
      - turnoffmsconsumer
      - 18.9.13.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the turnoffmsconsumer file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffmsconsumer_189131.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnoffmsconsumer_189131_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnoffmsconsumer_189131_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnoffmsconsumer_189131_actual) != "DELETE"
    tags:
      - turnoffmsconsumer
      - 18.9.13.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the turnoffmsconsumer file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffmsconsumer_189131.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnoffmsconsumer_189131_actual) == "DELETE"
    tags:
      - turnoffmsconsumer
      - 18.9.13.1
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffmsconsumer_189131.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffmsconsumer_189131_actual) != "0x1"
    tags:
      - turnoffmsconsumer
      - 18.9.13.1
      - eighteen
      - all
      - rollback
      
  - name: copying enpinpairing file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/enpinpairing_189141.txt
      dest: C:\facts\policyfiles\enpinpairing_189141.txt
    when: ((database.stdout_lines[1]|from_json).enpinpairing_189141_actual) != "0x1"
    tags:
      - enpinpairing
      - 18.9.14.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the enpinpairing file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\enpinpairing_189141.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).enpinpairing_189141_actual}}'
    when: ((database.stdout_lines[1]|from_json).enpinpairing_189141_actual) != "0x1" and ((database.stdout_lines[1]|from_json).enpinpairing_189141_actual) != "DELETE"
    tags:
      - enpinpairing
      - 18.9.14.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the enpinpairing file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\enpinpairing_189141.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).enpinpairing_189141_actual) == "DELETE"
    tags:
      - enpinpairing
      - 18.9.14.1
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\enpinpairing_189141.txt'
    when: ((database.stdout_lines[1]|from_json).enpinpairing_189141_actual) != "0x1"
    tags:
      - enpinpairing
      - 18.9.14.1
      - eighteen
      - all
      - rollback
 
  - name: copying pwdrevealbutton file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/pwdrevealbutton_189151.txt
      dest: C:\facts\policyfiles\pwdrevealbutton_189151.txt
    when: ((database.stdout_lines[1]|from_json).pwdrevealbutton_189151_actual) != "0x1"
    tags:
      - pwdrevealbutton
      - 18.9.15.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the pwdrevealbutton file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\pwdrevealbutton_189151.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).pwdrevealbutton_189151_actual}}'
    when: ((database.stdout_lines[1]|from_json).pwdrevealbutton_189151_actual) != "0x1" and ((database.stdout_lines[1]|from_json).pwdrevealbutton_189151_actual) != "DELETE"
    tags:
      - pwdrevealbutton
      - 18.9.15.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the pwdrevealbutton file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\pwdrevealbutton_189151.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).pwdrevealbutton_189151_actual) == "DELETE"
    tags:
      - pwdrevealbutton
      - 18.9.15.1
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\pwdrevealbutton_189151.txt'
    when: ((database.stdout_lines[1]|from_json).pwdrevealbutton_189151_actual) != "0x1"
    tags:
      - pwdrevealbutton
      - 18.9.15.1
      - eighteen
      - all
      - rollback
      
  - name: copying admaccelevation file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/admaccelevation_189152.txt
      dest: C:\facts\policyfiles\admaccelevation_189152.txt
    when: ((database.stdout_lines[1]|from_json).admaccelevation_189152_actual) != "0x0"
    tags:
      - admaccelevation
      - 18.9.15.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the admaccelevation file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\admaccelevation_189152.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).admaccelevation_189152_actual}}'
    when: ((database.stdout_lines[1]|from_json).admaccelevation_189152_actual) != "0x0" and ((database.stdout_lines[1]|from_json).admaccelevation_189152_actual) != "DELETE"
    tags:
      - admaccelevation
      - 18.9.15.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the admaccelevation file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\admaccelevation_189152.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).admaccelevation_189152_actual) == "DELETE"
    tags:
      - admaccelevation
      - 18.9.15.2
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\admaccelevation_189152.txt'
    when: ((database.stdout_lines[1]|from_json).admaccelevation_189152_actual) != "0x0"
    tags:
      - admaccelevation
      - 18.9.15.2
      - eighteen
      - all
      - rollback
      
  - name: copying allowtelemetry file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/allowtelemetry_189161.txt
      dest: C:\facts\policyfiles\allowtelemetry_189161.txt
    when: ((database.stdout_lines[1]|from_json).allowtelemetry_189161_actual) != "0x0"
    tags:
      - allowtelemetry
      - 18.9.16.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the allowtelemetry file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\allowtelemetry_189161.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).allowtelemetry_189161_actual}}'
    when: ((database.stdout_lines[1]|from_json).allowtelemetry_189161_actual) != "0x0" and ((database.stdout_lines[1]|from_json).allowtelemetry_189161_actual) != "DELETE"
    tags:
      - allowtelemetry
      - 18.9.16.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the allowtelemetry file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\allowtelemetry_189161.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).allowtelemetry_189161_actual) == "DELETE"
    tags:
      - allowtelemetry
      - 18.9.16.1
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\allowtelemetry_189161.txt'
    when: ((database.stdout_lines[1]|from_json).allowtelemetry_189161_actual) != "0x0"
    tags:
      - allowtelemetry
      - 18.9.16.1
      - eighteen
      - all
      - rollback
      
  - name: copying confauthenproxy file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/confauthenproxy_189162.txt
      dest: C:\facts\policyfiles\confauthenproxy_189162.txt
    when: ((database.stdout_lines[1]|from_json).confauthenproxy_189162_actual) != "0x1"
    tags:
      - confauthenproxy
      - 18.9.16.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the confauthenproxy file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confauthenproxy_189162.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).confauthenproxy_189162_actual}}'
    when: ((database.stdout_lines[1]|from_json).confauthenproxy_189162_actual) != "0x1" and ((database.stdout_lines[1]|from_json).confauthenproxy_189162_actual) != "DELETE"
    tags:
      - confauthenproxy
      - 18.9.16.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the confauthenproxy file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confauthenproxy_189162.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).confauthenproxy_189162_actual) == "DELETE"
    tags:
      - confauthenproxy
      - 18.9.16.2
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\confauthenproxy_189162.txt'
    when: ((database.stdout_lines[1]|from_json).confauthenproxy_189162_actual) != "0x1"
    tags:
      - confauthenproxy
      - 18.9.16.2
      - eighteen
      - all
      - rollback

  - name: copying dontshowfeedbacknotific file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/dontshowfeedbacknotific_189163.txt
      dest: C:\facts\policyfiles\dontshowfeedbacknotific_189163.txt
    when: ((database.stdout_lines[1]|from_json).dontshowfeedbacknotific_189163_actual) != "0x1"
    tags:
      - dontshowfeedbacknotific
      - 18.9.16.3
      - eighteen
      - all
      - rollback
      
  - name: adding value to the dontshowfeedbacknotific file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\dontshowfeedbacknotific_189163.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).dontshowfeedbacknotific_189163_actual}}'
    when: ((database.stdout_lines[1]|from_json).dontshowfeedbacknotific_189163_actual) != "0x1" and ((database.stdout_lines[1]|from_json).dontshowfeedbacknotific_189163_actual) != "DELETE"
    tags:
      - dontshowfeedbacknotific
      - 18.9.16.3
      - eighteen
      - all
      - rollback
      
  - name: adding value to the dontshowfeedbacknotific file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\dontshowfeedbacknotific_189163.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).dontshowfeedbacknotific_189163_actual) == "DELETE"
    tags:
      - dontshowfeedbacknotific
      - 18.9.16.3
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\dontshowfeedbacknotific_189163.txt'
    when: ((database.stdout_lines[1]|from_json).dontshowfeedbacknotific_189163_actual) != "0x1"
    tags:
      - dontshowfeedbacknotific
      - 18.9.16.3
      - eighteen
      - all
      - rollback
      
  - name: copying toggleusrcontrol file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/toggleusrcontrol_189164.txt
      dest: C:\facts\policyfiles\toggleusrcontrol_189164.txt
    when: ((database.stdout_lines[1]|from_json).toggleusrcontrol_189164_actual) != "0x0"
    tags:
      - toggleusrcontrol
      - 18.9.16.4
      - eighteen
      - all
      - rollback
      
  - name: adding value to the toggleusrcontrol file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\toggleusrcontrol_189164.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).toggleusrcontrol_189164_actual}}'
    when: ((database.stdout_lines[1]|from_json).toggleusrcontrol_189164_actual) != "0x0" and ((database.stdout_lines[1]|from_json).toggleusrcontrol_189164_actual) != "DELETE"
    tags:
      - toggleusrcontrol
      - 18.9.16.4
      - eighteen
      - all
      - rollback
      
  - name: adding value to the toggleusrcontrol file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\toggleusrcontrol_189164.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).toggleusrcontrol_189164_actual) == "DELETE"
    tags:
      - toggleusrcontrol
      - 18.9.16.4
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\toggleusrcontrol_189164.txt'
    when: ((database.stdout_lines[1]|from_json).toggleusrcontrol_189164_actual) != "0x0"
    tags:
      - toggleusrcontrol
      - 18.9.16.4
      - eighteen
      - all
      - rollback

  - name: copying appcontroleventlog file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/appcontroleventlog_1892611.txt
      dest: C:\facts\policyfiles\appcontroleventlog_1892611.txt
    when: ((database.stdout_lines[1]|from_json).appcontroleventlog_1892611_actual) != "0"
    tags:
      - appcontroleventlog
      - 18.9.26.1.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the appcontroleventlog file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\appcontroleventlog_1892611.txt
       regex: '^(SZ:*)'
       line: 'SZ:{{(database.stdout_lines[1]|from_json).appcontroleventlog_1892611_actual}}'
    when: ((database.stdout_lines[1]|from_json).appcontroleventlog_1892611_actual) != "0" and ((database.stdout_lines[1]|from_json).appcontroleventlog_1892611_actual) != "DELETE"
    tags:
      - appcontroleventlog
      - 18.9.26.1.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the appcontroleventlog file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\appcontroleventlog_1892611.txt
       regex: '^(SZ:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).appcontroleventlog_1892611_actual) == "DELETE"
    tags:
      - appcontroleventlog
      - 18.9.26.1.1
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\appcontroleventlog_1892611.txt'
    when: ((database.stdout_lines[1]|from_json).appcontroleventlog_1892611_actual) != "0"
    tags:
      - appcontroleventlog
      - 18.9.26.1.1
      - eighteen
      - all
      - rollback
      
  - name: copying appmaxlogfilesize file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/appmaxlogfilesize_1892612.txt
      dest: C:\facts\policyfiles\appmaxlogfilesize_1892612.txt
    when: ((database.stdout_lines[1]|from_json).appmaxlogfilesize_1892612_actual) > "8000"
    tags:
      - appmaxlogfilesize
      - 18.9.26.1.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the appmaxlogfilesize file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\appmaxlogfilesize_1892612.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).appmaxlogfilesize_1892612_actual}}'
    when: ((database.stdout_lines[1]|from_json).appmaxlogfilesize_1892612_actual) > "8000" and ((database.stdout_lines[1]|from_json).appmaxlogfilesize_1892612_actual) != "DELETE"
    tags:
      - appmaxlogfilesize
      - 18.9.26.1.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the appmaxlogfilesize file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\appmaxlogfilesize_1892612.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).appmaxlogfilesize_1892612_actual) == "DELETE"
    tags:
      - appmaxlogfilesize
      - 18.9.26.1.2
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\appmaxlogfilesize_1892612.txt'
    when: ((database.stdout_lines[1]|from_json).appmaxlogfilesize_1892612_actual) > "8000"
    tags:
      - appmaxlogfilesize
      - 18.9.26.1.2
      - eighteen
      - all
      - rollback
       
  - name: copying securcontroleventlog file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/securcontroleventlog_1892621.txt
      dest: C:\facts\policyfiles\securcontroleventlog_1892621.txt
    when: ((database.stdout_lines[1]|from_json).securcontroleventlog_1892621_actual) != "0x0"
    tags:
      - securcontroleventlog
      - 18.9.26.2.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the securcontroleventlog file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\securcontroleventlog_1892621.txt
       regex: '^(SZ:*)'
       line: 'SZ:{{(database.stdout_lines[1]|from_json).securcontroleventlog_1892621_actual}}'
    when: ((database.stdout_lines[1]|from_json).securcontroleventlog_1892621_actual) != "0x0" and ((database.stdout_lines[1]|from_json).securcontroleventlog_1892621_actual) != "DELETE"
    tags:
      - securcontroleventlog
      - 18.9.26.2.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the securcontroleventlog file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\securcontroleventlog_1892621.txt
       regex: '^(SZ:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).securcontroleventlog_1892621_actual) == "DELETE"
    tags:
      - securcontroleventlog
      - 18.9.26.2.1
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\securcontroleventlog_1892621.txt'
    when: ((database.stdout_lines[1]|from_json).securcontroleventlog_1892621_actual) != "0x0"
    tags:
      - securcontroleventlog
      - 18.9.26.2.1
      - eighteen
      - all
      - rollback
      
  - name: copying securmaxlogfilesize file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/securmaxlogfilesize_1892622.txt
      dest: C:\facts\policyfiles\securmaxlogfilesize_1892622.txt
    when: ((database.stdout_lines[1]|from_json).securmaxlogfilesize_1892622_actual) > "30000"
    tags:
      - securmaxlogfilesize
      - 18.9.26.2.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the securmaxlogfilesize file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\securmaxlogfilesize_1892622.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).securmaxlogfilesize_1892622_actual}}'
    when: ((database.stdout_lines[1]|from_json).securmaxlogfilesize_1892622_actual) > "30000" and ((database.stdout_lines[1]|from_json).securmaxlogfilesize_1892622_actual) != "DELETE"
    tags:
      - securmaxlogfilesize
      - 18.9.26.2.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the securmaxlogfilesize file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\securmaxlogfilesize_1892622.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).securmaxlogfilesize_1892622_actual) == "DELETE"
    tags:
      - securmaxlogfilesize
      - 18.9.26.2.2
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\securmaxlogfilesize_1892622.txt'
    when: ((database.stdout_lines[1]|from_json).securmaxlogfilesize_1892622_actual) > "30000"
    tags:
      - securmaxlogfilesize
      - 18.9.26.2.2
      - eighteen
      - all
      - rollback
      
  - name: copying setupcontroleventlog file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/setupcontroleventlog_1892631.txt
      dest: C:\facts\policyfiles\setupcontroleventlog_1892631.txt
    when: ((database.stdout_lines[1]|from_json).setupcontroleventlog_1892631_actual) != "0x0"
    tags:
      - setupcontroleventlog
      - 18.9.26.3.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the setupcontroleventlog file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\setupcontroleventlog_1892631.txt
       regex: '^(SZ:*)'
       line: 'SZ:{{(database.stdout_lines[1]|from_json).setupcontroleventlog_1892631_actual}}'
    when: ((database.stdout_lines[1]|from_json).setupcontroleventlog_1892631_actual) != "0x0" and ((database.stdout_lines[1]|from_json).setupcontroleventlog_1892631_actual) != "DELETE"
    tags:
      - setupcontroleventlog
      - 18.9.26.3.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the setupcontroleventlog file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\setupcontroleventlog_1892631.txt
       regex: '^(SZ:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).setupcontroleventlog_1892631_actual) == "DELETE"
    tags:
      - setupcontroleventlog
      - 18.9.26.3.1
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\setupcontroleventlog_1892631.txt'
    when: ((database.stdout_lines[1]|from_json).setupcontroleventlog_1892631_actual) != "0x0"
    tags:
      - setupcontroleventlog
      - 18.9.26.3.1
      - eighteen
      - all
      - rollback
      
  - name: copying setupmaxlogfilesize file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/setupmaxlogfilesize_1892632.txt
      dest: C:\facts\policyfiles\setupmaxlogfilesize_1892632.txt
    when: ((database.stdout_lines[1]|from_json).setupmaxlogfilesize_1892632_actual) > "8000"
    tags:
      - setupmaxlogfilesize
      - 18.9.26.3.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the setupmaxlogfilesize file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\setupmaxlogfilesize_1892632.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).setupmaxlogfilesize_1892632_actual}}'
    when: ((database.stdout_lines[1]|from_json).setupmaxlogfilesize_1892632_actual) > "8000" and ((database.stdout_lines[1]|from_json).setupmaxlogfilesize_1892632_actual) != "DELETE"
    tags:
      - setupmaxlogfilesize
      - 18.9.26.3.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the setupmaxlogfilesize file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\setupmaxlogfilesize_1892632.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).setupmaxlogfilesize_1892632_actual) == "DELETE"
    tags:
      - setupmaxlogfilesize
      - 18.9.26.3.2
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\setupmaxlogfilesize_1892632.txt'
    when: ((database.stdout_lines[1]|from_json).setupmaxlogfilesize_1892632_actual) > "8000"
    tags:
      - setupmaxlogfilesize
      - 18.9.26.3.2
      - eighteen
      - all
      - rollback
      
  - name: copying syscontroleventlog file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/syscontroleventlog_1892641.txt
      dest: C:\facts\policyfiles\syscontroleventlog_1892641.txt
    when: ((database.stdout_lines[1]|from_json).syscontroleventlog_1892641_actual) != "0x0"
    tags:
      - syscontroleventlog
      - 18.9.26.4.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the syscontroleventlog file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\syscontroleventlog_1892641.txt
       regex: '^(SZ:*)'
       line: 'SZ:{{(database.stdout_lines[1]|from_json).syscontroleventlog_1892641_actual}}'
    when: ((database.stdout_lines[1]|from_json).syscontroleventlog_1892641_actual) != "0x0" and ((database.stdout_lines[1]|from_json).syscontroleventlog_1892641_actual) != "DELETE"
    tags:
      - syscontroleventlog
      - 18.9.26.4.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the syscontroleventlog file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\syscontroleventlog_1892641.txt
       regex: '^(SZ:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).syscontroleventlog_1892641_actual) == "DELETE"
    tags:
      - syscontroleventlog
      - 18.9.26.4.1
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\syscontroleventlog_1892641.txt'
    when: ((database.stdout_lines[1]|from_json).syscontroleventlog_1892641_actual) != "0x0"
    tags:
      - syscontroleventlog
      - 18.9.26.4.1
      - eighteen
      - all
      - rollback
      
  - name: copying sysmaxlogfilesize file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/sysmaxlogfilesize_1892642.txt
      dest: C:\facts\policyfiles\sysmaxlogfilesize_1892642.txt
    when: ((database.stdout_lines[1]|from_json).sysmaxlogfilesize_1892642_actual) > "8000"
    tags:
      - sysmaxlogfilesize
      - 18.9.26.4.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the sysmaxlogfilesize file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\sysmaxlogfilesize_1892642.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).sysmaxlogfilesize_1892642_actual}}'
    when: ((database.stdout_lines[1]|from_json).sysmaxlogfilesize_1892642_actual) > "8000" and ((database.stdout_lines[1]|from_json).sysmaxlogfilesize_1892642_actual) != "DELETE"
    tags:
      - sysmaxlogfilesize
      - 18.9.26.4.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the sysmaxlogfilesize file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\sysmaxlogfilesize_1892642.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).sysmaxlogfilesize_1892642_actual) == "DELETE"
    tags:
      - sysmaxlogfilesize
      - 18.9.26.4.2
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\sysmaxlogfilesize_1892642.txt'
    when: ((database.stdout_lines[1]|from_json).sysmaxlogfilesize_1892642_actual) > "8000"
    tags:
      - sysmaxlogfilesize
      - 18.9.26.4.2
      - eighteen
      - all
      - rollback
      
  - name: copying turnoffdataexec file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnoffdataexec_189302.txt
      dest: C:\facts\policyfiles\turnoffdataexec_189302.txt
    when: ((database.stdout_lines[1]|from_json).turnoffdataexec_189302_actual) != "0x0"
    tags:
      - turnoffdataexec
      - 18.9.30.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the turnoffdataexec file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffdataexec_189302.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnoffdataexec_189302_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnoffdataexec_189302_actual) != "0x0" and ((database.stdout_lines[1]|from_json).turnoffdataexec_189302_actual) != "DELETE"
    tags:
      - turnoffdataexec
      - 18.9.30.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the turnoffdataexec file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffdataexec_189302.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnoffdataexec_189302_actual) == "DELETE"
    tags:
      - turnoffdataexec
      - 18.9.30.2
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffdataexec_189302.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffdataexec_189302_actual) != "0x0"
    tags:
      - turnoffdataexec
      - 18.9.30.2
      - eighteen
      - all
      - rollback
      
  - name: copying turnoffheaptermination file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnoffheaptermination_189303.txt
      dest: C:\facts\policyfiles\turnoffheaptermination_189303.txt
    when: ((database.stdout_lines[1]|from_json).turnoffheaptermination_189303_actual) != "0x0"
    tags:
      - turnoffheaptermination
      - 18.9.30.3
      - eighteen
      - all
      - rollback
      
  - name: adding value to the turnoffheaptermination file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffheaptermination_189303.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnoffheaptermination_189303_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnoffheaptermination_189303_actual) != "0x0" and ((database.stdout_lines[1]|from_json).turnoffheaptermination_189303_actual) != "DELETE"
    tags:
      - turnoffheaptermination
      - 18.9.30.3
      - eighteen
      - all
      - rollback
      
  - name: adding value to the turnoffheaptermination file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffheaptermination_189303.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnoffheaptermination_189303_actual) == "DELETE"
    tags:
      - turnoffheaptermination
      - 18.9.30.3
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffheaptermination_189303.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffheaptermination_189303_actual) != "0x0"
    tags:
      - turnoffheaptermination
      - 18.9.30.3
      - eighteen
      - all
      - rollback
      
  - name: copying turnoffshellprotocol file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnoffshellprotocol_189304.txt
      dest: C:\facts\policyfiles\turnoffshellprotocol_189304.txt
    when: ((database.stdout_lines[1]|from_json).turnoffshellprotocol_189304_actual) != "0x0"
    tags:
      - turnoffshellprotocol
      - 18.9.30.4
      - eighteen
      - all
      - rollback
      
  - name: adding value to the turnoffshellprotocol file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffshellprotocol_189304.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnoffshellprotocol_189304_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnoffshellprotocol_189304_actual) != "0x0" and ((database.stdout_lines[1]|from_json).turnoffshellprotocol_189304_actual) != "DELETE"
    tags:
      - turnoffshellprotocol
      - 18.9.30.4
      - eighteen
      - all
      - rollback
      
  - name: adding value to the turnoffshellprotocol file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffshellprotocol_189304.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnoffshellprotocol_189304_actual) == "DELETE"
    tags:
      - turnoffshellprotocol
      - 18.9.30.4
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffshellprotocol_189304.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffshellprotocol_189304_actual) != "0x0"
    tags:
      - turnoffshellprotocol
      - 18.9.30.4
      - eighteen
      - all
      - rollback
      
  - name: copying turnofflocation file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnofflocation_189392.txt
      dest: C:\facts\policyfiles\turnofflocation_189392.txt
    when: ((database.stdout_lines[1]|from_json).turnofflocation_189392_actual) != "0x1"
    tags:
      - turnofflocation
      - 18.9.39.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the turnofflocation file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnofflocation_189392.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnofflocation_189392_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnofflocation_189392_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnofflocation_189392_actual) != "DELETE"
    tags:
      - turnofflocation
      - 18.9.39.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the turnofflocation file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnofflocation_189392.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnofflocation_189392_actual) == "DELETE"
    tags:
      - turnofflocation
      - 18.9.39.2
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnofflocation_189392.txt'
    when: ((database.stdout_lines[1]|from_json).turnofflocation_189392_actual) != "0x1"
    tags:
      - turnofflocation
      - 18.9.39.2
      - eighteen
      - all
      - rollback
      
  - name: copying msgservcloudsync file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/msgservcloudsync_189431.txt
      dest: C:\facts\policyfiles\msgservcloudsync_189431.txt
    when: ((database.stdout_lines[1]|from_json).msgservcloudsync_189431_actual) != "0x0"
    tags:
      - msgservcloudsync
      - 18.9.43.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the msgservcloudsync file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\msgservcloudsync_189431.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).msgservcloudsync_189431_actual}}'
    when: ((database.stdout_lines[1]|from_json).msgservcloudsync_189431_actual) != "0x0" and ((database.stdout_lines[1]|from_json).msgservcloudsync_189431_actual) != "DELETE"
    tags:
      - msgservcloudsync
      - 18.9.43.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the msgservcloudsync file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\msgservcloudsync_189431.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).msgservcloudsync_189431_actual) == "DELETE"
    tags:
      - msgservcloudsync
      - 18.9.43.1
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\msgservcloudsync_189431.txt'
    when: ((database.stdout_lines[1]|from_json).msgservcloudsync_189431_actual) != "0x0"
    tags:
      - msgservcloudsync
      - 18.9.43.1
      - eighteen
      - all
      - rollback
      
  - name: copying blockmsaccusrauthen file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/blockmsaccusrauthen_189441.txt
      dest: C:\facts\policyfiles\blockmsaccusrauthen_189441.txt
    when: ((database.stdout_lines[1]|from_json).blockmsaccusrauthen_189441_actual) != "0x1"
    tags:
      - blockmsaccusrauthen
      - 18.9.44.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the blockmsaccusrauthen file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\blockmsaccusrauthen_189441.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).blockmsaccusrauthen_189441_actual}}'
    when: ((database.stdout_lines[1]|from_json).blockmsaccusrauthen_189441_actual) != "0x1" and ((database.stdout_lines[1]|from_json).blockmsaccusrauthen_189441_actual) != "DELETE"
    tags:
      - blockmsaccusrauthen
      - 18.9.44.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the blockmsaccusrauthen file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\blockmsaccusrauthen_189441.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).blockmsaccusrauthen_189441_actual) == "DELETE"
    tags:
      - blockmsaccusrauthen
      - 18.9.44.1
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\blockmsaccusrauthen_189441.txt'
    when: ((database.stdout_lines[1]|from_json).blockmsaccusrauthen_189441_actual) != "0x1"
    tags:
      - blockmsaccusrauthen
      - 18.9.44.1
      - eighteen
      - all
      - rollback
      
  - name: copying preventonedriveusage file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/preventonedriveusage_189521.txt
      dest: C:\facts\policyfiles\preventonedriveusage_189521.txt
    when: ((database.stdout_lines[1]|from_json).preventonedriveusage_189521_actual) != "0x1"
    tags:
      - preventonedriveusage
      - 18.9.52.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the preventonedriveusage file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\preventonedriveusage_189521.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).preventonedriveusage_189521_actual}}'
    when: ((database.stdout_lines[1]|from_json).preventonedriveusage_189521_actual) != "0x1" and ((database.stdout_lines[1]|from_json).preventonedriveusage_189521_actual) != "DELETE"
    tags:
      - preventonedriveusage
      - 18.9.52.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the preventonedriveusage file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\preventonedriveusage_189521.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).preventonedriveusage_189521_actual) == "DELETE"
    tags:
      - preventonedriveusage
      - 18.9.52.1
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\preventonedriveusage_189521.txt'
    when: ((database.stdout_lines[1]|from_json).preventonedriveusage_189521_actual) != "0x1"
    tags:
      - preventonedriveusage
      - 18.9.52.1
      - eighteen
      - all
      - rollback
      
  - name: copying dontallowpwdsaved file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/dontallowpwdsaved_1895922.txt
      dest: C:\facts\policyfiles\dontallowpwdsaved_1895922.txt
    when: ((database.stdout_lines[1]|from_json).dontallowpwdsaved_1895922_actual) != "0x1"
    tags:
      - dontallowpwdsaved
      - 18.9.59.2.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the dontallowpwdsaved file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\dontallowpwdsaved_1895922.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).dontallowpwdsaved_1895922_actual}}'
    when: ((database.stdout_lines[1]|from_json).dontallowpwdsaved_1895922_actual) != "0x1" and ((database.stdout_lines[1]|from_json).dontallowpwdsaved_1895922_actual) != "DELETE"
    tags:
      - dontallowpwdsaved
      - 18.9.59.2.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the dontallowpwdsaved file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\dontallowpwdsaved_1895922.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).dontallowpwdsaved_1895922_actual) == "DELETE"
    tags:
      - dontallowpwdsaved
      - 18.9.59.2.2
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\dontallowpwdsaved_1895922.txt'
    when: ((database.stdout_lines[1]|from_json).dontallowpwdsaved_1895922_actual) != "0x1"
    tags:
      - dontallowpwdsaved
      - 18.9.59.2.2
      - eighteen
      - all
      - rollback
      
  - name: copying restrictremdesktopserv file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/restrictremdesktopserv_18959321.txt
      dest: C:\facts\policyfiles\restrictremdesktopserv_18959321.txt
    when: ((database.stdout_lines[1]|from_json).restrictremdesktopserv_18959321_actual) != "0x1"
    tags:
      - restrictremdesktopserv
      - 18.9.59.3.2.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the restrictremdesktopserv file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\restrictremdesktopserv_18959321.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).restrictremdesktopserv_18959321_actual}}'
    when: ((database.stdout_lines[1]|from_json).restrictremdesktopserv_18959321_actual) != "0x1" and ((database.stdout_lines[1]|from_json).restrictremdesktopserv_18959321_actual) != "DELETE"
    tags:
      - restrictremdesktopserv
      - 18.9.59.3.2.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the restrictremdesktopserv file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\restrictremdesktopserv_18959321.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).restrictremdesktopserv_18959321_actual) == "DELETE"
    tags:
      - restrictremdesktopserv
      - 18.9.59.3.2.1
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\restrictremdesktopserv_18959321.txt'
    when: ((database.stdout_lines[1]|from_json).restrictremdesktopserv_18959321_actual) != "0x1"
    tags:
      - restrictremdesktopserv
      - 18.9.59.3.2.1
      - eighteen
      - all
      - rollback
      
  - name: copying dontallowcomport file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/dontallowcomport_18959331.txt
      dest: C:\facts\policyfiles\dontallowcomport_18959331.txt
    when: ((database.stdout_lines[1]|from_json).dontallowcomport_18959331_actual) != "0x1"
    tags:
      - dontallowcomport
      - 18.9.59.3.3.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the dontallowcomport file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\dontallowcomport_18959331.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).dontallowcomport_18959331_actual}}'
    when: ((database.stdout_lines[1]|from_json).dontallowcomport_18959331_actual) != "0x1" and ((database.stdout_lines[1]|from_json).dontallowcomport_18959331_actual) != "DELETE"
    tags:
      - dontallowcomport
      - 18.9.59.3.3.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the dontallowcomport file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\dontallowcomport_18959331.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).dontallowcomport_18959331_actual) == "DELETE"
    tags:
      - dontallowcomport
      - 18.9.59.3.3.1
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\dontallowcomport_18959331.txt'
    when: ((database.stdout_lines[1]|from_json).dontallowcomport_18959331_actual) != "0x1"
    tags:
      - dontallowcomport
      - 18.9.59.3.3.1
      - eighteen
      - all
      - rollback
      
  - name: copying dontallowdrive file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/dontallowdrive_18959332.txt
      dest: C:\facts\policyfiles\dontallowdrive_18959332.txt
    when: ((database.stdout_lines[1]|from_json).dontallowdrive_18959332_actual) != "0x1"
    tags:
      - dontallowdrive
      - 18.9.59.3.3.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the dontallowdrive file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\dontallowdrive_18959332.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).dontallowdrive_18959332_actual}}'
    when: ((database.stdout_lines[1]|from_json).dontallowdrive_18959332_actual) != "0x1" and ((database.stdout_lines[1]|from_json).dontallowdrive_18959332_actual) != "DELETE"
    tags:
      - dontallowdrive
      - 18.9.59.3.3.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the dontallowdrive file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\dontallowdrive_18959332.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).dontallowdrive_18959332_actual) == "DELETE"
    tags:
      - dontallowdrive
      - 18.9.59.3.3.2
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\dontallowdrive_18959332.txt'
    when: ((database.stdout_lines[1]|from_json).dontallowdrive_18959332_actual) != "0x1"
    tags:
      - dontallowdrive
      - 18.9.59.3.3.2
      - eighteen
      - all
      - rollback
      
  - name: copying dontallowlptport file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/dontallowlptport_18959333.txt
      dest: C:\facts\policyfiles\dontallowlptport_18959333.txt
    when: ((database.stdout_lines[1]|from_json).dontallowlptport_18959333_actual) != "0x1"
    tags:
      - dontallowlptport
      - 18.9.59.3.3.3
      - eighteen
      - all
      - rollback
      
  - name: adding value to the dontallowlptport file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\dontallowlptport_18959333.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).dontallowlptport_18959333_actual}}'
    when: ((database.stdout_lines[1]|from_json).dontallowlptport_18959333_actual) != "0x1" and ((database.stdout_lines[1]|from_json).dontallowlptport_18959333_actual) != "DELETE"
    tags:
      - dontallowlptport
      - 18.9.59.3.3.3
      - eighteen
      - all
      - rollback
      
  - name: adding value to the turnoffkmsclionline file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\dontallowlptport_18959333.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).dontallowlptport_18959333_actual) == "DELETE"
    tags:
      - dontallowlptport
      - 18.9.59.3.3.3
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\dontallowlptport_18959333.txt'
    when: ((database.stdout_lines[1]|from_json).dontallowlptport_18959333_actual) != "0x1"
    tags:
      - dontallowlptport
      - 18.9.59.3.3.3
      - eighteen
      - all
      - rollback
      
  - name: copying dontallowplugplaydev file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/dontallowplugplaydev_18959334.txt
      dest: C:\facts\policyfiles\dontallowplugplaydev_18959334.txt
    when: ((database.stdout_lines[1]|from_json).dontallowplugplaydev_18959334_actual) != "0x1"
    tags:
      - dontallowplugplaydev
      - 18.9.59.3.3.4
      - eighteen
      - all
      - rollback
      
  - name: adding value to the dontallowplugplaydev file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\dontallowplugplaydev_18959334.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).dontallowplugplaydev_18959334_actual}}'
    when: ((database.stdout_lines[1]|from_json).dontallowplugplaydev_18959334_actual) != "0x1" and ((database.stdout_lines[1]|from_json).dontallowplugplaydev_18959334_actual) != "DELETE"
    tags:
      - dontallowplugplaydev
      - 18.9.59.3.3.4
      - eighteen
      - all
      - rollback
      
  - name: adding value to the dontallowplugplaydev file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\dontallowplugplaydev_18959334.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).dontallowplugplaydev_18959334_actual) == "DELETE"
    tags:
      - dontallowplugplaydev
      - 18.9.59.3.3.4
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\dontallowplugplaydev_18959334.txt'
    when: ((database.stdout_lines[1]|from_json).dontallowplugplaydev_18959334_actual) != "0x1"
    tags:
      - dontallowplugplaydev
      - 18.9.59.3.3.4
      - eighteen
      - all
      - rollback
      
  - name: copying pwdprompt file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/pwdprompt_18959391.txt
      dest: C:\facts\policyfiles\pwdprompt_18959391.txt
    when: ((database.stdout_lines[1]|from_json).pwdprompt_18959391_actual) != "0x1"
    tags:
      - pwdprompt
      - 18.9.59.3.9.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the pwdprompt file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\pwdprompt_18959391.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).pwdprompt_18959391_actual}}'
    when: ((database.stdout_lines[1]|from_json).pwdprompt_18959391_actual) != "0x1" and ((database.stdout_lines[1]|from_json).pwdprompt_18959391_actual) != "DELETE"
    tags:
      - pwdprompt
      - 18.9.59.3.9.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the pwdprompt file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\pwdprompt_18959391.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).pwdprompt_18959391_actual) == "DELETE"
    tags:
      - pwdprompt
      - 18.9.59.3.9.1
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\pwdprompt_18959391.txt'
    when: ((database.stdout_lines[1]|from_json).pwdprompt_18959391_actual) != "0x1"
    tags:
      - pwdprompt
      - 18.9.59.3.9.1
      - eighteen
      - all
      - rollback
      
  - name: copying securerpccommunic file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/securerpccommunic_18959392.txt
      dest: C:\facts\policyfiles\securerpccommunic_18959392.txt
    when: ((database.stdout_lines[1]|from_json).securerpccommunic_18959392_actual) != "0x1"
    tags:
      - securerpccommunic
      - 18.9.59.3.9.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the securerpccommunic file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\securerpccommunic_18959392.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).securerpccommunic_18959392_actual}}'
    when: ((database.stdout_lines[1]|from_json).securerpccommunic_18959392_actual) != "0x1" and ((database.stdout_lines[1]|from_json).securerpccommunic_18959392_actual) != "DELETE"
    tags:
      - securerpccommunic
      - 18.9.59.3.9.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the securerpccommunic file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\securerpccommunic_18959392.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).securerpccommunic_18959392_actual) == "DELETE"
    tags:
      - securerpccommunic
      - 18.9.59.3.9.2
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\securerpccommunic_18959392.txt'
    when: ((database.stdout_lines[1]|from_json).securerpccommunic_18959392_actual) != "0x1"
    tags:
      - securerpccommunic
      - 18.9.59.3.9.2
      - eighteen
      - all
      - rollback
      
  - name: copying enablerdpssl file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/enablerdpssl_18959393.txt
      dest: C:\facts\policyfiles\enablerdpssl_18959393.txt
    when: ((database.stdout_lines[1]|from_json).enablerdpssl_18959393_actual) != "0x2"
    tags:
      - enablerdpssl
      - 18.9.59.3.9.3
      - eighteen
      - all
      - rollback
      
  - name: adding value to the enablerdpssl file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\enablerdpssl_18959393.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).enablerdpssl_18959393_actual}}'
    when: ((database.stdout_lines[1]|from_json).enablerdpssl_18959393_actual) != "0x2" and ((database.stdout_lines[1]|from_json).enablerdpssl_18959393_actual) != "DELETE"
    tags:
      - enablerdpssl
      - 18.9.59.3.9.3
      - eighteen
      - all
      - rollback
      
  - name: adding value to the enablerdpssl file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\enablerdpssl_18959393.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).enablerdpssl_18959393_actual) == "DELETE"
    tags:
      - enablerdpssl
      - 18.9.59.3.9.3
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\enablerdpssl_18959393.txt'
    when: ((database.stdout_lines[1]|from_json).enablerdpssl_18959393_actual) != "0x2"
    tags:
      - enablerdpssl
      - 18.9.59.3.9.3
      - eighteen
      - all
      - rollback
      
  - name: copying ennetlevelauth file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/ennetlevelauth_18959394.txt
      dest: C:\facts\policyfiles\ennetlevelauth_18959394.txt
    when: ((database.stdout_lines[1]|from_json).ennetlevelauth_18959394_actual) != "0x1"
    tags:
      - ennetlevelauth
      - 18.9.59.3.9.4
      - eighteen
      - all
      - rollback
      
  - name: adding value to the ennetlevelauth file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\ennetlevelauth_18959394.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).ennetlevelauth_18959394_actual}}'
    when: ((database.stdout_lines[1]|from_json).ennetlevelauth_18959394_actual) != "0x1" and ((database.stdout_lines[1]|from_json).ennetlevelauth_18959394_actual) != "DELETE"
    tags:
      - ennetlevelauth
      - 18.9.59.3.9.4
      - eighteen
      - all
      - rollback
      
  - name: adding value to the ennetlevelauth file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\ennetlevelauth_18959394.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).ennetlevelauth_18959394_actual) == "DELETE"
    tags:
      - ennetlevelauth
      - 18.9.59.3.9.4
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\ennetlevelauth_18959394.txt'
    when: ((database.stdout_lines[1]|from_json).ennetlevelauth_18959394_actual) != "0x1"
    tags:
      - ennetlevelauth
      - 18.9.59.3.9.4
      - eighteen
      - all
      - rollback
      
  - name: copying setclientconn file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/setclientconn_18959395.txt
      dest: C:\facts\policyfiles\setclientconn_18959395.txt
    when: ((database.stdout_lines[1]|from_json).setclientconn_18959395_actual) != "0x3"
    tags:
      - setclientconn
      - 18.9.59.3.9.5
      - eighteen
      - all
      - rollback
      
  - name: adding value to the setclientconn file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\setclientconn_18959395.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).setclientconn_18959395_actual}}'
    when: ((database.stdout_lines[1]|from_json).setclientconn_18959395_actual) != "0x3" and ((database.stdout_lines[1]|from_json).setclientconn_18959395_actual) != "DELETE"
    tags:
      - setclientconn
      - 18.9.59.3.9.5
      - eighteen
      - all
      - rollback
      
  - name: adding value to the setclientconn file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\setclientconn_18959395.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).setclientconn_18959395_actual) == "DELETE"
    tags:
      - setclientconn
      - 18.9.59.3.9.5
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\setclientconn_18959395.txt'
    when: ((database.stdout_lines[1]|from_json).setclientconn_18959395_actual) != "0x3"
    tags:
      - setclientconn
      - 18.9.59.3.9.5
      - eighteen
      - all
      - rollback
      
  - name: copying timelimitactive file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/timelimitactive_189593101.txt
      dest: C:\facts\policyfiles\timelimitactive_189593101.txt
    when: ((database.stdout_lines[1]|from_json).timelimitactive_189593101_actual) != "0xdbba0"
    tags:
      - timelimitactive
      - 18.9.59.3.10.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the timelimitactive file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\timelimitactive_189593101.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).timelimitactive_189593101_actual}}'
    when: ((database.stdout_lines[1]|from_json).timelimitactive_189593101_actual) != "0xdbba0" and ((database.stdout_lines[1]|from_json).timelimitactive_189593101_actual) != "DELETE"
    tags:
      - timelimitactive
      - 18.9.59.3.10.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the timelimitactive file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\timelimitactive_189593101.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).timelimitactive_189593101_actual) == "DELETE"
    tags:
      - timelimitactive
      - 18.9.59.3.10.1
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\timelimitactive_189593101.txt'
    when: ((database.stdout_lines[1]|from_json).timelimitactive_189593101_actual) != "0xdbba0"
    tags:
      - timelimitactive
      - 18.9.59.3.10.1
      - eighteen
      - all
      - rollback
      
  - name: copying timelimitdisconsession file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/timelimitdisconsession_189593102.txt
      dest: C:\facts\policyfiles\timelimitdisconsession_189593102.txt
    when: ((database.stdout_lines[1]|from_json).timelimitdisconsession_189593102_actual) != "0xea60"
    tags:
      - timelimitdisconsession
      - 18.9.59.3.10.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the timelimitdisconsession file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\timelimitdisconsession_189593102.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).timelimitdisconsession_189593102_actual}}'
    when: ((database.stdout_lines[1]|from_json).timelimitdisconsession_189593102_actual) != "0xea60" and ((database.stdout_lines[1]|from_json).timelimitdisconsession_189593102_actual) != "DELETE"
    tags:
      - timelimitdisconsession
      - 18.9.59.3.10.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the timelimitdisconsession file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\timelimitdisconsession_189593102.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).timelimitdisconsession_189593102_actual) == "DELETE"
    tags:
      - timelimitdisconsession
      - 18.9.59.3.10.2
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\timelimitdisconsession_189593102.txt'
    when: ((database.stdout_lines[1]|from_json).timelimitdisconsession_189593102_actual) != "0xea60"
    tags:
      - timelimitdisconsession
      - 18.9.59.3.10.2
      - eighteen
      - all
      - rollback
      
  - name: copying dontdeltempfolder file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/dontdeltempfolder_189593111.txt
      dest: C:\facts\policyfiles\dontdeltempfolder_189593111.txt
    when: ((database.stdout_lines[1]|from_json).dontdeltempfolder_189593111_actual) != "0x1"
    tags:
      - dontdeltempfolder
      - 18.9.59.3.11.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the dontdeltempfolder file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\dontdeltempfolder_189593111.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).dontdeltempfolder_189593111_actual}}'
    when: ((database.stdout_lines[1]|from_json).dontdeltempfolder_189593111_actual) != "0x1" and ((database.stdout_lines[1]|from_json).dontdeltempfolder_189593111_actual) != "DELETE"
    tags:
      - dontdeltempfolder
      - 18.9.59.3.11.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the dontdeltempfolder file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\dontdeltempfolder_189593111.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).dontdeltempfolder_189593111_actual) == "DELETE"
    tags:
      - dontdeltempfolder
      - 18.9.59.3.11.1
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\dontdeltempfolder_189593111.txt'
    when: ((database.stdout_lines[1]|from_json).dontdeltempfolder_189593111_actual) != "0x1"
    tags:
      - dontdeltempfolder
      - 18.9.59.3.11.1
      - eighteen
      - all
      - rollback
      
  - name: copying dontusetempfolder file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/dontusetempfolder_189593112.txt
      dest: C:\facts\policyfiles\dontusetempfolder_189593112.txt
    when: ((database.stdout_lines[1]|from_json).dontusetempfolder_189593112_actual) != "0x1"
    tags:
      - dontusetempfolder
      - 18.9.59.3.11.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the dontusetempfolder file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\dontusetempfolder_189593112.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).dontusetempfolder_189593112_actual}}'
    when: ((database.stdout_lines[1]|from_json).dontusetempfolder_189593112_actual) != "0x1" and ((database.stdout_lines[1]|from_json).dontusetempfolder_189593112_actual) != "DELETE"
    tags:
      - dontusetempfolder
      - 18.9.59.3.11.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the dontusetempfolder file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\dontusetempfolder_189593112.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).dontusetempfolder_189593112_actual) == "DELETE"
    tags:
      - dontusetempfolder
      - 18.9.59.3.11.2
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\dontusetempfolder_189593112.txt'
    when: ((database.stdout_lines[1]|from_json).dontusetempfolder_189593112_actual) != "0x1"
    tags:
      - dontusetempfolder
      - 18.9.59.3.11.2
      - eighteen
      - all
      - rollback
      
  - name: copying preventdownload file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/preventdownload_189601.txt
      dest: C:\facts\policyfiles\preventdownload_189601.txt
    when: ((database.stdout_lines[1]|from_json).preventdownload_189601_actual) != "0x1"
    tags:
      - preventdownload
      - 18.9.60.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the preventdownload file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\preventdownload_189601.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).preventdownload_189601_actual}}'
    when: ((database.stdout_lines[1]|from_json).preventdownload_189601_actual) != "0x1" and ((database.stdout_lines[1]|from_json).preventdownload_189601_actual) != "DELETE"
    tags:
      - preventdownload
      - 18.9.60.1
      - eighteen
      - all
      - rollback
      
  - name: adding value to the preventdownload file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\preventdownload_189601.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).preventdownload_189601_actual) == "DELETE"
    tags:
      - preventdownload
      - 18.9.60.1
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\preventdownload_189601.txt'
    when: ((database.stdout_lines[1]|from_json).preventdownload_189601_actual) != "0x1"
    tags:
      - preventdownload
      - 18.9.60.1
      - eighteen
      - all
      - rollback
      
  - name: copying allowcloudsearch file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/allowcloudsearch_189612.txt
      dest: C:\facts\policyfiles\allowcloudsearch_189612.txt
    when: ((database.stdout_lines[1]|from_json).allowcloudsearch_189612_actual) != "0x4"
    tags:
      - allowcloudsearch
      - 18.9.61.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the allowcloudsearch file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\allowcloudsearch_189612.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).allowcloudsearch_189612_actual}}'
    when: ((database.stdout_lines[1]|from_json).allowcloudsearch_189612_actual) != "0x4" and ((database.stdout_lines[1]|from_json).allowcloudsearch_189612_actual) != "DELETE"
    tags:
      - allowcloudsearch
      - 18.9.61.2
      - eighteen
      - all
      - rollback
      
  - name: adding value to the allowcloudsearch file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\allowcloudsearch_189612.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).allowcloudsearch_189612_actual) == "DELETE"
    tags:
      - allowcloudsearch
      - 18.9.61.2
      - eighteen
      - all
      - rollback
      
  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\allowcloudsearch_189612.txt'
    when: ((database.stdout_lines[1]|from_json).allowcloudsearch_189612_actual) != "0x4"
    tags:
      - allowcloudsearch
      - 18.9.61.2
      - eighteen
      - all
      - rollback

  - name: copying turnoffkmsclionline file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnoffkmsclionline_189661.txt
      dest: C:\facts\policyfiles\turnoffkmsclionline_189661.txt
    when: ((database.stdout_lines[1]|from_json).turnoffkmsclionline_189661_actual) != "0x1" 
    tags:
      - turnoffkmsclionline
      - 18.9.66.1
      - eighteen
      - all
      - rollback

  - name: adding value to the turnoffkmsclionline file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffkmsclionline_189661.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnoffkmsclionline_189661_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnoffkmsclionline_189661_actual) != "0x1" and ((database.stdout_lines[1]|from_json).turnoffkmsclionline_189661_actual) != "DELETE"
    tags:
      - turnoffkmsclionline
      - 18.9.66.1
      - eighteen
      - all
      - rollback

  - name: adding value to the turnoffkmsclionline file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffkmsclionline_189661.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnoffkmsclionline_189661_actual) == "DELETE"
    tags:
      - turnoffkmsclionline
      - 18.9.66.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffkmsclionline_189661.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffkmsclionline_189661_actual) != "0x1"
    tags:
      - turnoffkmsclionline
      - 18.9.66.1
      - eighteen
      - all
      - rollback

  - name: copying confmsmaps file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/confmsmaps_1897731.txt
      dest: C:\facts\policyfiles\confmsmaps_1897731.txt
    when: ((database.stdout_lines[1]|from_json).confmsmaps_1897731_actual) != "0x0"
    tags:
      - confmsmaps
      - 18.9.77.3.1
      - eighteen
      - all
      - rollback

  - name: adding value to the confmsmaps file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confmsmaps_1897731.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).confmsmaps_1897731_actual}}'
    when: ((database.stdout_lines[1]|from_json).confmsmaps_1897731_actual) != "0x0" and ((database.stdout_lines[1]|from_json).confmsmaps_1897731_actual) != "DELETE"
    tags:
      - confmsmaps
      - 18.9.77.3.1
      - eighteen
      - all
      - rollback

  - name: adding value to the confmsmaps file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confmsmaps_1897731.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).confmsmaps_1897731_actual) == "DELETE"
    tags:
      - confmsmaps
      - 18.9.77.3.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\confmsmaps_1897731.txt'
    when: ((database.stdout_lines[1]|from_json).confmsmaps_1897731_actual) != "0x1"
    tags:
      - confmsmaps
      - 18.9.77.3.1
      - eighteen
      - all
      - rollback

  - name: copying joinmsmaps file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/joinmsmaps_1897732.txt
      dest: C:\facts\policyfiles\joinmsmaps_1897732.txt
    when: ((database.stdout_lines[1]|from_json).joinmsmaps_1897732_actual) != "0x0"
    tags:
      - joinmsmaps
      - 18.9.77.3.2
      - eighteen
      - all
      - rollback

  - name: adding value to the joinmsmaps file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\joinmsmaps_1897732.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).joinmsmaps_1897732_actual}}'
    when: ((database.stdout_lines[1]|from_json).joinmsmaps_1897732_actual) != "0x0" and ((database.stdout_lines[1]|from_json).joinmsmaps_1897732_actual) != "DELETE"
    tags:
      - joinmsmaps
      - 18.9.77.3.2
      - eighteen
      - all
      - rollback

  - name: adding value to the joinmsmaps file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\joinmsmaps_1897732.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).joinmsmaps_1897732_actual) == "DELETE"
    tags:
      - joinmsmaps
      - 18.9.77.3.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\joinmsmaps_1897732.txt'
    when: ((database.stdout_lines[1]|from_json).joinmsmaps_1897732_actual) != "0x0"
    tags:
      - joinmsmaps
      - 18.9.77.3.2
      - eighteen
      - all
      - rollback

  - name: copying turnonmonitoring file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnonmonitoring_1897771.txt
      dest: C:\facts\policyfiles\turnonmonitoring_1897771.txt
    when: ((database.stdout_lines[1]|from_json).turnonmonitoring_1897771_actual) != "0x0"
    tags:
      - turnonmonitoring
      - 18.9.77.7.1
      - eighteen
      - all
      - rollback

  - name: adding value to the turnonmonitoring file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnonmonitoring_1897771.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnonmonitoring_1897771_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnonmonitoring_1897771_actual) != "0x0" and ((database.stdout_lines[1]|from_json).turnonmonitoring_1897771_actual) != "DELETE"
    tags:
      - turnonmonitoring
      - 18.9.77.7.1
      - eighteen
      - all
      - rollback

  - name: adding value to the turnonmonitoring file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnonmonitoring_1897771.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnonmonitoring_1897771_actual) == "DELETE"
    tags:
      - turnonmonitoring
      - 18.9.77.7.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnonmonitoring_1897771.txt'
    when: ((database.stdout_lines[1]|from_json).turnonmonitoring_1897771_actual) != "0x0"
    tags:
      - turnonmonitoring
      - 18.9.77.7.1
      - eighteen
      - all
      - rollback

  - name: copying confwatsonevents file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/confwatsonevents_1897791.txt
      dest: C:\facts\policyfiles\confwatsonevents_1897791.txt
    when: ((database.stdout_lines[1]|from_json).confwatsonevents_1897791_actual) != "0x1"
    tags:
      - confwatsonevents
      - 18.9.77.9.1
      - eighteen
      - all
      - rollback

  - name: adding value to the confwatsonevents file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confwatsonevents_1897791.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).confwatsonevents_1897791_actual}}'
    when: ((database.stdout_lines[1]|from_json).confwatsonevents_1897791_actual) != "0x1" and ((database.stdout_lines[1]|from_json).confwatsonevents_1897791_actual) != "DELETE"
    tags:
      - confwatsonevents
      - 18.9.77.9.1
      - eighteen
      - all
      - rollback

  - name: adding value to the confwatsonevents file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confwatsonevents_1897791.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).confwatsonevents_1897791_actual) == "DELETE"
    tags:
      - confwatsonevents
      - 18.9.77.9.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\confwatsonevents_1897791.txt'
    when: ((database.stdout_lines[1]|from_json).confwatsonevents_1897791_actual) != "0x1"
    tags:
      - confwatsonevents
      - 18.9.77.9.1
      - eighteen
      - all
      - rollback

  - name: copying scanremovabledriver file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/scanremovabledriver_18977101.txt
      dest: C:\facts\policyfiles\scanremovabledriver_18977101.txt
    when: ((database.stdout_lines[1]|from_json).scanremovabledriver_18977101_actual) != "0x0"
    tags:
      - scanremovabledriver
      - 18.9.77.10.1
      - eighteen
      - all
      - rollback

  - name: adding value to the scanremovabledriver file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\scanremovabledriver_18977101.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).scanremovabledriver_18977101_actual}}'
    when: ((database.stdout_lines[1]|from_json).scanremovabledriver_18977101_actual) != "0x0" and ((database.stdout_lines[1]|from_json).scanremovabledriver_18977101_actual) != "DELETE"
    tags:
      - scanremovabledriver
      - 18.9.77.10.1
      - eighteen
      - all
      - rollback

  - name: adding value to the scanremovabledriver file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\scanremovabledriver_18977101.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).scanremovabledriver_18977101_actual) == "DELETE"
    tags:
      - scanremovabledriver
      - 18.9.77.10.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\scanremovabledriver_18977101.txt'
    when: ((database.stdout_lines[1]|from_json).scanremovabledriver_18977101_actual) != "0x0"
    tags:
      - scanremovabledriver
      - 18.9.77.10.1
      - eighteen
      - all
      - rollback

  - name: copying turnonemailscan file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnonemailscan_18977102.txt
      dest: C:\facts\policyfiles\turnonemailscan_18977102.txt
    when: ((database.stdout_lines[1]|from_json).turnonemailscan_18977102_actual) != "0x0"
    tags:
      - turnonemailscan
      - 18.9.77.10.2
      - eighteen
      - all
      - rollback

  - name: adding value to the turnonemailscan file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnonemailscan_18977102.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).turnonemailscan_18977102_actual}}'
    when: ((database.stdout_lines[1]|from_json).turnonemailscan_18977102_actual) != "0x0" and ((database.stdout_lines[1]|from_json).turnonemailscan_18977102_actual) != "DELETE"
    tags:
      - turnonemailscan
      - 18.9.77.10.2
      - eighteen
      - all
      - rollback

  - name: adding value to the turnonemailscan file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnonemailscan_18977102.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).turnonemailscan_18977102_actual) == "DELETE"
    tags:
      - turnonemailscan
      - 18.9.77.10.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnonemailscan_18977102.txt'
    when: ((database.stdout_lines[1]|from_json).turnonemailscan_18977102_actual) != "0x0"
    tags:
      - turnonemailscan
      - 18.9.77.10.2
      - eighteen
      - all
      - rollback

  - name: copying confasrrule file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/confasrrule_189771311.txt
      dest: C:\facts\policyfiles\confasrrule_189771311.txt
    when: ((database.stdout_lines[1]|from_json).confasrrule_189771311_actual) != "0x1"
    tags:
      - confasrrule
      - 18.9.77.13.1.1
      - eighteen
      - all
      - rollback

  - name: adding value to the confasrrule file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confasrrule_189771311.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).confasrrule_189771311_actual}}'
    when: ((database.stdout_lines[1]|from_json).confasrrule_189771311_actual) != "0x1" and ((database.stdout_lines[1]|from_json).confasrrule_189771311_actual) != "DELETE"
    tags:
      - confasrrule
      - 18.9.77.13.1.1
      - eighteen
      - all
      - rollback

  - name: adding value to the confasrrule file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confasrrule_189771311.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).confasrrule_189771311_actual) == "DELETE"
    tags:
      - confasrrule
      - 18.9.77.13.1.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\confasrrule_189771311.txt'
    when: ((database.stdout_lines[1]|from_json).confasrrule_189771311_actual) != "0x1"
    tags:
      - confasrrule
      - 18.9.77.13.1.1
      - eighteen
      - all
      - rollback

  - name: copying setasrrule file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/setasrrule_189771312.txt
      dest: C:\facts\policyfiles\setasrrule_189771312.txt
    when: ((database.stdout_lines[1]|from_json).setasrrule_189771312_actual) != "1 1 1 1 1 1 1 1 1 1 1"
    tags:
      - setasrrule
      - 18.9.77.13.1.2
      - eighteen
      - all
      - rollback

  - name: adding value to the setasrrule file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\setasrrule_189771312.txt
       regex: '{{ item.regex }}'
       line: '{{ item.line }}'
    with_items:
      - { regex: "^(26190899-1602-49e8-8b27-eb1d0a1ce869 )", line: "26190899-1602-49e8-8b27-eb1d0a1ce869\nDELETE" }
      - { regex: "^(3b576869-a4ec-4529-8536-b80a7769e899 )", line: "3b576869-a4ec-4529-8536-b80a7769e899\nDELETE" }
      - { regex: "^(5beb7efe-fd9a-4556-801d-275e5ffc04cc )", line: "5beb7efe-fd9a-4556-801d-275e5ffc04cc\nDELETE" }
      - { regex: "^(75668c1f-73b5-4cf0-bb93-3ecf5cb7cc84 )", line: "75668c1f-73b5-4cf0-bb93-3ecf5cb7cc84\nDELETE" }
      - { regex: "^(7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c )", line: "7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c\nDELETE" }
      - { regex: "^(92e97fa1-2edf-4476-bdd6-9dd0b4dddc7b )", line: "92e97fa1-2edf-4476-bdd6-9dd0b4dddc7b\nDELETE" }
      - { regex: "^(9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2 )", line: "9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2\nDELETE" }
      - { regex: "^(b2b3f03d-6a65-4f7b-a9c7-1c7ef74a9ba4 )", line: "b2b3f03d-6a65-4f7b-a9c7-1c7ef74a9ba4\nDELETE" }
      - { regex: "^(be9ba2d9-53ea-4cdc-84e5-9b1eeee46550 )", line: "be9ba2d9-53ea-4cdc-84e5-9b1eeee46550\nDELETE" }
      - { regex: "^(d3e037e1-3eb8-44c8-a917-57927947596d )", line: "d3e037e1-3eb8-44c8-a917-57927947596d\nDELETE" }
      - { regex: "^(d4f940ab-401b-4efc-aadc-ad5f3c50688a )", line: "d4f940ab-401b-4efc-aadc-ad5f3c50688a\nDELETE" }
    when: ((database.stdout_lines[1]|from_json).setasrrule_189771312_actual) != "1 1 1 1 1 1 1 1 1 1 1" and ((database.stdout_lines[1]|from_json).setasrrule_189771312_actual) != "DELETE"
    tags:
      - setasrrule
      - 18.9.77.13.1.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: '{{ item }}'
    with_items:
      - 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\setasrrule_189771312.txt'
      - 'Clear-Content C:\facts\policyfiles\setasrrule_189771312.txt'
    when: ((database.stdout_lines[1]|from_json).setasrrule_189771312_actual) != "1 1 1 1 1 1 1 1 1 1 1" and ((database.stdout_lines[1]|from_json).setasrrule_189771312_actual) != "DELETE"
    tags:
      - setasrrule
      - 18.9.77.13.1.2
      - eighteen
      - all
      - rollback

  - name: storing in register
    debug: msg={{ (database.stdout_lines[1]|from_json).setasrrule_189771312_actual.split(',') }}
    when: ((database.stdout_lines[1]|from_json).setasrrule_189771312_actual) != "1 1 1 1 1 1 1 1 1 1 1"
    register: setasrrule_roll
    tags:
      - setasrrule
      - 18.9.77.13.1.2
      - eighteen
      - all
      - rollback

  - name: adding value to the setasrrule file for rollback
    win_shell: | 
        Add-Content -Path "C:\facts\policyfiles\setasrrule_189771312.txt" -Value "`r`nComputer`r`nSoftware\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules`r`n{{ item.split('  ')[0] }}`r`nSZ:{{ item.split('  ')[1] }}"
    loop: "{{ setasrrule_roll.msg }}"
    when: ((database.stdout_lines[1]|from_json).setasrrule_189771312_actual) != "1 1 1 1 1 1 1 1 1 1 1" and ((database.stdout_lines[1]|from_json).setasrrule_189771312_actual) != "DELETE"
    tags:
      - setasrrule
      - 18.9.77.13.1.2
      - eighteen
      - all
      - rollback

  - name: adding value to the confasrrule file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\setasrrule_189771312.txt
       regex: '{{ item.regex }}'
       line: '{{ item.line }}'
    with_items:
      - { regex: "^(26190899-1602-49e8-8b27-eb1d0a1ce869 )", line: "26190899-1602-49e8-8b27-eb1d0a1ce869\nDELETE" }
      - { regex: "^(3b576869-a4ec-4529-8536-b80a7769e899 )", line: "3b576869-a4ec-4529-8536-b80a7769e899\nDELETE" }
      - { regex: "^(5beb7efe-fd9a-4556-801d-275e5ffc04cc )", line: "5beb7efe-fd9a-4556-801d-275e5ffc04cc\nDELETE" }
      - { regex: "^(75668c1f-73b5-4cf0-bb93-3ecf5cb7cc84 )", line: "75668c1f-73b5-4cf0-bb93-3ecf5cb7cc84\nDELETE" }
      - { regex: "^(7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c )", line: "7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c\nDELETE" }
      - { regex: "^(92e97fa1-2edf-4476-bdd6-9dd0b4dddc7b )", line: "92e97fa1-2edf-4476-bdd6-9dd0b4dddc7b\nDELETE" }
      - { regex: "^(9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2 )", line: "9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2\nDELETE" }
      - { regex: "^(b2b3f03d-6a65-4f7b-a9c7-1c7ef74a9ba4 )", line: "b2b3f03d-6a65-4f7b-a9c7-1c7ef74a9ba4\nDELETE" }
      - { regex: "^(be9ba2d9-53ea-4cdc-84e5-9b1eeee46550 )", line: "be9ba2d9-53ea-4cdc-84e5-9b1eeee46550\nDELETE" }
      - { regex: "^(d3e037e1-3eb8-44c8-a917-57927947596d )", line: "d3e037e1-3eb8-44c8-a917-57927947596d\nDELETE" }
      - { regex: "^(d4f940ab-401b-4efc-aadc-ad5f3c50688a )", line: "d4f940ab-401b-4efc-aadc-ad5f3c50688a\nDELETE" }
    when: ((database.stdout_lines[1]|from_json).setasrrule_189771312_actual) == "DELETE"
    tags:
      - setasrrule
      - 18.9.77.13.1.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\setasrrule_189771312.txt'
    when: ((database.stdout_lines[1]|from_json).setasrrule_189771312_actual) != "1 1 1 1 1 1 1 1 1 1 1"
    tags:
      - setasrrule
      - 18.9.77.13.1.2
      - eighteen
      - all
      - rollback

  - name: copying preventusrapps file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/preventusrapps_189771331.txt
      dest: C:\facts\policyfiles\preventusrapps_189771331.txt
    when: ((database.stdout_lines[1]|from_json).preventusrapps_189771331_actual) != "0x1"
    tags:
      - preventusrapps
      - 18.9.77.13.3.1
      - eighteen
      - all
      - rollback

  - name: adding value to the preventusrapps file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\preventusrapps_189771331.txt
       regex: "^(DWORD:*)"
       line: "DWORD:{{ (database.stdout_lines[1]|from_json).preventusrapps_189771331_actual }}"
    when: ((database.stdout_lines[1]|from_json).preventusrapps_189771331_actual) != "0x1" and ((database.stdout_lines[1]|from_json).preventusrapps_189771331_actual) != "DELETE"
    tags:
      - preventusrapps
      - 18.9.77.13.3.1
      - eighteen
      - all
      - rollback

  - name: adding value to the preventusrapps file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\preventusrapps_189771331.txt
       regex: "^(DWORD:*)"
       line: "DELETE"
    when: ((database.stdout_lines[1]|from_json).preventusrapps_189771331_actual) == "DELETE"
    tags:
      - preventusrapps
      - 18.9.77.13.3.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\preventusrapps_189771331.txt'
    when: ((database.stdout_lines[1]|from_json).preventusrapps_189771331_actual) != "0x1"
    tags:
      - preventusrapps
      - 18.9.77.13.3.1
      - eighteen
      - all
      - rollback

  - name: copying confdetectunwanapp file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/confdetectunwanapp_1897714.txt
      dest: C:\facts\policyfiles\confdetectunwanapp_1897714.txt
    when: ((database.stdout_lines[1]|from_json).confdetectunwanapp_1897714_actual) != "0x1"
    tags:
      - confdetectunwanapp
      - 18.9.77.14
      - eighteen
      - all
      - rollback

  - name: adding value to the confdetectunwanapp file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confdetectunwanapp_1897714.txt
       regex: "^(DWORD:*)"
       line: "DWORD:{{ (database.stdout_lines[1]|from_json).confdetectunwanapp_1897714_actual }}"
    when: ((database.stdout_lines[1]|from_json).confdetectunwanapp_1897714_actual) != "0x1" and ((database.stdout_lines[1]|from_json).confdetectunwanapp_1897714_actual) != "DELETE"
    tags:
      - confdetectunwanapp
      - 18.9.77.14
      - eighteen
      - all
      - rollback

  - name: adding value to the confdetectunwanapp file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confdetectunwanapp_1897714.txt
       regex: "^(DWORD:*)"
       line: "DELETE"
    when: ((database.stdout_lines[1]|from_json).confdetectunwanapp_1897714_actual) == "DELETE"
    tags:
      - confdetectunwanapp
      - 18.9.77.14
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\confdetectunwanapp_1897714.txt'
    when: ((database.stdout_lines[1]|from_json).confdetectunwanapp_1897714_actual) != "0x1"
    tags:
      - confdetectunwanapp
      - 18.9.77.14
      - eighteen
      - all
      - rollback

  - name: copying turnoffwindefenderantivirus file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/turnoffwindefenderantivirus_1897715.txt
      dest: C:\facts\policyfiles\turnoffwindefenderantivirus_1897715.txt
    when: ((database.stdout_lines[1]|from_json).turnoffwindefenderantivirus_1897715_actual) != "0x0"
    tags:
      - turnoffwindefenderantivirus
      - 18.9.77.15
      - eighteen
      - all
      - rollback

  - name: adding value to the turnoffwindefenderantivirus file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffwindefenderantivirus_1897715.txt
       regex: "^(DWORD:*)"
       line: "DWORD:{{ (database.stdout_lines[1]|from_json).turnoffwindefenderantivirus_1897715_actual }}"
    when: ((database.stdout_lines[1]|from_json).turnoffwindefenderantivirus_1897715_actual) != "0x0" and ((database.stdout_lines[1]|from_json).turnoffwindefenderantivirus_1897715_actual) != "DELETE"
    tags:
      - turnoffwindefenderantivirus
      - 18.9.77.15
      - eighteen
      - all
      - rollback

  - name: adding value to the turnoffwindefenderantivirus file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\turnoffwindefenderantivirus_1897715.txt
       regex: "^(DWORD:*)"
       line: "DELETE"
    when: ((database.stdout_lines[1]|from_json).turnoffwindefenderantivirus_1897715_actual) == "DELETE"
    tags:
      - turnoffwindefenderantivirus
      - 18.9.77.15
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\turnoffwindefenderantivirus_1897715.txt'
    when: ((database.stdout_lines[1]|from_json).turnoffwindefenderantivirus_1897715_actual) != "0x0"
    tags:
      - turnoffwindefenderantivirus
      - 18.9.77.15
      - eighteen
      - all
      - rollback

  - name: copying confwindefendsmartscreen file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/confwindefendsmartscreen_1898011.txt
      dest: C:\facts\policyfiles\confwindefendsmartscreen_1898011.txt
    when: ((database.stdout_lines[1]|from_json).confwindefendsmartscreen_1898011_actual) != "0x1 Block"
    tags:
      - confwindefendsmartscreen
      - 18.9.80.1.1
      - eighteen
      - all
      - rollback

  - name: adding values to the confwindefendsmartscreen file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confwindefendsmartscreen_1898011.txt
       regex: '{{ item.regex }}'
       line: '{{ item.line }}'
    with_items:
      - { regex: "^(EnableSmartScreen )", line: "EnableSmartScreen\nDWORD:{{ (database.stdout_lines[1]|from_json).confwindefendsmartscreen_1898011_actual.split(' ')[0] }}" }
      - { regex: "^(ShellSmartScreenLevel )", line: "ShellSmartScreenLevel\nSZ:{{ (database.stdout_lines[1]|from_json).confwindefendsmartscreen_1898011_actual.split(' ')[1] }}" }
    when: ((database.stdout_lines[1]|from_json).confwindefendsmartscreen_1898011_actual) != "0x1 Block" and ((database.stdout_lines[1]|from_json).confwindefendsmartscreen_1898011_actual) != "DELETE"
    tags:
      - confwindefendsmartscreen
      - 18.9.80.1.1
      - eighteen
      - all
      - rollback

  - name: adding delete to the confwindefendsmartscreen file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confwindefendsmartscreen_1898011.txt
       regex: '{{ item.regex }}'
       line: '{{ item.line }}'
    with_items:
      - { regex: "^(EnableSmartScreen )", line: "EnableSmartScreen\nDELETE" }
      - { regex: "^(ShellSmartScreenLevel )", line: "ShellSmartScreenLevel\nDELETE" }
    when: ((database.stdout_lines[1]|from_json).confwindefendsmartscreen_1898011_actual) == "DELETE"
    tags:
      - confwindefendsmartscreen
      - 18.9.80.1.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\confwindefendsmartscreen_1898011.txt'
    when: ((database.stdout_lines[1]|from_json).confwindefendsmartscreen_1898011_actual) != "0x1 Block"
    tags:
      - confwindefendsmartscreen
      - 18.9.80.1.1
      - eighteen
      - all
      - rollback

  - name: copying allowsuggestapps file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/allowsuggestapps_189841.txt
      dest: C:\facts\policyfiles\allowsuggestapps_189841.txt
    when: ((database.stdout_lines[1]|from_json).allowsuggestapps_189841_actual) != "0x0"
    tags:
      - allowsuggestapps
      - 18.9.84.1
      - eighteen
      - all
      - rollback

  - name: adding value to the allowsuggestapps file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\allowsuggestapps_189841.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).allowsuggestapps_189841_actual}}'
    when: ((database.stdout_lines[1]|from_json).allowsuggestapps_189841_actual) != "0x0" and ((database.stdout_lines[1]|from_json).allowsuggestapps_189841_actual) != "DELETE"
    tags:
      - allowsuggestapps
      - 18.9.84.1
      - eighteen
      - all
      - rollback

  - name: adding value to the allowsuggestapps file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\allowsuggestapps_189841.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).allowsuggestapps_189841_actual) == "DELETE"
    tags:
      - allowsuggestapps
      - 18.9.84.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\allowsuggestapps_189841.txt'
    when: ((database.stdout_lines[1]|from_json).allowsuggestapps_189841_actual) != "0x0"
    tags:
      - allowsuggestapps
      - 18.9.84.1
      - eighteen
      - all
      - rollback

  - name: copying allowwininkworkspace file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/allowwininkworkspace_189842.txt
      dest: C:\facts\policyfiles\allowwininkworkspace_189842.txt
    when: ((database.stdout_lines[1]|from_json).allowwininkworkspace_189842_actual) != "0x2" and ((database.stdout_lines[1]|from_json).allowwininkworkspace_189842_actual) != "0x0"
    tags:
      - allowwininkworkspace
      - 18.9.84.2
      - eighteen
      - all
      - rollback

  - name: adding value to the allowwininkworkspace file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\allowwininkworkspace_189842.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).allowwininkworkspace_189842_actual}}'
    when: ((database.stdout_lines[1]|from_json).allowwininkworkspace_189842_actual) != "0x2" and ((database.stdout_lines[1]|from_json).allowwininkworkspace_189842_actual) != "0x0" and ((database.stdout_lines[1]|from_json).allowwininkworkspace_189842_actual) != "DELETE"
    tags:
      - allowwininkworkspace
      - 18.9.84.2
      - eighteen
      - all
      - rollback

  - name: adding value to the allowwininkworkspace file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\allowwininkworkspace_189842.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).allowwininkworkspace_189842_actual) == "DELETE"
    tags:
      - allowwininkworkspace
      - 18.9.84.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\allowwininkworkspace_189842.txt'
    when: ((database.stdout_lines[1]|from_json).allowwininkworkspace_189842_actual) != "0x2" and ((database.stdout_lines[1]|from_json).allowwininkworkspace_189842_actual) != "0x0"
    tags:
      - allowwininkworkspace
      - 18.9.84.2
      - eighteen
      - all
      - rollback

  - name: copying allowusrcontrol file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/allowusrcontrol_189851.txt
      dest: C:\facts\policyfiles\allowusrcontrol_189851.txt
    when: ((database.stdout_lines[1]|from_json).allowusrcontrol_189851_actual) != "0x0"
    tags:
      - allowusrcontrol
      - 18.9.85.1
      - eighteen
      - all
      - rollback

  - name: adding value to the allowusrcontrol file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\allowusrcontrol_189851.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).allowusrcontrol_189851_actual}}'
    when: ((database.stdout_lines[1]|from_json).allowusrcontrol_189851_actual) != "0x0" and ((database.stdout_lines[1]|from_json).allowusrcontrol_189851_actual) != "DELETE"
    tags:
      - allowusrcontrol
      - 18.9.85.1
      - eighteen
      - all
      - rollback

  - name: adding value to the allowusrcontrol file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\allowusrcontrol_189851.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).allowusrcontrol_189851_actual) == "DELETE"
    tags:
      - allowusrcontrol
      - 18.9.85.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\allowusrcontrol_189851.txt'
    when: ((database.stdout_lines[1]|from_json).allowusrcontrol_189851_actual) != "0x0"
    tags:
      - allowusrcontrol
      - 18.9.85.1
      - eighteen
      - all
      - rollback

  - name: copying elevatedprivil file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/elevatedprivil_189852.txt
      dest: C:\facts\policyfiles\elevatedprivil_189852.txt
    when: ((database.stdout_lines[1]|from_json).elevatedprivil_189852_actual) != "0x0"
    tags:
      - elevatedprivil
      - 18.9.85.2
      - eighteen
      - all
      - rollback

  - name: adding value to the elevatedprivil file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\elevatedprivil_189852.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).elevatedprivil_189852_actual}}'
    when: ((database.stdout_lines[1]|from_json).elevatedprivil_189852_actual) != "0x0" and ((database.stdout_lines[1]|from_json).elevatedprivil_189852_actual) != "DELETE"
    tags:
      - elevatedprivil
      - 18.9.85.2
      - eighteen
      - all
      - rollback

  - name: adding value to the elevatedprivil file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\elevatedprivil_189852.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).elevatedprivil_189852_actual) == "DELETE"
    tags:
      - elevatedprivil
      - 18.9.85.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\elevatedprivil_189852.txt'
    when: ((database.stdout_lines[1]|from_json).elevatedprivil_189852_actual) != "0x0"
    tags:
      - elevatedprivil
      - 18.9.85.2
      - eighteen
      - all
      - rollback

  - name: copying previesecurprompt file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/previesecurprompt_189853.txt
      dest: C:\facts\policyfiles\previesecurprompt_189853.txt
    when: ((database.stdout_lines[1]|from_json).previesecurprompt_189853_actual) != "0x0"
    tags:
      - previesecurprompt
      - 18.9.85.3
      - eighteen
      - all
      - rollback

  - name: adding value to the previesecurprompt file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\previesecurprompt_189853.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).previesecurprompt_189853_actual}}'
    when: ((database.stdout_lines[1]|from_json).previesecurprompt_189853_actual) != "0x0" and ((database.stdout_lines[1]|from_json).previesecurprompt_189853_actual) != "DELETE"
    tags:
      - previesecurprompt
      - 18.9.85.3
      - eighteen
      - all
      - rollback

  - name: adding value to the previesecurprompt file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\previesecurprompt_189853.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).previesecurprompt_189853_actual) == "DELETE"
    tags:
      - previesecurprompt
      - 18.9.85.3
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\previesecurprompt_189853.txt'
    when: ((database.stdout_lines[1]|from_json).previesecurprompt_189853_actual) != "0x0"
    tags:
      - previesecurprompt
      - 18.9.85.3
      - eighteen
      - all
      - rollback

  - name: copying signinlastinteractiveusr file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/signinlastinteractiveusr_189861.txt
      dest: C:\facts\policyfiles\signinlastinteractiveusr_189861.txt
    when: ((database.stdout_lines[1]|from_json).signinlastinteractiveusr_189861_actual) != "0x0"
    tags:
      - signinlastinteractiveusr
      - 18.9.86.1
      - eighteen
      - all
      - rollback

  - name: adding value to the signinlastinteractiveusr file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\signinlastinteractiveusr_189861.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).signinlastinteractiveusr_189861_actual}}'
    when: ((database.stdout_lines[1]|from_json).signinlastinteractiveusr_189861_actual) != "0x0" and ((database.stdout_lines[1]|from_json).signinlastinteractiveusr_189861_actual) != "DELETE"
    tags:
      - signinlastinteractiveusr
      - 18.9.86.1
      - eighteen
      - all
      - rollback

  - name: adding value to the signinlastinteractiveusr file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\signinlastinteractiveusr_189861.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).signinlastinteractiveusr_189861_actual) == "DELETE"
    tags:
      - signinlastinteractiveusr
      - 18.9.86.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\signinlastinteractiveusr_189861.txt'
    when: ((database.stdout_lines[1]|from_json).signinlastinteractiveusr_189861_actual) != "0x0"
    tags:
      - signinlastinteractiveusr
      - 18.9.86.1
      - eighteen
      - all
      - rollback

  - name: copying pshellscriptblocklog file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/pshellscriptblocklog_189951.txt
      dest: C:\facts\policyfiles\pshellscriptblocklog_189951.txt
    when: ((database.stdout_lines[1]|from_json).pshellscriptblocklog_189951_actual) != "0x0"
    tags:
      - pshellscriptblocklog
      - 18.9.95.1
      - eighteen
      - all
      - rollback

  - name: adding value to the pshellscriptblocklog file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\pshellscriptblocklog_189951.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).pshellscriptblocklog_189951_actual}}'
    when: ((database.stdout_lines[1]|from_json).pshellscriptblocklog_189951_actual) != "0x0" and ((database.stdout_lines[1]|from_json).pshellscriptblocklog_189951_actual) != "DELETE"
    tags:
      - pshellscriptblocklog
      - 18.9.95.1
      - eighteen
      - all
      - rollback

  - name: adding value to the pshellscriptblocklog file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\pshellscriptblocklog_189951.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).pshellscriptblocklog_189951_actual) == "DELETE"
    tags:
      - pshellscriptblocklog
      - 18.9.95.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\pshellscriptblocklog_189951.txt'
    when: ((database.stdout_lines[1]|from_json).pshellscriptblocklog_189951_actual) != "0x0"
    tags:
      - pshellscriptblocklog
      - 18.9.95.1
      - eighteen
      - all
      - rollback

  - name: copying pshelltranscription file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/pshelltranscription_189952.txt
      dest: C:\facts\policyfiles\pshelltranscription_189952.txt
    when: ((database.stdout_lines[1]|from_json).pshelltranscription_189952_actual) != "0x0"
    tags:
      - pshelltranscription
      - 18.9.95.2
      - eighteen
      - all
      - rollback

  - name: adding value to the pshelltranscription file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\pshelltranscription_189952.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).pshelltranscription_189952_actual}}'
    when: ((database.stdout_lines[1]|from_json).pshelltranscription_189952_actual) != "0x0" and ((database.stdout_lines[1]|from_json).pshelltranscription_189952_actual) != "DELETE"
    tags:
      - pshelltranscription
      - 18.9.95.2
      - eighteen
      - all
      - rollback

  - name: adding value to the pshelltranscription file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\pshelltranscription_189952.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).pshelltranscription_189952_actual) == "DELETE"
    tags:
      - pshelltranscription
      - 18.9.95.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\pshelltranscription_189952.txt'
    when: ((database.stdout_lines[1]|from_json).pshelltranscription_189952_actual) != "0x0"
    tags:
      - pshelltranscription
      - 18.9.95.2
      - eighteen
      - all
      - rollback

  - name: copying allowbasicauthen file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/allowbasicauthen_1899711.txt
      dest: C:\facts\policyfiles\allowbasicauthen_1899711.txt
    when: ((database.stdout_lines[1]|from_json).allowbasicauthen_1899711_actual) != "0x0"
    tags:
      - allowbasicauthen
      - 18.9.97.1.1
      - eighteen
      - all
      - rollback

  - name: adding value to the allowbasicauthen file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\allowbasicauthen_1899711.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).allowbasicauthen_1899711_actual}}'
    when: ((database.stdout_lines[1]|from_json).allowbasicauthen_1899711_actual) != "0x0" and ((database.stdout_lines[1]|from_json).allowbasicauthen_1899711_actual) != "DELETE"
    tags:
      - allowbasicauthen
      - 18.9.97.1.1
      - eighteen
      - all
      - rollback

  - name: adding value to the allowbasicauthen file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\allowbasicauthen_1899711.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).allowbasicauthen_1899711_actual) == "DELETE"
    tags:
      - allowbasicauthen
      - 18.9.97.1.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\allowbasicauthen_1899711.txt'
    when: ((database.stdout_lines[1]|from_json).allowbasicauthen_1899711_actual) != "0x0"
    tags:
      - allowbasicauthen
      - 18.9.97.1.1
      - eighteen
      - all
      - rollback

  - name: copying allowunencryptraffic file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/allowunencryptraffic_1899712.txt
      dest: C:\facts\policyfiles\allowunencryptraffic_1899712.txt
    when: ((database.stdout_lines[1]|from_json).allowunencryptraffic_1899712_actual) != "0x0"
    tags:
      - allowunencryptraffic
      - 18.9.97.1.2
      - eighteen
      - all
      - rollback

  - name: adding value to the allowunencryptraffic file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\allowunencryptraffic_1899712.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).allowunencryptraffic_1899712_actual}}'
    when: ((database.stdout_lines[1]|from_json).allowunencryptraffic_1899712_actual) != "0x0" and ((database.stdout_lines[1]|from_json).allowunencryptraffic_1899712_actual) != "DELETE"
    tags:
      - allowunencryptraffic
      - 18.9.97.1.2
      - eighteen
      - all
      - rollback

  - name: adding value to the allowunencryptraffic file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\allowunencryptraffic_1899712.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).allowunencryptraffic_1899712_actual) == "DELETE"
    tags:
      - allowunencryptraffic
      - 18.9.97.1.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\allowunencryptraffic_1899712.txt'
    when: ((database.stdout_lines[1]|from_json).allowunencryptraffic_1899712_actual) != "0x0"
    tags:
      - allowunencryptraffic
      - 18.9.97.1.2
      - eighteen
      - all
      - rollback

  - name: copying disallowdigestauthen file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/disallowdigestauthen_1899713.txt
      dest: C:\facts\policyfiles\disallowdigestauthen_1899713.txt
    when: ((database.stdout_lines[1]|from_json).disallowdigestauthen_1899713_actual) != "0x0"
    tags:
      - disallowdigestauthen
      - 18.9.97.1.3
      - eighteen
      - all
      - rollback

  - name: adding value to the disallowdigestauthen file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\disallowdigestauthen_1899713.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).disallowdigestauthen_1899713_actual}}'
    when: ((database.stdout_lines[1]|from_json).disallowdigestauthen_1899713_actual) != "0x0" and ((database.stdout_lines[1]|from_json).disallowdigestauthen_1899713_actual) != "DELETE"
    tags:
      - disallowdigestauthen
      - 18.9.97.1.3
      - eighteen
      - all
      - rollback

  - name: adding value to the disallowdigestauthen file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\disallowdigestauthen_1899713.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).disallowdigestauthen_1899713_actual) == "DELETE"
    tags:
      - disallowdigestauthen
      - 18.9.97.1.3
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\disallowdigestauthen_1899713.txt'
    when: ((database.stdout_lines[1]|from_json).disallowdigestauthen_1899713_actual) != "0x0"
    tags:
      - disallowdigestauthen
      - 18.9.97.1.3
      - eighteen
      - all
      - rollback

  - name: copying winrmallowbasicauthen file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/winrmallowbasicauthen_1899721.txt
      dest: C:\facts\policyfiles\winrmallowbasicauthen_1899721.txt
    when: ((database.stdout_lines[1]|from_json).winrmallowbasicauthen_1899721_actual) != "0x0"
    tags:
      - winrmallowbasicauthen
      - 18.9.97.2.1
      - eighteen
      - all
      - rollback

  - name: adding value to the winrmallowbasicauthen file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\winrmallowbasicauthen_1899721.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).winrmallowbasicauthen_1899721_actual}}'
    when: ((database.stdout_lines[1]|from_json).winrmallowbasicauthen_1899721_actual) != "0x0" and ((database.stdout_lines[1]|from_json).winrmallowbasicauthen_1899721_actual) != "DELETE"
    tags:
      - winrmallowbasicauthen
      - 18.9.97.2.1
      - eighteen
      - all
      - rollback

  - name: adding value to the winrmallowbasicauthen file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\winrmallowbasicauthen_1899721.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).winrmallowbasicauthen_1899721_actual) == "DELETE"
    tags:
      - winrmallowbasicauthen
      - 18.9.97.2.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\winrmallowbasicauthen_1899721.txt'
    when: ((database.stdout_lines[1]|from_json).winrmallowbasicauthen_1899721_actual) != "0x0"
    tags:
      - winrmallowbasicauthen
      - 18.9.97.2.1
      - eighteen
      - all
      - rollback

  - name: copying allowremoteservmanagment file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/allowremoteservmanagment_1899722.txt
      dest: C:\facts\policyfiles\allowremoteservmanagment_1899722.txt
    when: ((database.stdout_lines[1]|from_json).allowremoteservmanagment_1899722_actual) != "0x0"
    tags:
      - allowremoteservmanagment
      - 18.9.97.2.2
      - eighteen
      - all
      - rollback

  - name: adding value to the allowremoteservmanagment file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\allowremoteservmanagment_1899722.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).allowremoteservmanagment_1899722_actual}}'
    when: ((database.stdout_lines[1]|from_json).allowremoteservmanagment_1899722_actual) != "0x0" and ((database.stdout_lines[1]|from_json).allowremoteservmanagment_1899722_actual) != "DELETE"
    tags:
      - allowremoteservmanagment
      - 18.9.97.2.2
      - eighteen
      - all
      - rollback

  - name: adding value to the allowremoteservmanagment file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\allowremoteservmanagment_1899722.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).allowremoteservmanagment_1899722_actual) == "DELETE"
    tags:
      - allowremoteservmanagment
      - 18.9.97.2.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\allowremoteservmanagment_1899722.txt'
    when: ((database.stdout_lines[1]|from_json).allowremoteservmanagment_1899722_actual) != "0x0"
    tags:
      - allowremoteservmanagment
      - 18.9.97.2.2
      - eighteen
      - all
      - rollback

  - name: copying winrmallowencryptraffic file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/winrmallowencryptraffic_1899723.txt
      dest: C:\facts\policyfiles\winrmallowencryptraffic_1899723.txt
    when: ((database.stdout_lines[1]|from_json).winrmallowencryptraffic_1899723_actual) != "0x0"
    tags:
      - winrmallowencryptraffic
      - 18.9.97.2.3
      - eighteen
      - all
      - rollback

  - name: adding value to the winrmallowencryptraffic file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\winrmallowencryptraffic_1899723.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).winrmallowencryptraffic_1899723_actual}}'
    when: ((database.stdout_lines[1]|from_json).winrmallowencryptraffic_1899723_actual) != "0x0" and ((database.stdout_lines[1]|from_json).winrmallowencryptraffic_1899723_actual) != "DELETE"
    tags:
      - winrmallowencryptraffic
      - 18.9.97.2.3
      - eighteen
      - all
      - rollback

  - name: adding value to the winrmallowencryptraffic file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\winrmallowencryptraffic_1899723.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).winrmallowencryptraffic_1899723_actual) == "DELETE"
    tags:
      - winrmallowencryptraffic
      - 18.9.97.2.3
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\winrmallowencryptraffic_1899723.txt'
    when: ((database.stdout_lines[1]|from_json).winrmallowencryptraffic_1899723_actual) != "0x0"
    tags:
      - winrmallowencryptraffic
      - 18.9.97.2.3
      - eighteen
      - all
      - rollback

  - name: copying disallowwinrm file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/disallowwinrm_1899724.txt
      dest: C:\facts\policyfiles\disallowwinrm_1899724.txt
    when: ((database.stdout_lines[1]|from_json).disallowwinrm_1899724_actual) != "0x0"
    tags:
      - disallowwinrm
      - 18.9.97.2.4
      - eighteen
      - all
      - rollback

  - name: adding value to the disallowwinrm file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\disallowwinrm_1899724.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).disallowwinrm_1899724_actual}}'
    when: ((database.stdout_lines[1]|from_json).disallowwinrm_1899724_actual) != "0x0" and ((database.stdout_lines[1]|from_json).disallowwinrm_1899724_actual) != "DELETE"
    tags:
      - disallowwinrm
      - 18.9.97.2.4
      - eighteen
      - all
      - rollback

  - name: adding value to the disallowwinrm file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\disallowwinrm_1899724.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).disallowwinrm_1899724_actual) == "DELETE"
    tags:
      - disallowwinrm
      - 18.9.97.2.4
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\disallowwinrm_1899724.txt'
    when: ((database.stdout_lines[1]|from_json).disallowwinrm_1899724_actual) != "0x0"
    tags:
      - disallowwinrm
      - 18.9.97.2.4
      - eighteen
      - all
      - rollback

  - name: copying allowremoteshellaccess file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/allowremoteshellaccess_189981.txt
      dest: C:\facts\policyfiles\allowremoteshellaccess_189981.txt
    when: ((database.stdout_lines[1]|from_json).allowremoteshellaccess_189981_actual) != "0x0"
    tags:
      - allowremoteshellaccess
      - 18.9.98.1
      - eighteen
      - all
      - rollback

  - name: adding value to the allowremoteshellaccess file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\allowremoteshellaccess_189981.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).allowremoteshellaccess_189981_actual}}'
    when: ((database.stdout_lines[1]|from_json).allowremoteshellaccess_189981_actual) != "0x0" and ((database.stdout_lines[1]|from_json).allowremoteshellaccess_189981_actual) != "DELETE"
    tags:
      - allowremoteshellaccess
      - 18.9.98.1
      - eighteen
      - all
      - rollback

  - name: adding value to the allowremoteshellaccess file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\allowremoteshellaccess_189981.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).allowremoteshellaccess_189981_actual) == "DELETE"
    tags:
      - allowremoteshellaccess
      - 18.9.98.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\allowremoteshellaccess_189981.txt'
    when: ((database.stdout_lines[1]|from_json).allowremoteshellaccess_189981_actual) != "0x0"
    tags:
      - allowremoteshellaccess
      - 18.9.98.1
      - eighteen
      - all
      - rollback

  - name: copying prevusrmodifysetting file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/prevusrmodifysetting_1899921.txt
      dest: C:\facts\policyfiles\prevusrmodifysetting_1899921.txt
    when: ((database.stdout_lines[1]|from_json).prevusrmodifysetting_1899921_actual) != "0x0"
    tags:
      - prevusrmodifysetting
      - 18.9.99.2.1
      - eighteen
      - all
      - rollback

  - name: adding value to the prevusrmodifysetting file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\prevusrmodifysetting_1899921.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).prevusrmodifysetting_1899921_actual}}'
    when: ((database.stdout_lines[1]|from_json).prevusrmodifysetting_1899921_actual) != "0x0" and ((database.stdout_lines[1]|from_json).prevusrmodifysetting_1899921_actual) != "DELETE"
    tags:
      - prevusrmodifysetting
      - 18.9.99.2.1
      - eighteen
      - all
      - rollback

  - name: adding value to the prevusrmodifysetting file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\prevusrmodifysetting_1899921.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).prevusrmodifysetting_1899921_actual) == "DELETE"
    tags:
      - prevusrmodifysetting
      - 18.9.99.2.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\prevusrmodifysetting_1899921.txt'
    when: ((database.stdout_lines[1]|from_json).prevusrmodifysetting_1899921_actual) != "0x0"
    tags:
      - prevusrmodifysetting
      - 18.9.99.2.1
      - eighteen
      - all
      - rollback

  - name: copying managepreviewbuilds file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/managepreviewbuilds_18910211.txt
      dest: C:\facts\policyfiles\managepreviewbuilds_18910211.txt
    when: ((database.stdout_lines[1]|from_json).managepreviewbuilds_18910211_actual) != "0x1 0x0"
    tags:
      - managepreviewbuilds
      - 18.9.102.1.1
      - eighteen
      - all
      - rollback

  - name: adding value to the managepreviewbuilds file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\managepreviewbuilds_18910211.txt
       regex: '{{ item.regex }}'
       line: '{{ item.line }}'
    with_items:
      - { regex: "^(ManagePreviewBuilds )", line: "ManagePreviewBuilds\nDWORD{{ (database.stdout_lines[1]|from_json).managepreviewbuilds_18910211_actual.split(' ')[0] }}" }
      - { regex: "^(ManagePreviewBuildsPolicyValue )", line: "ManagePreviewBuildsPolicyValue\nDWORD{{ (database.stdout_lines[1]|from_json).managepreviewbuilds_18910211_actual.split(' ')[1] }}" }
    when: ((database.stdout_lines[1]|from_json).managepreviewbuilds_18910211_actual) != "0x1 0x0" and ((database.stdout_lines[1]|from_json).managepreviewbuilds_18910211_actual) != "DELETE"
    tags:
      - managepreviewbuilds
      - 18.9.102.1.1
      - eighteen
      - all
      - rollback

  - name: adding value to the managepreviewbuilds file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\managepreviewbuilds_18910211.txt
       regex: '{{ item.regex }}'
       line: '{{ item.line }}'
    with_items:
      - { regex: "^(ManagePreviewBuilds )", line: "ManagePreviewBuilds\nDELETE" }
      - { regex: "^(ManagePreviewBuildsPolicyValue )", line: "ManagePreviewBuildsPolicyValue\nDELETE" } 
    when: ((database.stdout_lines[1]|from_json).managepreviewbuilds_18910211_actual) == "DELETE"
    tags:
      - managepreviewbuilds
      - 18.9.102.1.1
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\managepreviewbuilds_18910211.txt'
    when: ((database.stdout_lines[1]|from_json).managepreviewbuilds_18910211_actual) != "0x1 0x0"
    tags:
      - managepreviewbuilds
      - 18.9.102.1.1
      - eighteen
      - all
      - rollback

  - name: copying previewbuildsfeature file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/previewbuildsfeature_18910212.txt
      dest: C:\facts\policyfiles\previewbuildsfeature_18910212.txt
    when: ((database.stdout_lines[1]|from_json).previewbuildsfeature_18910212_actual) != "0x1 0xb4 0x20"
    tags:
      - previewbuildsfeature
      - 18.9.102.1.2
      - eighteen
      - all
      - rollback

  - name: adding values to the previewbuildsfeature file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\previewbuildsfeature_18910212.txt
       regex: '{{ item.regex }}'
       line: '{{ item.line }}'
    with_items:
      - { regex: "^(DeferFeatureUpdates )", line: "DeferFeatureUpdates\nDWORD:{{ (database.stdout_lines[1]|from_json).previewbuildsfeature_18910212_actual.split(' ')[0] }}" }
      - { regex: "^(DeferFeatureUpdatesPeriodInDays )", line: "DeferFeatureUpdatesPeriodInDays\nDWORD:{{ (database.stdout_lines[1]|from_json).previewbuildsfeature_18910212_actual.split(' ')[1] }}" }
      - { regex: "^(BranchReadinessLevel )", line: "BranchReadinessLevel\nDWORD:{{ (database.stdout_lines[1]|from_json).previewbuildsfeature_18910212_actual.split(' ')[2] }}" }
    when: ((database.stdout_lines[1]|from_json).previewbuildsfeature_18910212_actual) != "0x1 0xb4 0x20" and ((database.stdout_lines[1]|from_json).previewbuildsfeature_18910212_actual) != "DELETE"
    tags:
      - previewbuildsfeature
      - 18.9.102.1.2
      - eighteen
      - all
      - rollback

  - name: adding delete to the previewbuildsfeature file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\previewbuildsfeature_18910212.txt
       regex: '{{ item.regex }}'
       line: '{{ item.line }}'
    with_items:
      - { regex: "^(DeferFeatureUpdates )", line: "DeferFeatureUpdates\nDELETE" }
      - { regex: "^(DeferFeatureUpdatesPeriodInDays )", line: "DeferFeatureUpdatesPeriodInDays\nDELETE" }
      - { regex: "^(BranchReadinessLevel )", line: "BranchReadinessLevel\nDELETE" }
    when: ((database.stdout_lines[1]|from_json).previewbuildsfeature_18910212_actual) == "DELETE"
    tags:
      - previewbuildsfeature
      - 18.9.102.1.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\previewbuildsfeature_18910212.txt'
    when: ((database.stdout_lines[1]|from_json).previewbuildsfeature_18910212_actual) != "0x1 0xb4 0x20"
    tags:
      - previewbuildsfeature
      - 18.9.102.1.2
      - eighteen
      - all
      - rollback

  - name: copying qualityupdates file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/qualityupdates_18910213.txt
      dest: C:\facts\policyfiles\qualityupdates_18910213.txt
    when: ((database.stdout_lines[1]|from_json).qualityupdates_18910213_actual) != "0x1 0x0"
    tags:
      - qualityupdates
      - 18.9.102.1.3
      - eighteen
      - all
      - rollback

  - name: adding values to the qualityupdates file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\qualityupdates_18910213.txt
       regex: '{{ item.regex }}'
       line: '{{ item.line }}'
    with_items:
      - { regex: "^(DeferQualityUpdates )", line: "DeferQualityUpdates\nDWORD:{{(database.stdout_lines[1]|from_json).qualityupdates_18910213_actual.split(' ')[0]}}" }
      - { regex: "^(DeferQualityUpdatesPeriodInDays )", line: "DeferQualityUpdatesPeriodInDays\nDWORD:{{(database.stdout_lines[1]|from_json).qualityupdates_18910213_actual.split(' ')[1]}}" }
    when: ((database.stdout_lines[1]|from_json).qualityupdates_18910213_actual) != "0x1 0x0" and ((database.stdout_lines[1]|from_json).qualityupdates_18910213_actual) != "DELETE"
    tags:
      - qualityupdates
      - 18.9.102.1.3
      - eighteen
      - all
      - rollback

  - name: adding values to the qualityupdates file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\qualityupdates_18910213.txt
       regex: '{{ item.regex }}'
       line: '{{ item.line }}'
    with_items:
      - { regex: "^(DeferQualityUpdates )", line: "DeferQualityUpdates\nDELETE" }
      - { regex: "^(DeferQualityUpdatesPeriodInDays )", line: "DeferQualityUpdatesPeriodInDays\nDELETE" }
    when: ((database.stdout_lines[1]|from_json).qualityupdates_18910213_actual) == "DELETE"
    tags:
      - qualityupdates
      - 18.9.102.1.3
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\qualityupdates_18910213.txt'
    when: ((database.stdout_lines[1]|from_json).qualityupdates_18910213_actual) != "0x1 0x0"
    tags:
      - qualityupdates
      - 18.9.102.1.3
      - eighteen
      - all
      - rollback

  - name: copying confautoupdates file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/confautoupdates_1891022.txt
      dest: C:\facts\policyfiles\confautoupdates_1891022.txt
    when: ((database.stdout_lines[1]|from_json).confautoupdates_1891022_actual) != "0x0"
    tags:
      - confautoupdates
      - 18.9.102.2
      - eighteen
      - all
      - rollback

  - name: adding value to the confautoupdates file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confautoupdates_1891022.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).confautoupdates_1891022_actual}}'
    when: ((database.stdout_lines[1]|from_json).confautoupdates_1891022_actual) != "0x0" and ((database.stdout_lines[1]|from_json).confautoupdates_1891022_actual) != "DELETE"
    tags:
      - confautoupdates
      - 18.9.102.2
      - eighteen
      - all
      - rollback

  - name: adding value to the confautoupdates file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confautoupdates_1891022.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).confautoupdates_1891022_actual) == "DELETE"
    tags:
      - confautoupdates
      - 18.9.102.2
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\confautoupdates_1891022.txt'
    when: ((database.stdout_lines[1]|from_json).confautoupdates_1891022_actual) != "0x0"
    tags:
      - confautoupdates
      - 18.9.102.2
      - eighteen
      - all
      - rollback

  - name: copying confautoupdatesday file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/confautoupdatesday_1891023.txt
      dest: C:\facts\policyfiles\confautoupdatesday_1891023.txt
    when: ((database.stdout_lines[1]|from_json).confautoupdatesday_1891023_actual) != "0x0"
    tags:
      - confautoupdatesday
      - 18.9.102.3
      - eighteen
      - all
      - rollback

  - name: adding value to the confautoupdatesday file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confautoupdatesday_1891023.txt
       insertafter: 'ScheduledInstallDay'
       line: 'ScheduledInstallDay\nDWORD:{{ (database.stdout_lines[1]|from_json).confautoupdatesday_1891023_actual) }}'
    when: ((database.stdout_lines[1]|from_json).confautoupdatesday_1891023_actual) != "0x0" and ((database.stdout_lines[1]|from_json).confautoupdatesday_1891023_actual) != "DELETE"
    tags:
      - confautoupdatesday
      - 18.9.102.3
      - eighteen
      - all
      - rollback

  - name: adding value to the confautoupdatesday file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confautoupdatesday_1891023.txt
       regex: 'ScheduledInstallDay'
       line: 'ScheduledInstallDay\nDELETE'
    when: ((database.stdout_lines[1]|from_json).confautoupdatesday_1891023_actual) == "DELETE"
    tags:
      - confautoupdatesday
      - 18.9.102.3
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\confautoupdatesday_1891023.txt'
    when: ((database.stdout_lines[1]|from_json).confautoupdatesday_1891023_actual) != "0x0"
    tags:
      - confautoupdatesday
      - 18.9.102.3
      - eighteen
      - all
      - rollback

  - name: copying noautorestart file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/noautorestart_1891024.txt
      dest: C:\facts\policyfiles\noautorestart_1891024.txt
    when: ((database.stdout_lines[1]|from_json).noautorestart_1891024_actual) != "0x0"
    tags:
      - noautorestart
      - 18.9.102.4
      - eighteen
      - all
      - rollback

  - name: adding value to the noautorestart file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\noautorestart_1891024.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{(database.stdout_lines[1]|from_json).noautorestart_1891024_actual}}'
    when: ((database.stdout_lines[1]|from_json).noautorestart_1891024_actual) != "0x0" and ((database.stdout_lines[1]|from_json).noautorestart_1891024_actual) != "DELETE"
    tags:
      - noautorestart
      - 18.9.102.4
      - eighteen
      - all
      - rollback

  - name: adding value to the noautorestart file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\noautorestart_1891024.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when: ((database.stdout_lines[1]|from_json).noautorestart_1891024_actual) == "DELETE"
    tags:
      - noautorestart
      - 18.9.102.4
      - eighteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\noautorestart_1891024.txt'
    when: ((database.stdout_lines[1]|from_json).noautorestart_1891024_actual) != "0x0"
    tags:
      - noautorestart
      - 18.9.102.4
      - eighteen
      - all
      - rollback

  - name: adding the values in file from db
    shell: echo "{{ item.split('-')[1]}}" >> enablescrnsav
    loop: "{{(database.stdout_lines[1]|from_json).enablescrnsav_19131_actual.split(' and SKIPPING')[0].split(',')}}"
    when: ((database.stdout_lines[1]|from_json).enablescrnsav_19131_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    delegate_to: localhost
    tags:
      - enablescrnsav
      - 19.1.3.1
      - nineteen
      - all
      - rollback

  - name: grepping the majority value from the file
    shell: cat enablescrnsav | sort | uniq -c | sort -nr | head -n 1 | awk '{print $2}'
    when: ((database.stdout_lines[1]|from_json).enablescrnsav_19131_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    register: enablescrnsav_roll
    delegate_to: localhost
    tags:
      - enablescrnsav
      - 19.1.3.1
      - nineteen
      - all
      - rollback

  - name: copying enablescrnsav file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/enablescrnsav_19131.txt
      dest: C:\facts\policyfiles\enablescrnsav_19131.txt
    when: ((database.stdout_lines[1]|from_json).enablescrnsav_19131_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    tags:
      - enablescrnsav
      - 19.1.3.1
      - nineteen
      - all
      - rollback

  - name: adding value to the enablescrnsav file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\enablescrnsav_19131.txt
       regex: '^(SZ:*)'
       line: 'SZ:{{enablescrnsav_roll.stdout}}'
    when:
      - ((database.stdout_lines[1]|from_json).enablescrnsav_19131_actual | regex_replace(' and SKIPPING.*', '')) != "1"
      - enablescrnsav_roll.stdout != "DELETE"
    tags:
      - enablescrnsav
      - 19.1.3.1
      - nineteen
      - all
      - rollback

  - name: adding value to the enablescrnsav file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\enablescrnsav_19131.txt
       regex: '^(SZ:*)'
       line: 'DELETE'
    when:
      - ((database.stdout_lines[1]|from_json).enablescrnsav_19131_actual | regex_replace(' and SKIPPING.*', '')) != "1"
      - enablescrnsav_roll.stdout == "DELETE"
    tags:
      - enablescrnsav
      - 19.1.3.1
      - nineteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\enablescrnsav_19131.txt'
    when: ((database.stdout_lines[1]|from_json).enablescrnsav_19131_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    tags:
      - enablescrnsav
      - 19.1.3.1
      - nineteen
      - all
      - rollback

  - name: adding the values in file from db
    shell: echo "{{ item.split('-')[1]}}" >> forspecscrnsav
    loop: "{{(database.stdout_lines[1]|from_json).forspecscrnsav_19132_actual.split(' and SKIPPING')[0].split(',')}}"
    when: ((database.stdout_lines[1]|from_json).forspecscrnsav_19132_actual | regex_replace(' and SKIPPING.*', '')) != "scrnsave.scr"
    delegate_to: localhost
    tags:
      - forspecscrnsav
      - 19.1.3.2
      - nineteen
      - all
      - rollback

  - name: grepping the majority value from the file
    shell: cat forspecscrnsav | sort | uniq -c | sort -nr | head -n 1 | awk '{print $2}'
    when: ((database.stdout_lines[1]|from_json).forspecscrnsav_19132_actual | regex_replace(' and SKIPPING.*', '')) != "scrnsave.scr"
    register: forspecscrnsav_roll
    delegate_to: localhost
    tags:
      - forspecscrnsav
      - 19.1.3.2
      - nineteen
      - all
      - rollback

  - name: copying forspecscrnsav file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/forspecscrnsav_19132.txt
      dest: C:\facts\policyfiles\forspecscrnsav_19132.txt
    when: ((database.stdout_lines[1]|from_json).forspecscrnsav_19132_actual | regex_replace(' and SKIPPING.*', '')) != "scrnsave.scr"
    tags:
      - forspecscrnsav
      - 19.1.3.2
      - nineteen
      - all
      - rollback

  - name: adding value to the forspecscrnsav file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\forspecscrnsav_19132.txt
       regex: '^(SZ:*)'
       line: 'SZ:{{forspecscrnsav_roll.stdout}}'
    when:
      - ((database.stdout_lines[1]|from_json).forspecscrnsav_19132_actual | regex_replace(' and SKIPPING.*', '')) != "scrnsave.scr"
      - forspecscrnsav_roll.stdout != "DELETE"
    tags:
      - forspecscrnsav
      - 19.1.3.2
      - nineteen
      - all
      - rollback

  - name: adding value to the forspecscrnsav file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\forspecscrnsav_19132.txt
       regex: '^(SZ:*)'
       line: 'DELETE'
    when:
      - ((database.stdout_lines[1]|from_json).forspecscrnsav_19132_actual | regex_replace(' and SKIPPING.*', '')) != "scrnsave.scr"
      - forspecscrnsav_roll.stdout == "DELETE"
    tags:
      - forspecscrnsav
      - 19.1.3.2
      - nineteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\forspecscrnsav_19132.txt'
    when: ((database.stdout_lines[1]|from_json).forspecscrnsav_19132_actual | regex_replace(' and SKIPPING.*', '')) != "scrnsave.scr"
    tags:
      - forspecscrnsav
      - 19.1.3.2
      - nineteen
      - all
      - rollback

  - name: adding the values in file from db
    shell: echo "{{ item.split('-')[1]}}" >> passproscrnsav
    loop: "{{(database.stdout_lines[1]|from_json).passproscrnsav_19133_actual.split(' and SKIPPING')[0].split(',')}}"
    when: ((database.stdout_lines[1]|from_json).passproscrnsav_19133_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    delegate_to: localhost
    tags:
      - passproscrnsav
      - 19.1.3.3
      - nineteen
      - all
      - rollback

  - name: grepping the majority value from the file
    shell: cat passproscrnsav | sort | uniq -c | sort -nr | head -n 1 | awk '{print $2}'
    when: ((database.stdout_lines[1]|from_json).passproscrnsav_19133_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    register: passproscrnsav_roll
    delegate_to: localhost
    tags:
      - passproscrnsav
      - 19.1.3.3
      - nineteen
      - all
      - rollback

  - name: copying passproscrnsav file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/passproscrnsav_19133.txt
      dest: C:\facts\policyfiles\passproscrnsav_19133.txt
    when: ((database.stdout_lines[1]|from_json).passproscrnsav_19133_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    tags:
      - passproscrnsav
      - 19.1.3.3
      - nineteen
      - all
      - rollback

  - name: adding value to the passproscrnsav file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\passproscrnsav_19133.txt
       regex: '^(SZ:*)'
       line: 'SZ:{{passproscrnsav_roll.stdout}}'
    when:
      - ((database.stdout_lines[1]|from_json).passproscrnsav_19133_actual | regex_replace(' and SKIPPING.*', '')) != "1"
      - passproscrnsav_roll.stdout != "DELETE"
    tags:
      - passproscrnsav
      - 19.1.3.3
      - nineteen
      - all
      - rollback

  - name: adding value to the passproscrnsav file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\passproscrnsav_19133.txt
       regex: '^(SZ:*)'
       line: 'DELETE'
    when:
      - ((database.stdout_lines[1]|from_json).passproscrnsav_19133_actual | regex_replace(' and SKIPPING.*', '')) != "1"
      - passproscrnsav_roll.stdout == "DELETE"
    tags:
      - passproscrnsav
      - 19.1.3.3
      - nineteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\passproscrnsav_19133.txt'
    when: ((database.stdout_lines[1]|from_json).passproscrnsav_19133_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    tags:
      - passproscrnsav
      - 19.1.3.3
      - nineteen
      - all
      - rollback

  - name: adding the values in file from db
    shell: echo "{{ item.split('-')[1]}}" >> scrnsavtimeout
    loop: "{{(database.stdout_lines[1]|from_json).scrnsavtimeout_19134_actual.split(' and SKIPPING')[0].split(',')}}"
    delegate_to: localhost
    tags:
      - scrnsavtimeout
      - 19.1.3.4
      - nineteen
      - all
      - rollback

  - name: grepping the majority value from the file
    shell: cat scrnsavtimeout | sort | uniq -c | sort -nr | head -n 1 | awk '{print $2}'
    register: scrnsavtimeout_roll
    delegate_to: localhost
    tags:
      - scrnsavtimeout
      - 19.1.3.4
      - nineteen
      - all
      - rollback

  - name: checking if it satisfies the condition
    shell: |
         a=$(seq 1 900 >> /tmp/cis_seq)
         if [ $(cat /tmp/cis_seq | grep -w "{{scrnsavtimeout_roll.stdout}}" | wc -l) -eq 1 ]; then
            echo "passed"
         else
            if [ $(cat scrnsavtimeout | grep "DELETE" | wc -l) -eq 1 ]; then
                 echo "DELETE"
            else
                 echo "failed"
            fi
         fi
         rm -rf /tmp/cis_seq
    register: scrnsavtimeout_check
    delegate_to: localhost
    tags:
      - scrnsavtimeout
      - 19.1.3.4
      - nineteen
      - all
      - rollback

  - name: copying scrnsavtimeout file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/scrnsavtimeout_19134.txt
      dest: C:\facts\policyfiles\scrnsavtimeout_19133.txt
    when: scrnsavtimeout_check.stdout != "passed"
    tags:
      - scrnsavtimeout
      - 19.1.3.4
      - nineteen
      - all
      - rollback

  - name: adding value to the scrnsavtimeout file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\scrnsavtimeout_19134.txt
       regex: '^(SZ:*)'
       line: 'SZ:{{scrnsavtimeout_roll.stdout}}'
    when:
      - scrnsavtimeout_check.stdout != "passed"
      - scrnsavtimeout_roll.stdout != "DELETE"
    tags:
      - scrnsavtimeout
      - 19.1.3.4
      - nineteen
      - all
      - rollback

  - name: adding value to the scrnsavtimeout file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\scrnsavtimeout_19134.txt
       regex: '^(SZ:*)'
       line: 'DELETE'
    when:
      - scrnsavtimeout_check.stdout != "passed"
      - scrnsavtimeout_roll.stdout == "DELETE"
    tags:
      - scrnsavtimeout
      - 19.1.3.4
      - nineteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\scrnsavtimeout_19134.txt'
    when: scrnsavtimeout_check.stdout != "passed"
    tags:
      - scrnsavtimeout
      - 19.1.3.4
      - nineteen
      - all
      - rollback

  - name: adding the values in file from db
    shell: echo "{{ item.split('-')[1]}}" >> toastnotiflockscrn
    loop: "{{(database.stdout_lines[1]|from_json).toastnotiflockscrn_19511_actual.split(' and SKIPPING')[0].split(',')}}"
    when: ((database.stdout_lines[1]|from_json).toastnotiflockscrn_19511_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    delegate_to: localhost
    tags:
      - toastnotiflockscrn
      - 19.5.1.1
      - nineteen
      - all
      - rollback

  - name: grepping the majority value from the file
    shell: cat toastnotiflockscrn | sort | uniq -c | sort -nr | head -n 1 | awk '{print $2}'
    when: ((database.stdout_lines[1]|from_json).toastnotiflockscrn_19511_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    register: toastnotiflockscrn_roll
    delegate_to: localhost
    tags:
      - toastnotiflockscrn
      - 19.5.1.1
      - nineteen
      - all
      - rollback

  - name: copying toastnotiflockscrn file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/toastnotiflockscrn_19511.txt
      dest: C:\facts\policyfiles\toastnotiflockscrn_19511.txt
    when: ((database.stdout_lines[1]|from_json).toastnotiflockscrn_19511_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    tags:
      - toastnotiflockscrn
      - 19.5.1.1
      - nineteen
      - all
      - rollback

  - name: adding value to the toastnotiflockscrn file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\toastnotiflockscrn_19511.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{toastnotiflockscrn_roll.stdout}}'
    when:
      - ((database.stdout_lines[1]|from_json).toastnotiflockscrn_19511_actual | regex_replace(' and SKIPPING.*', '')) != "1"
      - toastnotiflockscrn_roll.stdout != "DELETE"
    tags:
      - toastnotiflockscrn
      - 19.5.1.1
      - nineteen
      - all
      - rollback

  - name: adding value to the toastnotiflockscrn file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\toastnotiflockscrn_19511.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when:
      - ((database.stdout_lines[1]|from_json).toastnotiflockscrn_19511_actual | regex_replace(' and SKIPPING.*', '')) != "1"
      - toastnotiflockscrn_roll.stdout == "DELETE"
    tags:
      - toastnotiflockscrn
      - 19.5.1.1
      - nineteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\toastnotiflockscrn_19511.txt'
    when: ((database.stdout_lines[1]|from_json).toastnotiflockscrn_19511_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    tags:
      - toastnotiflockscrn
      - 19.5.1.1
      - nineteen
      - all
      - rollback

  - name: adding the values in file from db
    shell: echo "{{ item.split('-')[1]}}" >> helpexpimprogram
    loop: "{{(database.stdout_lines[1]|from_json).helpexpimprogram_196611_actual.split(' and SKIPPING')[0].split(',')}}"
    when: ((database.stdout_lines[1]|from_json).helpexpimprogram_196611_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    delegate_to: localhost
    tags:
      - helpexpimprogram
      - 19.6.6.1.1
      - nineteen
      - all
      - rollback

  - name: grepping the majority value from the file
    shell: cat helpexpimprogram | sort | uniq -c | sort -nr | head -n 1 | awk '{print $2}'
    when: ((database.stdout_lines[1]|from_json).helpexpimprogram_196611_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    register: helpexpimprogram_roll
    delegate_to: localhost
    tags:
      - helpexpimprogram
      - 19.6.6.1.1
      - nineteen
      - all
      - rollback

  - name: copying helpexpimprogram file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/helpexpimprogram_196611.txt
      dest: C:\facts\policyfiles\helpexpimprogram_196611.txt
    when: ((database.stdout_lines[1]|from_json).helpexpimprogram_196611_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    tags:
      - helpexpimprogram
      - 19.6.6.1.1
      - nineteen
      - all
      - rollback

  - name: adding value to the helpexpimprogram file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\helpexpimprogram_196611.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{helpexpimprogram_roll.stdout}}'
    when:
      - ((database.stdout_lines[1]|from_json).helpexpimprogram_196611_actual | regex_replace(' and SKIPPING.*', '')) != "1"
      - helpexpimprogram_roll.stdout != "DELETE"
    tags:
      - helpexpimprogram
      - 19.6.6.1.1
      - nineteen
      - all
      - rollback

  - name: adding value to the helpexpimprogram file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\helpexpimprogram_196611.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when:
      - ((database.stdout_lines[1]|from_json).helpexpimprogram_196611_actual | regex_replace(' and SKIPPING.*', '')) != "1"
      - helpexpimprogram_roll.stdout == "DELETE"
    tags:
      - helpexpimprogram
      - 19.6.6.1.1
      - nineteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\helpexpimprogram_196611.txt'
    when: ((database.stdout_lines[1]|from_json).helpexpimprogram_196611_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    tags:
      - helpexpimprogram
      - 19.6.6.1.1
      - nineteen
      - all
      - rollback

  - name: adding the values in file from db
    shell: echo "{{ item.split('-')[1]}}" >> prezoneinfile
    loop: "{{(database.stdout_lines[1]|from_json).prezoneinfile_19741_actual.split(' and SKIPPING')[0].split(',')}}"
    when: ((database.stdout_lines[1]|from_json).prezoneinfile_19741_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    delegate_to: localhost
    tags:
      - prezoneinfile
      - 19.7.4.1
      - nineteen
      - all
      - rollback

  - name: grepping the majority value from the file
    shell: cat prezoneinfile | sort | uniq -c | sort -nr | head -n 1 | awk '{print $2}'
    when: ((database.stdout_lines[1]|from_json).prezoneinfile_19741_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    register: prezoneinfile_roll
    delegate_to: localhost
    tags:
      - prezoneinfile
      - 19.7.4.1
      - nineteen
      - all
      - rollback

  - name: copying prezoneinfile file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/prezoneinfile_19741.txt
      dest: C:\facts\policyfiles\prezoneinfile_19741.txt
    when: ((database.stdout_lines[1]|from_json).prezoneinfile_19741_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    tags:
      - prezoneinfile
      - 19.7.4.1
      - nineteen
      - all
      - rollback

  - name: adding value to the prezoneinfile file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\prezoneinfile_19741.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{prezoneinfile_roll.stdout}}'
    when:
      - ((database.stdout_lines[1]|from_json).prezoneinfile_19741_actual | regex_replace(' and SKIPPING.*', '')) != "1"
      - prezoneinfile_roll.stdout != "DELETE"
    tags:
      - prezoneinfile
      - 19.7.4.1
      - nineteen
      - all
      - rollback

  - name: adding value to the prezoneinfile file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\prezoneinfile_19741.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when:
      - ((database.stdout_lines[1]|from_json).prezoneinfile_19741_actual | regex_replace(' and SKIPPING.*', '')) != "1"
      - prezoneinfile_roll.stdout == "DELETE"
    tags:
      - prezoneinfile
      - 19.7.4.1
      - nineteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\prezoneinfile_19741.txt'
    when: ((database.stdout_lines[1]|from_json).prezoneinfile_19741_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    tags:
      - prezoneinfile
      - 19.7.4.1
      - nineteen
      - all
      - rollback

  - name: adding the values in file from db
    shell: echo "{{ item.split('-')[1]}}" >> prezoneinfile
    loop: "{{(database.stdout_lines[1]|from_json).prezoneinfile_19741_actual.split(' and SKIPPING')[0].split(',')}}"
    when: ((database.stdout_lines[1]|from_json).prezoneinfile_19741_actual | regex_replace(' and SKIPPING.*', '')) != "2"
    delegate_to: localhost
    tags:
      - prezoneinfile
      - 19.7.4.1
      - nineteen
      - all
      - rollback

  - name: grepping the majority value from the file
    shell: cat prezoneinfile | sort | uniq -c | sort -nr | head -n 1 | awk '{print $2}'
    when: ((database.stdout_lines[1]|from_json).prezoneinfile_19741_actual | regex_replace(' and SKIPPING.*', '')) != "2"
    register: prezoneinfile_roll
    delegate_to: localhost
    tags:
      - prezoneinfile
      - 19.7.4.1
      - nineteen
      - all
      - rollback

  - name: copying prezoneinfile file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/prezoneinfile_19741.txt
      dest: C:\facts\policyfiles\prezoneinfile_19741.txt
    when: ((database.stdout_lines[1]|from_json).prezoneinfile_19741_actual | regex_replace(' and SKIPPING.*', '')) != "2"
    tags:
      - prezoneinfile
      - 19.7.4.1
      - nineteen
      - all
      - rollback

  - name: adding value to the prezoneinfile file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\prezoneinfile_19741.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{prezoneinfile_roll.stdout}}'
    when:
      - ((database.stdout_lines[1]|from_json).prezoneinfile_19741_actual | regex_replace(' and SKIPPING.*', '')) != "2"
      - prezoneinfile_roll.stdout != "DELETE"
    tags:
      - prezoneinfile
      - 19.7.4.1
      - nineteen
      - all
      - rollback

  - name: adding value to the prezoneinfile file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\prezoneinfile_19741.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when:
      - ((database.stdout_lines[1]|from_json).prezoneinfile_19741_actual | regex_replace(' and SKIPPING.*', '')) != "2"
      - prezoneinfile_roll.stdout == "DELETE"
    tags:
      - prezoneinfile
      - 19.7.4.1
      - nineteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\prezoneinfile_19741.txt'
    when: ((database.stdout_lines[1]|from_json).prezoneinfile_19741_actual | regex_replace(' and SKIPPING.*', '')) != "2"
    tags:
      - prezoneinfile
      - 19.7.4.1
      - nineteen
      - all
      - rollback

  - name: adding the values in file from db
    shell: echo "{{ item.split('-')[1]}}" >> notifyantiprogramopen
    loop: "{{(database.stdout_lines[1]|from_json).notifyantiprogramopen_19742_actual.split(' and SKIPPING')[0].split(',')}}"
    when: ((database.stdout_lines[1]|from_json).notifyantiprogramopen_19742_actual | regex_replace(' and SKIPPING.*', '')) != "3"
    delegate_to: localhost
    tags:
      - notifyantiprogramopen
      - 19.7.4.2
      - nineteen
      - all
      - rollback

  - name: grepping the majority value from the file
    shell: cat notifyantiprogramopen | sort | uniq -c | sort -nr | head -n 1 | awk '{print $2}'
    when: ((database.stdout_lines[1]|from_json).notifyantiprogramopen_19742_actual | regex_replace(' and SKIPPING.*', '')) != "3"
    register: notifyantiprogramopen_roll
    delegate_to: localhost
    tags:
      - notifyantiprogramopen
      - 19.7.4.2
      - nineteen
      - all
      - rollback

  - name: copying notifyantiprogramopen file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/notifyantiprogramopen_19742.txt
      dest: C:\facts\policyfiles\notifyantiprogramopen_19742.txt
    when: ((database.stdout_lines[1]|from_json).notifyantiprogramopen_19742_actual | regex_replace(' and SKIPPING.*', '')) != "3"
    tags:
      - notifyantiprogramopen
      - 19.7.4.2
      - nineteen
      - all
      - rollback

  - name: adding value to the notifyantiprogramopen file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\notifyantiprogramopen_19742.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{notifyantiprogramopen_roll.stdout}}'
    when:
      - ((database.stdout_lines[1]|from_json).notifyantiprogramopen_19742_actual | regex_replace(' and SKIPPING.*', '')) != "3"
      - notifyantiprogramopen_roll.stdout != "DELETE"
    tags:
      - notifyantiprogramopen
      - 19.7.4.2
      - nineteen
      - all
      - rollback

  - name: adding value to the notifyantiprogramopen file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\notifyantiprogramopen_19742.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when:
      - ((database.stdout_lines[1]|from_json).notifyantiprogramopen_19742_actual | regex_replace(' and SKIPPING.*', '')) != "3"
      - notifyantiprogramopen_roll.stdout == "DELETE"
    tags:
      - notifyantiprogramopen
      - 19.7.4.2
      - nineteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\notifyantiprogramopen_19742.txt'
    when: ((database.stdout_lines[1]|from_json).notifyantiprogramopen_19742_actual | regex_replace(' and SKIPPING.*', '')) != "3"
    tags:
      - notifyantiprogramopen
      - 19.7.4.2
      - nineteen
      - all
      - rollback

  - name: adding the values in file from db
    shell: echo "{{ item.split('-')[1]}}" >> confwinspotlockscrn
    loop: "{{(database.stdout_lines[1]|from_json).confwinspotlockscrn_19771_actual.split(' and SKIPPING')[0].split(',')}}"
    when: ((database.stdout_lines[1]|from_json).confwinspotlockscrn_19771_actual | regex_replace(' and SKIPPING.*', '')) != "2"
    delegate_to: localhost
    tags:
      - confwinspotlockscrn
      - 19.7.7.1
      - nineteen
      - all
      - rollback

  - name: grepping the majority value from the file
    shell: cat confwinspotlockscrn | sort | uniq -c | sort -nr | head -n 1 | awk '{print $2}'
    when: ((database.stdout_lines[1]|from_json).confwinspotlockscrn_19771_actual | regex_replace(' and SKIPPING.*', '')) != "2"
    register: confwinspotlockscrn_roll
    delegate_to: localhost
    tags:
      - confwinspotlockscrn
      - 19.7.7.1
      - nineteen
      - all
      - rollback

  - name: copying confwinspotlockscrn file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/confwinspotlockscrn_19771.txt
      dest: C:\facts\policyfiles\confwinspotlockscrn_19771.txt
    when: ((database.stdout_lines[1]|from_json).confwinspotlockscrn_19771_actual | regex_replace(' and SKIPPING.*', '')) != "2"
    tags:
      - confwinspotlockscrn
      - 19.7.7.1
      - nineteen
      - all
      - rollback

  - name: adding value to the confwinspotlockscrn file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confwinspotlockscrn_19771.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{confwinspotlockscrn_roll.stdout}}'
    when:
      - ((database.stdout_lines[1]|from_json).confwinspotlockscrn_19771_actual | regex_replace(' and SKIPPING.*', '')) != "2"
      - confwinspotlockscrn_roll.stdout != "DELETE"
    tags:
      - confwinspotlockscrn
      - 19.7.7.1
      - nineteen
      - all
      - rollback

  - name: adding value to the confwinspotlockscrn file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\confwinspotlockscrn_19771.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when:
      - ((database.stdout_lines[1]|from_json).confwinspotlockscrn_19771_actual | regex_replace(' and SKIPPING.*', '')) != "2"
      - confwinspotlockscrn_roll.stdout == "DELETE"
    tags:
      - confwinspotlockscrn
      - 19.7.7.1
      - nineteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\confwinspotlockscrn_19771.txt'
    when: ((database.stdout_lines[1]|from_json).confwinspotlockscrn_19771_actual | regex_replace(' and SKIPPING.*', '')) != "2"
    tags:
      - confwinspotlockscrn
      - 19.7.7.1
      - nineteen
      - all
      - rollback

  - name: adding the values in file from db
    shell: echo "{{ item.split('-')[1]}}" >> thirdpartywinspot
    loop: "{{(database.stdout_lines[1]|from_json).thirdpartywinspot_19772_actual.split(' and SKIPPING')[0].split(',')}}"
    when: ((database.stdout_lines[1]|from_json).thirdpartywinspot_19772_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    delegate_to: localhost
    tags:
      - thirdpartywinspot
      - 19.7.7.2
      - nineteen
      - all
      - rollback

  - name: grepping the majority value from the file
    shell: cat thirdpartywinspot | sort | uniq -c | sort -nr | head -n 1 | awk '{print $2}'
    when: ((database.stdout_lines[1]|from_json).thirdpartywinspot_19772_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    register: thirdpartywinspot_roll
    delegate_to: localhost
    tags:
      - thirdpartywinspot
      - 19.7.7.2
      - nineteen
      - all
      - rollback

  - name: copying thirdpartywinspot file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/thirdpartywinspot_19772.txt
      dest: C:\facts\policyfiles\thirdpartywinspot_19772.txt
    when: ((database.stdout_lines[1]|from_json).thirdpartywinspot_19772_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    tags:
      - thirdpartywinspot
      - 19.7.7.2
      - nineteen
      - all
      - rollback

  - name: adding value to the thirdpartywinspot file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\thirdpartywinspot_19772.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{thirdpartywinspot_roll.stdout}}'
    when:
      - ((database.stdout_lines[1]|from_json).thirdpartywinspot_19772_actual | regex_replace(' and SKIPPING.*', '')) != "1"
      - thirdpartywinspot_roll.stdout != "DELETE"
    tags:
      - thirdpartywinspot
      - 19.7.7.2
      - nineteen
      - all
      - rollback

  - name: adding value to the thirdpartywinspot file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\thirdpartywinspot_19772.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when:
      - ((database.stdout_lines[1]|from_json).thirdpartywinspot_19772_actual | regex_replace(' and SKIPPING.*', '')) != "1"
      - thirdpartywinspot_roll.stdout == "DELETE"
    tags:
      - thirdpartywinspot
      - 19.7.7.2
      - nineteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\thirdpartywinspot_19772.txt'
    when: ((database.stdout_lines[1]|from_json).thirdpartywinspot_19772_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    tags:
      - thirdpartywinspot
      - 19.7.7.2
      - nineteen
      - all
      - rollback

  - name: adding the values in file from db
    shell: echo "{{ item.split('-')[1]}}" >> diagdatatailexp
    loop: "{{(database.stdout_lines[1]|from_json).diagdatatailexp_19773_actual.split(' and SKIPPING')[0].split(',')}}"
    when: ((database.stdout_lines[1]|from_json).diagdatatailexp_19773_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    delegate_to: localhost
    tags:
      - diagdatatailexp
      - 19.7.7.3
      - nineteen
      - all
      - rollback

  - name: grepping the majority value from the file
    shell: cat diagdatatailexp | sort | uniq -c | sort -nr | head -n 1 | awk '{print $2}'
    when: ((database.stdout_lines[1]|from_json).diagdatatailexp_19773_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    register: diagdatatailexp_roll
    delegate_to: localhost
    tags:
      - diagdatatailexp
      - 19.7.7.3
      - nineteen
      - all
      - rollback

  - name: copying diagdatatailexp file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/diagdatatailexp_19773.txt
      dest: C:\facts\policyfiles\diagdatatailexp_19773.txt
    when: ((database.stdout_lines[1]|from_json).diagdatatailexp_19773_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    tags:
      - diagdatatailexp
      - 19.7.7.3
      - nineteen
      - all
      - rollback

  - name: adding value to the diagdatatailexp file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\diagdatatailexp_19773.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{diagdatatailexp_roll.stdout}}'
    when:
      - ((database.stdout_lines[1]|from_json).diagdatatailexp_19773_actual | regex_replace(' and SKIPPING.*', '')) != "1"
      - diagdatatailexp_roll.stdout != "DELETE"
    tags:
      - diagdatatailexp
      - 19.7.7.3
      - nineteen
      - all
      - rollback

  - name: adding value to the diagdatatailexp file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\diagdatatailexp_19773.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when:
      - ((database.stdout_lines[1]|from_json).diagdatatailexp_19773_actual | regex_replace(' and SKIPPING.*', '')) != "1"
      - diagdatatailexp_roll.stdout == "DELETE"
    tags:
      - diagdatatailexp
      - 19.7.7.3
      - nineteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\diagdatatailexp_19773.txt'
    when: ((database.stdout_lines[1]|from_json).diagdatatailexp_19773_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    tags:
      - diagdatatailexp
      - 19.7.7.3
      - nineteen
      - all
      - rollback

  - name: adding the values in file from db
    shell: echo "{{ item.split('-')[1]}}" >> winspotfeature
    loop: "{{(database.stdout_lines[1]|from_json).winspotfeature_19774_actual.split(' and SKIPPING')[0].split(',')}}"
    when: ((database.stdout_lines[1]|from_json).winspotfeature_19774_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    delegate_to: localhost
    tags:
      - winspotfeature
      - 19.7.7.4
      - nineteen
      - all
      - rollback

  - name: grepping the majority value from the file
    shell: cat winspotfeature | sort | uniq -c | sort -nr | head -n 1 | awk '{print $2}'
    when: ((database.stdout_lines[1]|from_json).winspotfeature_19774_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    register: winspotfeature_roll
    delegate_to: localhost
    tags:
      - winspotfeature
      - 19.7.7.4
      - nineteen
      - all
      - rollback

  - name: copying winspotfeature file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/winspotfeature_19774.txt
      dest: C:\facts\policyfiles\winspotfeature_19774.txt
    when: ((database.stdout_lines[1]|from_json).winspotfeature_19774_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    tags:
      - winspotfeature
      - 19.7.7.4
      - nineteen
      - all
      - rollback

  - name: adding value to the winspotfeature file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\winspotfeature_19774.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{winspotfeature_roll.stdout}}'
    when:
      - ((database.stdout_lines[1]|from_json).winspotfeature_19774_actual | regex_replace(' and SKIPPING.*', '')) != "1"
      - winspotfeature_roll.stdout != "DELETE"
    tags:
      - winspotfeature
      - 19.7.7.4
      - nineteen
      - all
      - rollback

  - name: adding value to the winspotfeature file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\winspotfeature_19774.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when:
      - ((database.stdout_lines[1]|from_json).winspotfeature_19774_actual | regex_replace(' and SKIPPING.*', '')) != "1"
      - winspotfeature_roll.stdout == "DELETE"
    tags:
      - winspotfeature
      - 19.7.7.4
      - nineteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\winspotfeature_19774.txt'
    when: ((database.stdout_lines[1]|from_json).winspotfeature_19774_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    tags:
      - winspotfeature
      - 19.7.7.4
      - nineteen
      - all
      - rollback

  - name: adding the values in file from db
    shell: echo "{{ item.split('-')[1]}}" >> prevusersharprof
    loop: "{{(database.stdout_lines[1]|from_json).prevusersharprof_197261_actual.split(' and SKIPPING')[0].split(',')}}"
    when: ((database.stdout_lines[1]|from_json).prevusersharprof_197261_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    delegate_to: localhost
    tags:
      - prevusersharprof
      - 19.7.26.1
      - nineteen
      - all
      - rollback

  - name: grepping the majority value from the file
    shell: cat prevusersharprof | sort | uniq -c | sort -nr | head -n 1 | awk '{print $2}'
    when: ((database.stdout_lines[1]|from_json).prevusersharprof_197261_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    register: prevusersharprof_roll
    delegate_to: localhost
    tags:
      - prevusersharprof
      - 19.7.26.1
      - nineteen
      - all
      - rollback

  - name: copying prevusersharprof file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/prevusersharprof_197261.txt
      dest: C:\facts\policyfiles\prevusersharprof_197261.txt
    when: ((database.stdout_lines[1]|from_json).prevusersharprof_197261_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    tags:
      - prevusersharprof
      - 19.7.26.1
      - nineteen
      - all
      - rollback

  - name: adding value to the prevusersharprof file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\prevusersharprof_197261.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{prevusersharprof_roll.stdout}}'
    when:
      - ((database.stdout_lines[1]|from_json).prevusersharprof_197261_actual | regex_replace(' and SKIPPING.*', '')) != "1"
      - prevusersharprof_roll.stdout != "DELETE"
    tags:
      - prevusersharprof
      - 19.7.26.1
      - nineteen
      - all
      - rollback

  - name: adding value to the prevusersharprof file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\prevusersharprof_197261.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when:
      - ((database.stdout_lines[1]|from_json).prevusersharprof_197261_actual | regex_replace(' and SKIPPING.*', '')) != "1"
      - prevusersharprof_roll.stdout == "DELETE"
    tags:
      - prevusersharprof
      - 19.7.26.1
      - nineteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\prevusersharprof_197261.txt'
    when: ((database.stdout_lines[1]|from_json).prevusersharprof_197261_actual | regex_replace(' and SKIPPING.*', '')) != "1"
    tags:
      - prevusersharprof
      - 19.7.26.1
      - nineteen
      - all
      - rollback

  - name: adding the values in file from db
    shell: echo "{{ item.split('-')[1]}}" >> installelevprivileg
    loop: "{{(database.stdout_lines[1]|from_json).installelevprivileg_197411_actual.split(' and SKIPPING')[0].split(',')}}"
    when: ((database.stdout_lines[1]|from_json).installelevprivileg_197411_actual | regex_replace(' and SKIPPING.*', '')) != "0"
    delegate_to: localhost
    tags:
      - installelevprivileg
      - 19.7.41.1
      - nineteen
      - all
      - rollback

  - name: grepping the majority value from the file
    shell: cat installelevprivileg | sort | uniq -c | sort -nr | head -n 1 | awk '{print $2}'
    when: ((database.stdout_lines[1]|from_json).installelevprivileg_197411_actual | regex_replace(' and SKIPPING.*', '')) != "0"
    register: installelevprivileg_roll
    delegate_to: localhost
    tags:
      - installelevprivileg
      - 19.7.41.1
      - nineteen
      - all
      - rollback

  - name: copying installelevprivileg file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/installelevprivileg_197411.txt
      dest: C:\facts\policyfiles\installelevprivileg_197411.txt
    when: ((database.stdout_lines[1]|from_json).installelevprivileg_197411_actual | regex_replace(' and SKIPPING.*', '')) != "0"
    tags:
      - installelevprivileg
      - 19.7.41.1
      - nineteen
      - all
      - rollback

  - name: adding value to the installelevprivileg file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\installelevprivileg_197411.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{installelevprivileg_roll.stdout}}'
    when:
      - ((database.stdout_lines[1]|from_json).installelevprivileg_197411_actual | regex_replace(' and SKIPPING.*', '')) != "0"
      - installelevprivileg_roll.stdout != "DELETE"
    tags:
      - installelevprivileg
      - 19.7.41.1
      - nineteen
      - all
      - rollback

  - name: adding value to the installelevprivileg file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\installelevprivileg_197411.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when:
      - ((database.stdout_lines[1]|from_json).installelevprivileg_197411_actual | regex_replace(' and SKIPPING.*', '')) != "0"
      - installelevprivileg_roll.stdout == "DELETE"
    tags:
      - installelevprivileg
      - 19.7.41.1
      - nineteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\installelevprivileg_197411.txt'
    when: ((database.stdout_lines[1]|from_json).installelevprivileg_197411_actual | regex_replace(' and SKIPPING.*', '')) != "0"
    tags:
      - installelevprivileg
      - 19.7.41.1
      - nineteen
      - all
      - rollback

  - name: adding the values in file from db
    shell: echo "{{ item.split('-')[1]}}" >> prevcodecdown
    loop: "{{(database.stdout_lines[1]|from_json).prevcodecdown_1974521_actual.split(' and SKIPPING')[0].split(',')}}"
    when: ((database.stdout_lines[1]|from_json).prevcodecdown_1974521_actual | regex_replace(' and SKIPPING.*', '')) != "0"
    delegate_to: localhost
    tags:
      - prevcodecdown
      - 19.7.45.2.1
      - nineteen
      - all
      - rollback

  - name: grepping the majority value from the file
    shell: cat prevcodecdown | sort | uniq -c | sort -nr | head -n 1 | awk '{print $2}'
    when: ((database.stdout_lines[1]|from_json).prevcodecdown_1974521_actual | regex_replace(' and SKIPPING.*', '')) != "0"
    register: prevcodecdown_roll
    delegate_to: localhost
    tags:
      - prevcodecdown
      - 19.7.45.2.1
      - nineteen
      - all
      - rollback

  - name: copying prevcodecdown file for rollback
    win_copy:
      src: ../files/windows_rollback_text/windows2019/prevcodecdown_1974521.txt
      dest: C:\facts\policyfiles\prevcodecdown_1974521.txt
    when: ((database.stdout_lines[1]|from_json).prevcodecdown_1974521_actual | regex_replace(' and SKIPPING.*', '')) != "0"
    tags:
      - prevcodecdown
      - 19.7.45.2.1
      - nineteen
      - all
      - rollback

  - name: adding value to the prevcodecdown file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\prevcodecdown_1974521.txt
       regex: '^(DWORD:*)'
       line: 'DWORD:{{prevcodecdown_roll.stdout}}'
    when:
      - ((database.stdout_lines[1]|from_json).prevcodecdown_1974521_actual | regex_replace(' and SKIPPING.*', '')) != "0"
      - prevcodecdown_roll.stdout != "DELETE"
    tags:
      - prevcodecdown
      - 19.7.45.2.1
      - nineteen
      - all
      - rollback

  - name: adding value to the prevcodecdown file for rollback
    win_lineinfile:
       path: C:\facts\policyfiles\prevcodecdown_1974521.txt
       regex: '^(DWORD:*)'
       line: 'DELETE'
    when:
      - ((database.stdout_lines[1]|from_json).prevcodecdown_1974521_actual | regex_replace(' and SKIPPING.*', '')) != "0"
      - prevcodecdown_roll.stdout == "DELETE"
    tags:
      - prevcodecdown
      - 19.7.45.2.1
      - nineteen
      - all
      - rollback

  - name: importing to group policy
    win_shell: 'C:\facts\Lgpo\LGPO.exe /t C:\facts\policyfiles\prevcodecdown_1974521.txt'
    when: ((database.stdout_lines[1]|from_json).prevcodecdown_1974521_actual | regex_replace(' and SKIPPING.*', '')) != "0"
    tags:
      - prevcodecdown
      - 19.7.45.2.1
      - nineteen
      - all
      - rollback

  - name: Include Database
    include: tasks/after_windows.yml
